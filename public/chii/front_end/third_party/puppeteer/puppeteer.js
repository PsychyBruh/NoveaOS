var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};function t(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}function r(e,t,r,i){return new(r||(r=Promise))((function(n,s){function a(e){try{c(i.next(e))}catch(e){s(e)}}function o(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){e.done?n(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,o)}c((i=i.apply(e,t||[])).next())}))}function i(e,t){var r,i,n,s,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(a=0)),a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}function n(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)a.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a}function a(e,t,r){if(r||2===arguments.length)for(var i,n=0,s=t.length;n<s;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function o(e){return this instanceof o?(this.v=e,this):new o(e)}function c(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(e){n[e]&&(i[e]=function(t){return new Promise((function(r,i){s.push([e,t,r,i])>1||c(e,t)}))})}function c(e,t){try{!function(e){e.value instanceof o?Promise.resolve(e.value.v).then(l,d):u(s[0][2],e)}(n[e](t))}catch(e){u(s[0][3],e)}}function l(e){c("next",e)}function d(e){c("throw",e)}function u(e,t){e(t),s.shift(),s.length&&c(s[0][0],s[0][1])}}function l(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=n(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise((function(i,n){(function(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)})(i,n,(t=e[r](t)).done,t.value)}))}}}function d(e){return"function"==typeof e}function u(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var h=u((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function p(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var f=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,r,i,o;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var l=n(c),u=l.next();!u.done;u=l.next()){u.value.remove(this)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}else c.remove(this);var p=this.initialTeardown;if(d(p))try{p()}catch(e){o=e instanceof h?e.errors:[e]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var y=n(f),g=y.next();!g.done;g=y.next()){var w=g.value;try{m(w)}catch(e){o=o??[],e instanceof h?o=a(a([],s(o)),s(e.errors)):o.push(e)}}}catch(e){r={error:e}}finally{try{g&&!g.done&&(i=y.return)&&i.call(y)}finally{if(r)throw r.error}}}if(o)throw new h(o)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)m(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&p(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&p(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e;var t}();f.EMPTY;function y(e){return e instanceof f||e&&"closed"in e&&d(e.remove)&&d(e.add)&&d(e.unsubscribe)}function m(e){d(e)?e():e.unsubscribe()}var g={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},w={setTimeout:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var n=w.delegate;return null!=n&&n.setTimeout?n.setTimeout.apply(n,a([e,t],s(r))):setTimeout.apply(void 0,a([e,t],s(r)))},clearTimeout:function(e){var t=w.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function v(e){w.setTimeout((function(){var t=g.onUnhandledError;if(!t)throw e;t(e)}))}function b(){}var k=C("C",void 0,void 0);function C(e,t,r){return{kind:e,value:t,error:r}}var S=null;var T=function(e){function r(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,y(t)&&t.add(r)):r.destination=D,r}return t(r,e),r.create=function(e,t,r){return new F(e,t,r)},r.prototype.next=function(e){this.isStopped?_(function(e){return C("N",e,void 0)}(e),this):this._next(e)},r.prototype.error=function(e){this.isStopped?_(function(e){return C("E",void 0,e)}(e),this):(this.isStopped=!0,this._error(e))},r.prototype.complete=function(){this.isStopped?_(k,this):(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},r.prototype._next=function(e){this.destination.next(e)},r.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},r.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},r}(f),E=Function.prototype.bind;function I(e,t){return E.call(e,t)}var x=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){R(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){R(e)}else R(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){R(e)}},e}(),F=function(e){function r(t,r,i){var n,s,a=e.call(this)||this;d(t)||!t?n={next:t??void 0,error:r??void 0,complete:i??void 0}:a&&g.useDeprecatedNextContext?((s=Object.create(t)).unsubscribe=function(){return a.unsubscribe()},n={next:t.next&&I(t.next,s),error:t.error&&I(t.error,s),complete:t.complete&&I(t.complete,s)}):n=t;return a.destination=new x(n),a}return t(r,e),r}(T);function R(e){g.useDeprecatedSynchronousErrorHandling?function(e){g.useDeprecatedSynchronousErrorHandling&&S&&(S.errorThrown=!0,S.error=e)}(e):v(e)}function _(e,t){var r=g.onStoppedNotification;r&&w.setTimeout((function(){return r(e,t)}))}var D={closed:!0,next:b,error:function(e){throw e},complete:b},P="function"==typeof Symbol&&Symbol.observable||"@@observable";function M(e){return e}function q(e){return 0===e.length?M:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var A=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var i=this,n=function(e){return e&&e instanceof T||function(e){return e&&d(e.next)&&d(e.error)&&d(e.complete)}(e)&&y(e)}(e)?e:new F(e,t,r);return function(e){if(g.useDeprecatedSynchronousErrorHandling){var t=!S;if(t&&(S={errorThrown:!1,error:null}),e(),t){var r=S,i=r.errorThrown,n=r.error;if(S=null,i)throw n}}else e()}((function(){var e=i,t=e.operator,r=e.source;n.add(t?t.call(n,r):r?i._subscribe(n):i._trySubscribe(n))})),n},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=O(t))((function(t,i){var n=new F({next:function(t){try{e(t)}catch(e){i(e),n.unsubscribe()}},error:i,complete:t});r.subscribe(n)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[P]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return q(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=O(e))((function(e,r){var i;t.subscribe((function(e){return i=e}),(function(e){return r(e)}),(function(){return e(i)}))}))},e.create=function(t){return new e(t)},e}();function O(e){var t;return null!==(t=e??g.Promise)&&void 0!==t?t:Promise}function N(e){return function(t){if(function(e){return d(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function B(e,t,r,i,n){return new L(e,t,r,i,n)}var L=function(e){function r(t,r,i,n,s,a){var o=e.call(this,t)||this;return o.onFinalize=s,o.shouldUnsubscribe=a,o._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,o._error=n?function(e){try{n(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,o._complete=i?function(){try{i()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,o}return t(r,e),r.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},r}(T),j={now:function(){return(j.delegate||Date).now()},delegate:void 0},H=function(e){function r(t,r){return e.call(this)||this}return t(r,e),r.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},r}(f),$={setInterval:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var n=$.delegate;return null!=n&&n.setInterval?n.setInterval.apply(n,a([e,t],s(r))):setInterval.apply(void 0,a([e,t],s(r)))},clearInterval:function(e){var t=$.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},K=function(e){function r(t,r){var i=e.call(this,t,r)||this;return i.scheduler=t,i.work=r,i.pending=!1,i}return t(r,e),r.prototype.schedule=function(e,t){var r;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(n,this.id,t),this},r.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),$.setInterval(e.flush.bind(e,this),r)},r.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&$.clearInterval(t)},r.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},r.prototype._execute=function(e,t){var r,i=!1;try{this.work(e)}catch(e){i=!0,r=e||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r},r.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,r=this.scheduler,i=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,p(i,this),null!=t&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},r}(H),V=function(){function e(t,r){void 0===r&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},e.now=j.now,e}(),U=new(function(e){function r(t,r){void 0===r&&(r=V.now);var i=e.call(this,t,r)||this;return i.actions=[],i._active=!1,i}return t(r,e),r.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}},r}(V))(K),W=U,z=new A((function(e){return e.complete()}));function G(e){return e&&d(e.schedule)}function Q(e){return e[e.length-1]}function J(e){return G(Q(e))?e.pop():void 0}var X=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Y(e){return d(null==e?void 0:e.then)}function Z(e){return d(e[P])}function ee(e){return Symbol.asyncIterator&&d(null==e?void 0:e[Symbol.asyncIterator])}function te(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var re="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function ie(e){return d(null==e?void 0:e[re])}function ne(e){return c(this,arguments,(function(){var t,r,n;return i(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,o(t.read())];case 3:return r=i.sent(),n=r.value,r.done?[4,o(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,o(n)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function se(e){return d(null==e?void 0:e.getReader)}function ae(e){if(e instanceof A)return e;if(null!=e){if(Z(e))return function(e){return new A((function(t){var r=e[P]();if(d(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")}))}(e);if(X(e))return function(e){return new A((function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()}))}(e);if(Y(e))return function(e){return new A((function(t){e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,v)}))}(e);if(ee(e))return oe(e);if(ie(e))return function(e){return new A((function(t){var r,i;try{for(var s=n(e),a=s.next();!a.done;a=s.next()){var o=a.value;if(t.next(o),t.closed)return}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}t.complete()}))}(e);if(se(e))return function(e){return oe(ne(e))}(e)}throw te(e)}function oe(e){return new A((function(t){(function(e,t){var n,s,a,o;return r(this,void 0,void 0,(function(){var r,c;return i(this,(function(i){switch(i.label){case 0:i.trys.push([0,5,6,11]),n=l(e),i.label=1;case 1:return[4,n.next()];case 2:if((s=i.sent()).done)return[3,4];if(r=s.value,t.next(r),t.closed)return[2];i.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=i.sent(),a={error:c},[3,11];case 6:return i.trys.push([6,,9,10]),s&&!s.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:i.sent(),i.label=8;case 8:return[3,10];case 9:if(a)throw a.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function ce(e,t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=!1);var s=t.schedule((function(){r(),n?e.add(this.schedule(null,i)):this.unsubscribe()}),i);if(e.add(s),!n)return s}function le(e,t){return void 0===t&&(t=0),N((function(r,i){r.subscribe(B(i,(function(r){return ce(i,e,(function(){return i.next(r)}),t)}),(function(){return ce(i,e,(function(){return i.complete()}),t)}),(function(r){return ce(i,e,(function(){return i.error(r)}),t)})))}))}function de(e,t){return void 0===t&&(t=0),N((function(r,i){i.add(e.schedule((function(){return r.subscribe(i)}),t))}))}function ue(e,t){if(!e)throw new Error("Iterable cannot be null");return new A((function(r){ce(r,t,(function(){var i=e[Symbol.asyncIterator]();ce(r,t,(function(){i.next().then((function(e){e.done?r.complete():r.next(e.value)}))}),0,!0)}))}))}function he(e,t){if(null!=e){if(Z(e))return function(e,t){return ae(e).pipe(de(t),le(t))}(e,t);if(X(e))return function(e,t){return new A((function(r){var i=0;return t.schedule((function(){i===e.length?r.complete():(r.next(e[i++]),r.closed||this.schedule())}))}))}(e,t);if(Y(e))return function(e,t){return ae(e).pipe(de(t),le(t))}(e,t);if(ee(e))return ue(e,t);if(ie(e))return function(e,t){return new A((function(r){var i;return ce(r,t,(function(){i=e[re](),ce(r,t,(function(){var e,t,n;try{t=(e=i.next()).value,n=e.done}catch(e){return void r.error(e)}n?r.complete():r.next(t)}),0,!0)})),function(){return d(null==i?void 0:i.return)&&i.return()}}))}(e,t);if(se(e))return function(e,t){return ue(ne(e),t)}(e,t)}throw te(e)}function pe(e,t){return t?he(e,t):ae(e)}var fe=u((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}}));function ye(e,t){var r="object"==typeof t;return new Promise((function(i,n){var s=new F({next:function(e){i(e),s.unsubscribe()},error:n,complete:function(){r?i(t.defaultValue):n(new fe)}});e.subscribe(s)}))}function me(e,t){return N((function(r,i){var n=0;r.subscribe(B(i,(function(r){i.next(e.call(t,r,n++))})))}))}var ge=Array.isArray;function we(e){return me((function(t){return function(e,t){return ge(t)?e.apply(void 0,a([],s(t))):e(t)}(e,t)}))}Array.isArray,Object.getPrototypeOf,Object.prototype,Object.keys;function ve(e,t,r){return void 0===r&&(r=1/0),d(t)?ve((function(r,i){return me((function(e,n){return t(r,e,i,n)}))(ae(e(r,i)))}),r):("number"==typeof t&&(r=t),N((function(t,i){return function(e,t,r,i,n,s,a,o){var c=[],l=0,d=0,u=!1,h=function(){u&&!c.length&&!l&&t.complete()},p=function(e){return l<i?f(e):c.push(e)},f=function(e){s&&t.next(e),l++;var o=!1;ae(r(e,d++)).subscribe(B(t,(function(e){null==n||n(e),s?p(e):t.next(e)}),(function(){o=!0}),void 0,(function(){if(o)try{l--;for(var e=function(){var e=c.shift();a?ce(t,a,(function(){return f(e)})):f(e)};c.length&&l<i;)e();h()}catch(e){t.error(e)}})))};return e.subscribe(B(t,p,(function(){u=!0,h()}))),function(){null==o||o()}}(t,i,e,r)})))}function be(e){return void 0===e&&(e=1/0),ve(M,e)}function ke(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return be(1)(pe(e,J(e)))}function Ce(e){return new A((function(t){ae(e()).subscribe(t)}))}var Se=["addListener","removeListener"],Te=["addEventListener","removeEventListener"],Ee=["on","off"];function Ie(e,t,r,i){if(d(r)&&(i=r,r=void 0),i)return Ie(e,t,r).pipe(we(i));var n=s(function(e){return d(e.addEventListener)&&d(e.removeEventListener)}(e)?Te.map((function(i){return function(n){return e[i](t,n,r)}})):function(e){return d(e.addListener)&&d(e.removeListener)}(e)?Se.map(xe(e,t)):function(e){return d(e.on)&&d(e.off)}(e)?Ee.map(xe(e,t)):[],2),a=n[0],o=n[1];if(!a&&X(e))return ve((function(e){return Ie(e,t,r)}))(ae(e));if(!a)throw new TypeError("Invalid event target");return new A((function(e){var t=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.next(1<t.length?t:t[0])};return a(t),function(){return o(t)}}))}function xe(e,t){return function(r){return function(i){return e[r](t,i)}}}function Fe(e,t,r){void 0===e&&(e=0),void 0===r&&(r=W);var i=-1;return null!=t&&(G(t)?r=t:i=t),new A((function(t){var n=function(e){return e instanceof Date&&!isNaN(e)}(e)?+e-r.now():e;n<0&&(n=0);var s=0;return r.schedule((function(){t.closed||(t.next(s++),0<=i?this.schedule(void 0,i):t.complete())}),n)}))}function Re(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=J(e),i=function(e,t){return"number"==typeof Q(e)?e.pop():t}(e,1/0),n=e;return n.length?1===n.length?ae(n[0]):be(i)(pe(n,r)):z}var _e=new A(b),De=Array.isArray;function Pe(e,t){return N((function(r,i){var n=0;r.subscribe(B(i,(function(r){return e.call(t,r,n++)&&i.next(r)})))}))}function Me(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1===(e=function(e){return 1===e.length&&De(e[0])?e[0]:e}(e)).length?ae(e[0]):new A(qe(e))}function qe(e){return function(t){for(var r=[],i=function(i){r.push(ae(e[i]).subscribe(B(t,(function(e){if(r){for(var n=0;n<r.length;n++)n!==i&&r[n].unsubscribe();r=null}t.next(e)}))))},n=0;r&&!t.closed&&n<e.length;n++)i(n)}}function Ae(e){return N((function(t,r){var i,n=null,s=!1;n=t.subscribe(B(r,void 0,void 0,(function(a){i=ae(e(a,Ae(e)(t))),n?(n.unsubscribe(),n=null,i.subscribe(r)):s=!0}))),s&&(n.unsubscribe(),n=null,i.subscribe(r))}))}function Oe(e){return N((function(t,r){var i=!1;t.subscribe(B(r,(function(e){i=!0,r.next(e)}),(function(){i||r.next(e),r.complete()})))}))}function Ne(e){return e<=0?function(){return z}:N((function(t,r){var i=0;t.subscribe(B(r,(function(t){++i<=e&&(r.next(t),e<=i&&r.complete())})))}))}function Be(){return N((function(e,t){e.subscribe(B(t,b))}))}function Le(e,t){return t?function(r){return ke(t.pipe(Ne(1),Be()),r.pipe(Le(e)))}:ve((function(t,r){return ae(e(t,r)).pipe(Ne(1),function(e){return me((function(){return e}))}(t))}))}function je(e){return void 0===e&&(e=He),N((function(t,r){var i=!1;t.subscribe(B(r,(function(e){i=!0,r.next(e)}),(function(){return i?r.complete():r.error(e())})))}))}function He(){return new fe}function $e(e,t){var r=arguments.length>=2;return function(i){return i.pipe(e?Pe((function(t,r){return e(t,r,i)})):M,Ne(1),r?Oe(t):je((function(){return new fe})))}}function Ke(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length?N((function(t,r){qe(a([t],s(e)))(r)})):M}function Ve(e){var t;void 0===e&&(e=1/0);var r=(t=e&&"object"==typeof e?e:{count:e}).count,i=void 0===r?1/0:r,n=t.delay,s=t.resetOnSuccess,a=void 0!==s&&s;return i<=0?M:N((function(e,t){var r,s=0,o=function(){var c=!1;r=e.subscribe(B(t,(function(e){a&&(s=0),t.next(e)}),void 0,(function(e){if(s++<i){var a=function(){r?(r.unsubscribe(),r=null,o()):c=!0};if(null!=n){var l="number"==typeof n?Fe(n):ae(n(e,s)),d=B(t,(function(){d.unsubscribe(),a()}),(function(){t.complete()}));l.subscribe(d)}else a()}else t.error(e)}))),c&&(r.unsubscribe(),r=null,o())};o()}))}function Ue(e,t,r){var i=d(e)||t||r?{next:e,error:t,complete:r}:e;return i?N((function(e,t){var r;null===(r=i.subscribe)||void 0===r||r.call(i);var n=!0;e.subscribe(B(t,(function(e){var r;null===(r=i.next)||void 0===r||r.call(i,e),t.next(e)}),(function(){var e;n=!1,null===(e=i.complete)||void 0===e||e.call(i),t.complete()}),(function(e){var r;n=!1,null===(r=i.error)||void 0===r||r.call(i,e),t.error(e)}),(function(){var e,t;n&&(null===(e=i.unsubscribe)||void 0===e||e.call(i)),null===(t=i.finalize)||void 0===t||t.call(i)})))})):M}function We(e){return ve((t=>pe(Promise.resolve(e(t))).pipe(Pe((e=>e)),me((()=>t)))))}Symbol.dispose??=Symbol("dispose"),Symbol.asyncDispose??=Symbol("asyncDispose");const ze=Symbol.dispose,Ge=Symbol.asyncDispose;class Qe{#e=!1;#t=[];get disposed(){return this.#e}dispose(){if(!this.#e){this.#e=!0;for(const e of this.#t.reverse())e[ze]()}}use(e){return e&&this.#t.push(e),e}adopt(e,t){return this.#t.push({[ze](){t(e)}}),e}defer(e){this.#t.push({[ze](){e()}})}move(){if(this.#e)throw new ReferenceError("a disposed stack can not use anything new");const e=new Qe;return e.#t=this.#t,this.#e=!0,e}[ze]=this.dispose;[Symbol.toStringTag]="DisposableStack"}class Je{#e=!1;#t=[];get disposed(){return this.#e}async dispose(){if(!this.#e){this.#e=!0;for(const e of this.#t.reverse())await e[Ge]()}}use(e){return e&&this.#t.push(e),e}adopt(e,t){return this.#t.push({[Ge]:()=>t(e)}),e}defer(e){this.#t.push({[Ge]:()=>e()})}move(){if(this.#e)throw new ReferenceError("a disposed stack can not use anything new");const e=new Je;return e.#t=this.#t,this.#e=!0,e}[Ge]=this.dispose;[Symbol.toStringTag]="AsyncDisposableStack"}class Xe{#r;#i=new Map;constructor(){var e;this.#r={all:e=(e=this.#i)||new Map,on:function(t,r){var i=e.get(t);i?i.push(r):e.set(t,[r])},off:function(t,r){var i=e.get(t);i&&(r?i.splice(i.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var i=e.get(t);i&&i.slice().map((function(e){e(r)})),(i=e.get("*"))&&i.slice().map((function(e){e(t,r)}))}}}on(e,t){return this.#r.on(e,t),this}off(e,t){return this.#r.off(e,t),this}removeListener(e,t){return this.off(e,t),this}addListener(e,t){return this.on(e,t),this}emit(e,t){return this.#r.emit(e,t),this.listenerCount(e)>0}once(e,t){const r=i=>{t(i),this.off(e,r)};return this.on(e,r)}listenerCount(e){return this.#i.get(e)?.length||0}removeAllListeners(e){return void 0===e||"*"===e?this.#i.clear():this.#i.delete(e),this}}class Ye{#n;#s;#a;constructor(e,t,r){this.#n=e,this.#s=t,this.#a=r,this.#n.on(this.#s,this.#a)}[ze](){this.#n.off(this.#s,this.#a)}}const Ze=!("undefined"==typeof process||!process.version),et=("undefined"!=typeof process&&void 0!==process.env.PUPPETEER_DEFERRED_PROMISE_DEBUG_TIMEOUT&&Number(process.env.PUPPETEER_DEFERRED_PROMISE_DEBUG_TIMEOUT),(e,t)=>{if(!e)throw new Error(t)});function tt(e){return"object"==typeof e&&null!==e&&"name"in e&&"message"in e}function rt(e,t,r){return e.message=t,e.originalMessage=r??e.originalMessage,e}function it(e){let t=`${e.error.message}`;return e.error&&"object"==typeof e.error&&"data"in e.error&&(t+=` ${e.error.data}`),t}let nt=null;const st=e=>Ze?async(...t)=>{ot&&at.push(e+t),(await async function(){return nt||(nt=(await import("debug")).default),nt}())(e)(t)}:(...t)=>{const r=globalThis.__PUPPETEER_DEBUG;if(!r)return;("*"===r||(r.endsWith("*")?e.startsWith(r):e===r))&&console.log(`${e}:`,...t)};let at=[],ot=!1;class ct extends Error{constructor(e){super(e),this.name=this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}}class lt extends ct{}class dt extends ct{#o;#c="";set code(e){this.#o=e}get code(){return this.#o}set originalMessage(e){this.#c=e}get originalMessage(){return this.#c}}class ut extends ct{}class ht extends dt{}Object.freeze({TimeoutError:lt,ProtocolError:dt});const pt=st("puppeteer:error");Object.freeze({width:800,height:600});function ft(e){let t,r;if(e.exception){if(!("object"===e.exception.type&&"error"===e.exception.subtype||e.exception.objectId))return vt(e.exception);{const i=yt(e);t=i.name,r=i.message}}else t="Error",r=e.text;const i=r.split("\n").length,n=new Error(r);n.name=t;const s=n.stack.split("\n"),a=s.splice(0,i);if(s.shift(),e.stackTrace&&s.length<Error.stackTraceLimit)for(const t of e.stackTrace.callFrames.reverse()){if(gt.isPuppeteerURL(t.url)&&t.url!==gt.INTERNAL_URL){const e=gt.parse(t.url);s.unshift(`    at ${t.functionName||e.functionName} (${e.functionName} at ${e.siteString}, <anonymous>:${t.lineNumber}:${t.columnNumber})`)}else s.push(`    at ${t.functionName||"<anonymous>"} (${t.url}:${t.lineNumber}:${t.columnNumber})`);if(s.length>=Error.stackTraceLimit)break}return n.stack=[...a,...s].join("\n"),n}const yt=e=>{let t,r="";const i=e.exception?.description?.split("\n    at ")??[],n=Math.min(e.stackTrace?.callFrames.length??0,i.length-1);return i.splice(-n,n),e.exception?.className&&(r=e.exception.className),t=i.join("\n"),r&&t.startsWith(`${r}: `)&&(t=t.slice(r.length+2)),{message:t,name:r}},mt=Symbol("Source URL for Puppeteer evaluation scripts");class gt{static INTERNAL_URL="pptr:internal";static fromCallSite(e,t){const r=new gt;return r.#l=e,r.#d=t.toString(),r}static parse=e=>{e=e.slice(5);const[t="",r=""]=e.split(";"),i=new gt;return i.#l=t,i.#d=decodeURIComponent(r),i};static isPuppeteerURL=e=>e.startsWith("pptr:");#l;#d;get functionName(){return this.#l}get siteString(){return this.#d}toString(){return`pptr:${[this.#l,encodeURIComponent(this.#d)].join(";")}`}}const wt=(e,t)=>{if(Object.prototype.hasOwnProperty.call(t,mt))return t;const r=Error.prepareStackTrace;Error.prepareStackTrace=(e,t)=>t[2];const i=(new Error).stack;return Error.prepareStackTrace=r,Object.assign(t,{[mt]:gt.fromCallSite(e,i)})};function vt(e){if(et(!e.objectId,"Cannot extract value when objectId is given"),e.unserializableValue){if("bigint"===e.type)return BigInt(e.unserializableValue.replace("n",""));switch(e.unserializableValue){case"-0":return-0;case"NaN":return NaN;case"Infinity":return 1/0;case"-Infinity":return-1/0;default:throw new Error("Unsupported unserializable value: "+e.unserializableValue)}}return e.value}const bt=e=>"string"==typeof e||e instanceof String;function kt(e,...t){if(bt(e))return et(0===t.length,"Cannot evaluate a string with arguments"),e;return`(${e})(${t.map((function(e){return Object.is(e,void 0)?"undefined":JSON.stringify(e)})).join(",")})`}function Ct(e,t){const r=globalThis[t];Object.assign(globalThis,{[t](...i){const n=globalThis[t];n.args??=new Map,n.callbacks??=new Map;const s=(n.lastSeq??0)+1;return n.lastSeq=s,n.args.set(s,i),r(JSON.stringify({type:e,name:t,seq:s,args:i,isTrivial:!i.some((e=>e instanceof Node))})),new Promise(((e,t)=>{n.callbacks.set(s,{resolve(t){n.args.delete(s),e(t)},reject(e){n.args.delete(s),t(e)}})}))}})}let St=null;async function Tt(){if(!St)try{St=await import("fs/promises")}catch(e){if(e instanceof TypeError)throw new Error("Cannot write to a path outside of a Node-like environment.");throw e}return St}async function Et(e,t){const r=[];if(t){const i=await Tt(),n=await i.open(t,"w+");try{for await(const t of e)r.push(t),await n.writeFile(t)}finally{await n.close()}}else for await(const t of e)r.push(t);try{return Buffer.concat(r)}catch(e){return null}}async function It(e,t){if(!Ze)throw new Error("Cannot create a stream outside of Node.js environment.");const{Readable:r}=await import("stream");let i=!1;return new r({async read(r){if(!i)try{const n=await e.send("IO.read",{handle:t,size:r});this.push(n.data,n.base64Encoded?"base64":void 0),n.eof&&(i=!0,await e.send("IO.close",{handle:t}),this.push(null))}catch(e){if(tt(e))return void this.destroy(e);throw e}}})}function xt(){let e="";for(const t of document.childNodes)if(t===document.documentElement)e+=document.documentElement.outerHTML;else e+=(new XMLSerializer).serializeToString(t);return e}function Ft(e){return 0===e?_e:Fe(e).pipe(me((()=>{throw new lt(`Timed out after waiting ${e}ms`)})))}const Rt="__puppeteer_utility_world__",_t=/^[\040\t]*\/\/[@#] sourceURL=\s*(\S*?)\s*$/m;async function Dt(e,t,r,i,n){return await ye(Ie(e,t).pipe(We((async e=>bt(r)?r===e.url():"function"==typeof r&&!!await r(e))),Ke(Ft(i),pe(n.valueOrThrow()))))}const Pt=500,Mt=new Map([["geolocation","geolocation"],["midi","midi"],["notifications","notifications"],["camera","videoCapture"],["microphone","audioCapture"],["background-sync","backgroundSync"],["ambient-light-sensor","sensors"],["accelerometer","sensors"],["gyroscope","sensors"],["magnetometer","sensors"],["accessibility-events","accessibilityEvents"],["clipboard-read","clipboardReadWrite"],["clipboard-write","clipboardReadWrite"],["clipboard-sanitized-write","clipboardSanitizedWrite"],["payment-handler","paymentHandler"],["persistent-storage","durableStorage"],["idle-detection","idleDetection"],["midi-sysex","midiSysex"]]);class qt extends Xe{constructor(){super()}async waitForTarget(e,t={}){const{timeout:r=3e4}=t;return await ye(Re(Ie(this,"targetcreated"),Ie(this,"targetchanged"),pe(this.targets())).pipe(We(e),Ke(Ft(r))))}async pages(){return(await Promise.all(this.browserContexts().map((e=>e.pages())))).reduce(((e,t)=>e.concat(t)),[])}isConnected(){return this.connected}[ze](){this.close().catch(pt)}[Ge](){return this.close()}}class At extends Xe{constructor(){super()}get closed(){return!this.browser().browserContexts().includes(this)}get id(){}[ze](){this.close().catch(pt)}[Ge](){return this.close()}}var Ot,Nt,Bt;!function(e){e.Disconnected=Symbol("CDPSession.Disconnected"),e.Swapped=Symbol("CDPSession.Swapped"),e.Ready=Symbol("CDPSession.Ready"),e.SessionAttached="sessionattached",e.SessionDetached="sessiondetached"}(Ot||(Ot={}));class Lt extends Xe{constructor(){super()}parentSession(){}}class jt{#u=!1;#h=!1;#p;#f=()=>{};#y=new Promise((e=>{this.#f=e}));#m;#g;constructor(e){e&&e.timeout>0&&(this.#g=new lt(e.message),this.#m=setTimeout((()=>{this.reject(this.#g)}),e.timeout))}#w(e){clearTimeout(this.#m),this.#p=e,this.#f()}resolve(e){this.#h||this.#u||(this.#u=!0,this.#w(e))}reject(e){this.#h||this.#u||(this.#h=!0,this.#w(e))}resolved(){return this.#u}finished(){return this.#u||this.#h}value(){return this.#p}async valueOrThrow(){if(await this.#y,this.#h)throw this.#p;return this.#p}static create(e){return new jt(e)}static async race(e){const t=new Set;try{const r=e.map((e=>e instanceof jt?(e.#m&&t.add(e),e.valueOrThrow()):e));return await Promise.race(r)}finally{for(const e of t)e.reject(new Error("Timeout cleared"))}}}!function(e){e.PAGE="page",e.BACKGROUND_PAGE="background_page",e.SERVICE_WORKER="service_worker",e.SHARED_WORKER="shared_worker",e.BROWSER="browser",e.WEBVIEW="webview",e.OTHER="other",e.TAB="tab"}(Nt||(Nt={}));class Ht{constructor(){}async worker(){return null}async page(){return null}}class $t{#v=new Map;#b=function(){let e=0;return()=>++e}();create(e,t,r){const i=new Kt(this.#b(),e,t);this.#v.set(i.id,i);try{r(i.id)}catch(e){throw i.promise.valueOrThrow().catch(pt).finally((()=>{this.#v.delete(i.id)})),i.reject(e),e}return i.promise.valueOrThrow().finally((()=>{this.#v.delete(i.id)}))}reject(e,t,r){const i=this.#v.get(e);i&&this._reject(i,t,r)}_reject(e,t,r){let i,n;t instanceof dt?(i=t,i.cause=e.error,n=t.message):(i=e.error,n=t),e.reject(rt(i,`Protocol error (${e.label}): ${n}`,r))}resolve(e,t){const r=this.#v.get(e);r&&r.resolve(t)}clear(){for(const e of this.#v.values())this._reject(e,new ht("Target closed"));this.#v.clear()}}class Kt{#k;#C=new dt;#S=jt.create();#T;#E;constructor(e,t,r){this.#k=e,this.#E=t,r&&(this.#T=setTimeout((()=>{this.#S.reject(rt(this.#C,`${t} timed out. Increase the 'protocolTimeout' setting in launch/connect calls for a higher timeout if needed.`))}),r))}resolve(e){clearTimeout(this.#T),this.#S.resolve(e)}reject(e){clearTimeout(this.#T),this.#S.reject(e)}get id(){return this.#k}get promise(){return this.#S}get error(){return this.#C}get label(){return this.#E}}class Vt extends Lt{#I;#x;#v=new $t;#F;#R;#n;constructor(e,t,r,i){super(),this.#F=e,this.#x=t,this.#I=r,this.#R=i}_setTarget(e){this.#n=e}_target(){return et(this.#n,"Target must exist"),this.#n}connection(){return this.#F}parentSession(){if(!this.#R)return this;const e=this.#F?.session(this.#R);return e??void 0}send(e,...t){if(!this.#F)return Promise.reject(new ht(`Protocol error (${e}): Session closed. Most likely the ${this.#x} has been closed.`));const r=t.length?t[0]:void 0;return this.#F._rawSend(this.#v,e,r,this.#I)}_onMessage(e){e.id?e.error?this.#v.reject(e.id,it(e),e.error.message):this.#v.resolve(e.id,e.result):(et(!e.id),this.emit(e.method,e.params))}async detach(){if(!this.#F)throw new Error(`Session already detached. Most likely the ${this.#x} has been closed.`);await this.#F.send("Target.detachFromTarget",{sessionId:this.#I})}_onClosed(){this.#v.clear(),this.#F=void 0,this.emit(Ot.Disconnected,void 0)}id(){return this.#I}}!function(e){e.Request=Symbol("NetworkManager.Request"),e.RequestServedFromCache=Symbol("NetworkManager.RequestServedFromCache"),e.Response=Symbol("NetworkManager.Response"),e.RequestFailed=Symbol("NetworkManager.RequestFailed"),e.RequestFinished=Symbol("NetworkManager.RequestFinished")}(Bt||(Bt={}));const Ut={letter:{width:8.5,height:11},legal:{width:8.5,height:14},tabloid:{width:11,height:17},ledger:{width:17,height:11},a0:{width:33.1,height:46.8},a1:{width:23.4,height:33.1},a2:{width:16.54,height:23.4},a3:{width:11.7,height:16.54},a4:{width:8.27,height:11.7},a5:{width:5.83,height:8.27},a6:{width:4.13,height:5.83}};class Wt{#_;#D;constructor(){this.#_=null,this.#D=null}setDefaultTimeout(e){this.#_=e}setDefaultNavigationTimeout(e){this.#D=e}navigationTimeout(){return null!==this.#D?this.#D:null!==this.#_?this.#_:3e4}timeout(){return null!==this.#_?this.#_:3e4}}class zt{static Guard=class{#P;constructor(e){this.#P=e}[ze](){return this.#P.release()}};#M=!1;#q=[];async acquire(){if(!this.#M)return this.#M=!0,new zt.Guard(this);const e=jt.create();return this.#q.push(e.resolve.bind(e)),await e.valueOrThrow(),new zt.Guard(this)}release(){const e=this.#q.shift();e?e():this.#M=!1}}var Gt=self&&self.__addDisposableResource||function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t},Qt=self&&self.__disposeResources||function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}return function e(){for(;t.stack.length;){var i=t.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(e,(function(t){return r(t),e()}))}catch(e){r(e)}}if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i});const Jt=new WeakSet;function Xt(e,t){let r=!1;if(e.prototype[ze]){const t=e.prototype[ze];e.prototype[ze]=function(){if(!Jt.has(this))return t.call(this);Jt.delete(this)},r=!0}if(e.prototype[Ge]){const t=e.prototype[Ge];e.prototype[Ge]=function(){if(!Jt.has(this))return t.call(this);Jt.delete(this)},r=!0}return r&&(e.prototype.move=function(){return Jt.add(this),this}),e}function Yt(e=(e=>`Attempted to use disposed ${e.constructor.name}.`)){return(t,r)=>function(...r){if(this.disposed)throw new Error(e(this));return t.call(this,...r)}}function Zt(e,t){const r=new WeakMap;let i=-1;return function(...t){if(-1===i&&(i=t.length),i!==t.length)throw new Error("Memoized method was called with the wrong number of arguments");let n=!1,s=r;for(const e of t)s.has(e)||(n=!0,s.set(e,new WeakMap)),s=s.get(e);if(n)return e.call(this,...t)}}function er(e=function(){return this}){return(t,r)=>{const i=new WeakMap;return async function(...r){const n={stack:[],error:void 0,hasError:!1};try{const s=e.call(this);let a=i.get(s);a||(a=new zt,i.set(s,a));Gt(n,await a.acquire(),!0);return await t.call(this,...r)}catch(e){n.error=e,n.hasError=!0}finally{const e=Qt(n);e&&await e}}}}var tr,rr=self&&self.__addDisposableResource||function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t},ir=self&&self.__disposeResources||function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}return function e(){for(;t.stack.length;){var i=t.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(e,(function(t){return r(t),e()}))}catch(e){r(e)}}if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i});!function(e){e.Action="action"}(tr||(tr={}));class nr extends Xe{static race(e){return dr.create(e)}visibility=null;_timeout=3e4;#A=!0;#O=!0;#N=!0;operators={conditions:(e,t)=>ve((r=>Re(...e.map((e=>e(r,t)))).pipe(Oe(r)))),retryAndRaceWithSignalAndTimer:e=>{const t=[];return e&&t.push(Ie(e,"abort").pipe(me((()=>{throw e.reason})))),t.push(Ft(this._timeout)),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return q(e)}(Ve({delay:ur}),Ke(...t))}};get timeout(){return this._timeout}setTimeout(e){const t=this._clone();return t._timeout=e,t}setVisibility(e){const t=this._clone();return t.visibility=e,t}setWaitForEnabled(e){const t=this._clone();return t.#O=e,t}setEnsureElementIsInTheViewport(e){const t=this._clone();return t.#A=e,t}setWaitForStableBoundingBox(e){const t=this._clone();return t.#N=e,t}copyOptions(e){return this._timeout=e._timeout,this.visibility=e.visibility,this.#O=e.#O,this.#A=e.#A,this.#N=e.#N,this}#B=(e,t)=>this.#O?pe(e.frame.waitForFunction((e=>{if(!(e instanceof HTMLElement))return!0;return!["BUTTON","INPUT","SELECT","TEXTAREA","OPTION","OPTGROUP"].includes(e.nodeName)||!e.hasAttribute("disabled")}),{timeout:this._timeout,signal:t},e)).pipe(Be()):z;#L=e=>this.#N?Ce((()=>pe(e.evaluate((e=>new Promise((t=>{window.requestAnimationFrame((()=>{const r=e.getBoundingClientRect();window.requestAnimationFrame((()=>{const i=e.getBoundingClientRect();t([{x:r.x,y:r.y,width:r.width,height:r.height},{x:i.x,y:i.y,width:i.width,height:i.height}])}))}))}))))))).pipe($e((([e,t])=>e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height)),Ve({delay:ur}),Be()):z;#j=e=>this.#A?pe(e.isIntersectingViewport({threshold:0})).pipe(Pe((e=>!e)),ve((()=>pe(e.scrollIntoView()))),ve((()=>Ce((()=>pe(e.isIntersectingViewport({threshold:0})))).pipe($e(M),Ve({delay:ur}),Be())))):z;#H(e){const t=e?.signal;return this._wait(e).pipe(this.operators.conditions([this.#j,this.#L,this.#B],t),Ue((()=>this.emit(tr.Action,void 0))),ve((t=>pe(t.click(e)).pipe(Ae((e=>{throw t.dispose().catch(pt),e}))))),this.operators.retryAndRaceWithSignalAndTimer(t))}#$(e,t){const r=t?.signal;return this._wait(t).pipe(this.operators.conditions([this.#j,this.#L,this.#B],r),Ue((()=>this.emit(tr.Action,void 0))),ve((t=>pe(t.evaluate((e=>e instanceof HTMLSelectElement?"select":e instanceof HTMLTextAreaElement?"typeable-input":e instanceof HTMLInputElement?new Set(["textarea","text","url","tel","search","password","number","email"]).has(e.type)?"typeable-input":"other-input":e.isContentEditable?"contenteditable":"unknown"))).pipe(ve((r=>{switch(r){case"select":return pe(t.select(e).then(b));case"contenteditable":case"typeable-input":return pe(t.evaluate(((e,t)=>{const r=e.isContentEditable?e.innerText:e.value;if(t.length<=r.length||!t.startsWith(e.value))return e.isContentEditable?e.innerText="":e.value="",t;const i=e.isContentEditable?e.innerText:e.value;return e.isContentEditable?(e.innerText="",e.innerText=i):(e.value="",e.value=i),t.substring(i.length)}),e)).pipe(ve((e=>pe(t.type(e)))));case"other-input":return pe(t.focus()).pipe(ve((()=>pe(t.evaluate(((e,t)=>{e.value=t,e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0}))}),e)))));case"unknown":throw new Error("Element cannot be filled out.")}}))).pipe(Ae((e=>{throw t.dispose().catch(pt),e}))))),this.operators.retryAndRaceWithSignalAndTimer(r))}#K(e){const t=e?.signal;return this._wait(e).pipe(this.operators.conditions([this.#j,this.#L],t),Ue((()=>this.emit(tr.Action,void 0))),ve((e=>pe(e.hover()).pipe(Ae((t=>{throw e.dispose().catch(pt),t}))))),this.operators.retryAndRaceWithSignalAndTimer(t))}#V(e){const t=e?.signal;return this._wait(e).pipe(this.operators.conditions([this.#j,this.#L],t),Ue((()=>this.emit(tr.Action,void 0))),ve((t=>pe(t.evaluate(((e,t,r)=>{void 0!==t&&(e.scrollTop=t),void 0!==r&&(e.scrollLeft=r)}),e?.scrollTop,e?.scrollLeft)).pipe(Ae((e=>{throw t.dispose().catch(pt),e}))))),this.operators.retryAndRaceWithSignalAndTimer(t))}clone(){return this._clone()}async waitHandle(e){return await ye(this._wait(e).pipe(this.operators.retryAndRaceWithSignalAndTimer(e?.signal)))}async wait(e){const t={stack:[],error:void 0,hasError:!1};try{const r=rr(t,await this.waitHandle(e),!1);return await r.jsonValue()}catch(e){t.error=e,t.hasError=!0}finally{ir(t)}}map(e){return new cr(this._clone(),(t=>t.evaluateHandle(e)))}filter(e){return new or(this._clone(),(async(t,r)=>(await t.frame.waitForFunction(e,{signal:r,timeout:this._timeout},t),!0)))}filterHandle(e){return new or(this._clone(),e)}mapHandle(e){return new cr(this._clone(),e)}click(e){return ye(this.#H(e))}fill(e,t){return ye(this.#$(e,t))}hover(e){return ye(this.#K(e))}scroll(e){return ye(this.#V(e))}}class sr extends nr{static create(e,t){return new sr(e,t).setTimeout("getDefaultTimeout"in e?e.getDefaultTimeout():e.page().getDefaultTimeout())}#U;#W;constructor(e,t){super(),this.#U=e,this.#W=t}_clone(){return new sr(this.#U,this.#W)}_wait(e){const t=e?.signal;return Ce((()=>pe(this.#U.waitForFunction(this.#W,{timeout:this.timeout,signal:t})))).pipe(je())}}class ar extends nr{#z;constructor(e){super(),this.#z=e,this.copyOptions(this.#z)}get delegate(){return this.#z}setTimeout(e){const t=super.setTimeout(e);return t.#z=this.#z.setTimeout(e),t}setVisibility(e){const t=super.setVisibility(e);return t.#z=t.#z.setVisibility(e),t}setWaitForEnabled(e){const t=super.setWaitForEnabled(e);return t.#z=this.#z.setWaitForEnabled(e),t}setEnsureElementIsInTheViewport(e){const t=super.setEnsureElementIsInTheViewport(e);return t.#z=this.#z.setEnsureElementIsInTheViewport(e),t}setWaitForStableBoundingBox(e){const t=super.setWaitForStableBoundingBox(e);return t.#z=this.#z.setWaitForStableBoundingBox(e),t}}class or extends ar{#G;constructor(e,t){super(e),this.#G=t}_clone(){return new or(this.delegate.clone(),this.#G).copyOptions(this)}_wait(e){return this.delegate._wait(e).pipe(ve((t=>pe(Promise.resolve(this.#G(t,e?.signal))).pipe(Pe((e=>e)),me((()=>t))))),je())}}class cr extends ar{#Q;constructor(e,t){super(e),this.#Q=t}_clone(){return new cr(this.delegate.clone(),this.#Q).copyOptions(this)}_wait(e){return this.delegate._wait(e).pipe(ve((t=>pe(Promise.resolve(this.#Q(t,e?.signal))))))}}class lr extends nr{static create(e,t){return new lr(e,t).setTimeout("getDefaultTimeout"in e?e.getDefaultTimeout():e.page().getDefaultTimeout())}#U;#J;constructor(e,t){super(),this.#U=e,this.#J=t}#X=e=>this.visibility?(()=>{switch(this.visibility){case"hidden":return Ce((()=>pe(e.isHidden())));case"visible":return Ce((()=>pe(e.isVisible())))}})().pipe($e(M),Ve({delay:ur}),Be()):z;_clone(){return new lr(this.#U,this.#J).copyOptions(this)}_wait(e){const t=e?.signal;return Ce((()=>pe(this.#U.waitForSelector(this.#J,{visible:!1,timeout:this._timeout,signal:t})))).pipe(Pe((e=>null!==e)),je(),this.operators.conditions([this.#X],t))}}class dr extends nr{static create(e){const t=function(e){for(const t of e)if(!(t instanceof nr))throw new Error("Unknown locator for race candidate");return e}(e);return new dr(t)}#Y;constructor(e){super(),this.#Y=e}_clone(){return new dr(this.#Y.map((e=>e.clone()))).copyOptions(this)}_wait(e){return Me(...this.#Y.map((t=>t._wait(e))))}}const ur=100;var hr=self&&self.__runInitializers||function(e,t,r){for(var i=arguments.length>2,n=0;n<t.length;n++)r=i?t[n].call(e,r):t[n].call(e);return i?r:void 0},pr=self&&self.__esDecorate||function(e,t,r,i,n,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,c=i.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?i.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,i.name):{}),h=!1,p=r.length-1;p>=0;p--){var f={};for(var y in i)f[y]="access"===y?{}:i[y];for(var y in i.access)f.access[y]=i.access[y];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var m=(0,r[p])("accessor"===c?{get:u.get,set:u.set}:u[l],f);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(o=a(m.get))&&(u.get=o),(o=a(m.set))&&(u.set=o),(o=a(m.init))&&n.unshift(o)}else(o=a(m))&&("field"===c?n.unshift(o):u[l]=o)}d&&Object.defineProperty(d,i.name,u),h=!0},fr=self&&self.__addDisposableResource||function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t},yr=self&&self.__disposeResources||function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}return function e(){for(;t.stack.length;){var i=t.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(e,(function(t){return r(t),e()}))}catch(e){r(e)}}if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i});let mr=(()=>{let e,t=Xe,r=[];return class extends t{static{const i="function"==typeof Symbol&&Symbol.metadata?Object.create(t[Symbol.metadata]??null):void 0;pr(this,null,e,{kind:"method",name:"screenshot",static:!1,private:!1,access:{has:e=>"screenshot"in e,get:e=>e.screenshot},metadata:i},null,r),i&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})}_isDragging=(hr(this,r),!1);_timeoutSettings=new Wt;#Z=new WeakMap;constructor(){super()}on(e,t){if("request"!==e)return super.on(e,t);let r=this.#Z.get(t);return void 0===r&&(r=e=>{e.enqueueInterceptAction((()=>t(e)))},this.#Z.set(t,r)),super.on(e,r)}off(e,t){return"request"===e&&(t=this.#Z.get(t)||t),super.off(e,t)}locator(e){return"string"==typeof e?lr.create(this,e):sr.create(this,e)}locatorRace(e){return nr.race(e)}async $(e){return await this.mainFrame().$(e)}async $$(e){return await this.mainFrame().$$(e)}async evaluateHandle(e,...t){return e=wt(this.evaluateHandle.name,e),await this.mainFrame().evaluateHandle(e,...t)}async $eval(e,t,...r){return t=wt(this.$eval.name,t),await this.mainFrame().$eval(e,t,...r)}async $$eval(e,t,...r){return t=wt(this.$$eval.name,t),await this.mainFrame().$$eval(e,t,...r)}async $x(e){return await this.mainFrame().$x(e)}async addScriptTag(e){return await this.mainFrame().addScriptTag(e)}async addStyleTag(e){return await this.mainFrame().addStyleTag(e)}url(){return this.mainFrame().url()}async content(){return await this.mainFrame().content()}async setContent(e,t){await this.mainFrame().setContent(e,t)}async goto(e,t){return await this.mainFrame().goto(e,t)}async waitForNavigation(e={}){return await this.mainFrame().waitForNavigation(e)}_waitForNetworkIdle(e,t,r=0){return Re(Ie(e,Bt.Request),Ie(e,Bt.Response),Ie(e,Bt.RequestFailed)).pipe(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=J(e);return N((function(t,i){(r?ke(e,t,r):ke(e,t)).subscribe(i)}))}(void 0),Pe((()=>e.inFlightRequestsCount()<=r)),(i=e=>function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pe(e,J(e))}(e).pipe(function(e,t){void 0===t&&(t=U);var r=Fe(e,t);return Le((function(){return r}))}(t)),N((function(e,t){var r=null,s=0,a=!1,o=function(){return a&&!r&&t.complete()};e.subscribe(B(t,(function(e){null==r||r.unsubscribe();var a=0,c=s++;ae(i(e,c)).subscribe(r=B(t,(function(r){return t.next(n?n(e,r,c,a++):r)}),(function(){r=null,o()})))}),(function(){a=!0,o()})))}))));var i,n}async waitForFrame(e,t={}){const{timeout:r=this.getDefaultTimeout()}=t;return bt(e)&&(e=t=>e===t.url()),await ye(Re(Ie(this,"frameattached"),Ie(this,"framenavigated"),pe(this.frames())).pipe(We(e),$e(),Ke(Ft(r),Ie(this,"close").pipe(me((()=>{throw new ht("Page closed.")}))))))}async emulate(e){await Promise.all([this.setUserAgent(e.userAgent),this.setViewport(e.viewport)])}async evaluate(e,...t){return e=wt(this.evaluate.name,e),await this.mainFrame().evaluate(e,...t)}async _maybeWriteBufferToFile(e,t){if(!e)return;const r=await Tt();await r.writeFile(e,t)}async screencast(e={}){const[{ScreenRecorder:t},[r,i,n]]=await Promise.all([import("./package/lib/esm/puppeteer/node/ScreenRecorder.js"),this.#ee()]);let s;if(e.crop){const{x:t,y:i,width:a,height:o}=br(vr(e.crop));if(t<0||i<0)throw new Error("`crop.x` and `crop.y` must be greater than or equal to 0.");if(a<=0||o<=0)throw new Error("`crop.height` and `crop.width` must be greater than or equal to 0.");const c=r/n,l=r/n;if(t+a>c)throw new Error(`\`crop.width\` cannot be larger than the viewport width (${c}).`);if(i+o>l)throw new Error(`\`crop.height\` cannot be larger than the viewport height (${l}).`);s={x:t*n,y:i*n,width:a*n,height:o*n}}if(void 0!==e.speed&&e.speed<=0)throw new Error("`speed` must be greater than 0.");if(void 0!==e.scale&&e.scale<=0)throw new Error("`scale` must be greater than 0.");const a=new t(this,r,i,{...e,path:e.ffmpegPath,crop:s});try{await this._startScreencast()}catch(e){throw a.stop(),e}if(e.path){const{createWriteStream:t}=await import("fs"),r=t(e.path,"binary");a.pipe(r)}return a}#te=0;#re;async _startScreencast(){++this.#te,this.#re||(this.#re=this.mainFrame().client.send("Page.startScreencast",{format:"png"}).then((()=>new Promise((e=>this.mainFrame().client.once("Page.screencastFrame",(()=>e()))))))),await this.#re}async _stopScreencast(){--this.#te,this.#re&&(this.#re=void 0,0===this.#te&&await this.mainFrame().client.send("Page.stopScreencast"))}async#ee(){const e={stack:[],error:void 0,hasError:!1};try{const t=this.viewport(),r=fr(e,new Qe,!1);return t&&0!==t.deviceScaleFactor&&(await this.setViewport({...t,deviceScaleFactor:0}),r.defer((()=>{this.setViewport(t).catch(pt)}))),await this.mainFrame().isolatedRealm().evaluate((()=>[window.visualViewport.width*window.devicePixelRatio,window.visualViewport.height*window.devicePixelRatio,window.devicePixelRatio]))}catch(t){e.error=t,e.hasError=!0}finally{yr(e)}}async screenshot(e={}){const t={stack:[],error:void 0,hasError:!1};try{await this.bringToFront();const r={...e,clip:e.clip?{...e.clip}:void 0};if(void 0===r.type&&void 0!==r.path){const e=r.path;switch(e.slice(e.lastIndexOf(".")+1).toLowerCase()){case"png":r.type="png";break;case"jpeg":case"jpg":r.type="jpeg";break;case"webp":r.type="webp"}}if(void 0!==r.quality){if(r.quality<0&&r.quality>100)throw new Error(`Expected 'quality' (${r.quality}) to be between 0 and 100, inclusive.`);if(void 0===r.type||!["jpeg","webp"].includes(r.type))throw new Error(`${r.type??"png"} screenshots do not support 'quality'.`)}if(r.clip){if(r.clip.width<=0)throw new Error("'width' in 'clip' must be positive.");if(r.clip.height<=0)throw new Error("'height' in 'clip' must be positive.")}!function(e){e.optimizeForSpeed??=!1,e.type??="png",e.fromSurface??=!0,e.fullPage??=!1,e.omitBackground??=!1,e.encoding??="binary",e.captureBeyondViewport??=!0}(r);const i=fr(t,new Je,!0);if(r.clip){if(r.fullPage)throw new Error("'clip' and 'fullPage' are mutually exclusive");r.clip=br(vr(r.clip))}else if(r.fullPage){if(!r.captureBeyondViewport){const e=await this.mainFrame().isolatedRealm().evaluate((()=>{const e=document.documentElement;return{width:e.scrollWidth,height:e.scrollHeight}})),t=this.viewport();await this.setViewport({...t,...e}),i.defer((async()=>{t?await this.setViewport(t).catch(pt):await this.setViewport({width:0,height:0}).catch(pt)}))}}else r.captureBeyondViewport=!1;const n=await this._screenshot(r);if("base64"===r.encoding)return n;const s=Buffer.from(n,"base64");return await this._maybeWriteBufferToFile(r.path,s),s}catch(e){t.error=e,t.hasError=!0}finally{const e=yr(t);e&&await e}}_getPDFOptions(e={},t="in"){let r=8.5,i=11;if(e.format){const t=Ut[e.format.toLowerCase()];et(t,"Unknown paper format: "+e.format),r=t.width,i=t.height}else r=wr(e.width,t)??r,i=wr(e.height,t)??i;const n={top:wr(e.margin?.top,t)||0,left:wr(e.margin?.left,t)||0,bottom:wr(e.margin?.bottom,t)||0,right:wr(e.margin?.right,t)||0};return{scale:1,displayHeaderFooter:!1,headerTemplate:"",footerTemplate:"",printBackground:!1,landscape:!1,pageRanges:"",preferCSSPageSize:!1,omitBackground:!1,timeout:3e4,tagged:!1,...e,width:r,height:i,margin:n}}async title(){return await this.mainFrame().title()}click(e,t){return this.mainFrame().click(e,t)}focus(e){return this.mainFrame().focus(e)}hover(e){return this.mainFrame().hover(e)}select(e,...t){return this.mainFrame().select(e,...t)}tap(e){return this.mainFrame().tap(e)}type(e,t,r){return this.mainFrame().type(e,t,r)}waitForTimeout(e){return this.mainFrame().waitForTimeout(e)}async waitForSelector(e,t={}){return await this.mainFrame().waitForSelector(e,t)}waitForXPath(e,t){return this.mainFrame().waitForXPath(e,t)}waitForFunction(e,t,...r){return this.mainFrame().waitForFunction(e,t,...r)}[(e=[er((function(){return this.browser()}))],ze)](){this.close().catch(pt)}[Ge](){return this.close()}}})();new Set(["Timestamp","Documents","Frames","JSEventListeners","Nodes","LayoutCount","RecalcStyleCount","LayoutDuration","RecalcStyleDuration","ScriptDuration","TaskDuration","JSHeapUsedSize","JSHeapTotalSize"]);const gr={px:1,in:96,cm:37.8,mm:3.78};function wr(e,t="in"){if(void 0===e)return;let r;if("number"==typeof(i=e)||i instanceof Number)r=e;else{if(!bt(e))throw new Error("page.pdf() Cannot handle parameter type: "+typeof e);{const t=e;let i=t.substring(t.length-2).toLowerCase(),n="";i in gr?n=t.substring(0,t.length-2):(i="px",n=t);const s=Number(n);et(!isNaN(s),"Failed to parse parameter value: "+t),r=s*gr[i]}}var i;return r/gr[t]}function vr(e){return{...e,...e.width<0?{x:e.x+e.width,width:-e.width}:{x:e.x,width:e.width},...e.height<0?{y:e.y+e.height,height:-e.height}:{y:e.y,height:e.height}}}function br(e){const t=Math.round(e.x),r=Math.round(e.y),i=Math.round(e.width+e.x-t),n=Math.round(e.height+e.y-r);return{...e,x:t,y:r,width:i,height:n}}class kr{#s;#ie;#ne;#se;constructor(e,t,r,i){this.#s=e,this.#ie=t,this.#ne=r,this.#se=i}type(){return this.#s}text(){return this.#ie}args(){return this.#ne}location(){return this.#se[0]??{}}stackTrace(){return this.#se}}class Cr{#ae;#oe;#ce=!1;constructor(e,t){this.#ae=e,this.#oe="selectSingle"!==t.mode}isMultiple(){return this.#oe}async accept(e){et(!this.#ce,"Cannot accept FileChooser which is already handled!"),this.#ce=!0,await this.#ae.uploadFile(...e)}async cancel(){et(!this.#ce,"Cannot cancel FileChooser which is already handled!"),this.#ce=!0,await this.#ae.evaluate((e=>{e.dispatchEvent(new Event("cancel",{bubbles:!0}))}))}}class Sr{#le;constructor(e){this.#le=e}updateClient(e){this.#le=e}async snapshot(e={}){const{interestingOnly:t=!0,root:r=null}=e,{nodes:i}=await this.#le.send("Accessibility.getFullAXTree");let n;if(r){const{node:e}=await this.#le.send("DOM.describeNode",{objectId:r.id});n=e.backendNodeId}const s=Tr.createTree(i);let a=s;if(n&&(a=s.find((e=>e.payload.backendDOMNodeId===n)),!a))return null;if(!t)return this.serializeTree(a)[0]??null;const o=new Set;return this.collectInterestingNodes(o,s,!1),o.has(a)?this.serializeTree(a,o)[0]??null:null}serializeTree(e,t){const r=[];for(const i of e.children)r.push(...this.serializeTree(i,t));if(t&&!t.has(e))return r;const i=e.serialize();return r.length&&(i.children=r),[i]}collectInterestingNodes(e,t,r){if(t.isInteresting(r)&&e.add(t),!t.isLeafNode()){r=r||t.isControl();for(const i of t.children)this.collectInterestingNodes(e,i,r)}}}class Tr{payload;children=[];#de=!1;#ue=!1;#he=!1;#pe=!1;#fe;#ye;#me;#ge;constructor(e){this.payload=e,this.#fe=this.payload.name?this.payload.name.value:"",this.#ye=this.payload.role?this.payload.role.value:"Unknown",this.#me=this.payload.ignored;for(const e of this.payload.properties||[])"editable"===e.name&&(this.#de="richtext"===e.value.value,this.#ue=!0),"focusable"===e.name&&(this.#he=e.value.value),"hidden"===e.name&&(this.#pe=e.value.value)}#we(){return!this.#de&&(!!this.#ue||("textbox"===this.#ye||"searchbox"===this.#ye))}#ve(){const e=this.#ye;return"LineBreak"===e||"text"===e||"InlineTextBox"===e||"StaticText"===e}#be(){if(void 0===this.#ge){this.#ge=!1;for(const e of this.children)if(e.#he||e.#be()){this.#ge=!0;break}}return this.#ge}find(e){if(e(this))return this;for(const t of this.children){const r=t.find(e);if(r)return r}return null}isLeafNode(){if(!this.children.length)return!0;if(this.#we()||this.#ve())return!0;switch(this.#ye){case"doc-cover":case"graphics-symbol":case"img":case"image":case"Meter":case"scrollbar":case"slider":case"separator":case"progressbar":return!0}return!this.#be()&&(!(!this.#he||!this.#fe)||!("heading"!==this.#ye||!this.#fe))}isControl(){switch(this.#ye){case"button":case"checkbox":case"ColorWell":case"combobox":case"DisclosureTriangle":case"listbox":case"menu":case"menubar":case"menuitem":case"menuitemcheckbox":case"menuitemradio":case"radio":case"scrollbar":case"searchbox":case"slider":case"spinbutton":case"switch":case"tab":case"textbox":case"tree":case"treeitem":return!0;default:return!1}}isInteresting(e){return"Ignored"!==this.#ye&&!this.#pe&&!this.#me&&(!(!this.#he&&!this.#de)||(!!this.isControl()||!e&&(this.isLeafNode()&&!!this.#fe)))}serialize(){const e=new Map;for(const t of this.payload.properties||[])e.set(t.name.toLowerCase(),t.value.value);this.payload.name&&e.set("name",this.payload.name.value),this.payload.value&&e.set("value",this.payload.value.value),this.payload.description&&e.set("description",this.payload.description.value);const t={role:this.#ye},r=["name","value","description","keyshortcuts","roledescription","valuetext"];for(const n of r)e.has(n)&&(t[n]=(i=n,e.get(i)));var i;const n=["disabled","expanded","focused","modal","multiline","multiselectable","readonly","required","selected"],s=t=>e.get(t);for(const e of n){if("focused"===e&&"RootWebArea"===this.#ye)continue;s(e)&&(t[e]=s(e))}const a=["checked","pressed"];for(const r of a){if(!e.has(r))continue;const i=e.get(r);t[r]="mixed"===i?"mixed":"true"===i}const o=["level","valuemax","valuemin"],c=t=>e.get(t);for(const r of o)e.has(r)&&(t[r]=c(r));const l=["autocomplete","haspopup","invalid","orientation"],d=t=>e.get(t);for(const e of l){const r=d(e);r&&"false"!==r&&(t[e]=d(e))}return t}static createTree(e){const t=new Map;for(const r of e)t.set(r.nodeId,new Tr(r));for(const e of t.values())for(const r of e.payload.childIds||[]){const i=t.get(r);i&&e.children.push(i)}return t.values().next().value}}var Er=self&&self.__runInitializers||function(e,t,r){for(var i=arguments.length>2,n=0;n<t.length;n++)r=i?t[n].call(e,r):t[n].call(e);return i?r:void 0},Ir=self&&self.__esDecorate||function(e,t,r,i,n,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,c=i.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?i.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,i.name):{}),h=!1,p=r.length-1;p>=0;p--){var f={};for(var y in i)f[y]="access"===y?{}:i[y];for(var y in i.access)f.access[y]=i.access[y];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var m=(0,r[p])("accessor"===c?{get:u.get,set:u.set}:u[l],f);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(o=a(m.get))&&(u.get=o),(o=a(m.set))&&(u.set=o),(o=a(m.init))&&n.unshift(o)}else(o=a(m))&&("field"===c?n.unshift(o):u[l]=o)}d&&Object.defineProperty(d,i.name,u),h=!0},xr=self&&self.__addDisposableResource||function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t},Fr=self&&self.__disposeResources||function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}return function e(){for(;t.stack.length;){var i=t.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(e,(function(t){return r(t),e()}))}catch(e){r(e)}}if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i});let Rr=(()=>{let e,t,r,i,n=[Xt],s=[],a=[];(class{static{t=this}static{const o="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;Ir(this,null,r,{kind:"method",name:"getProperty",static:!1,private:!1,access:{has:e=>"getProperty"in e,get:e=>e.getProperty},metadata:o},null,a),Ir(this,null,i,{kind:"method",name:"getProperties",static:!1,private:!1,access:{has:e=>"getProperties"in e,get:e=>e.getProperties},metadata:o},null,a),Ir(null,e={value:t},n,{kind:"class",name:t.name,metadata:o},null,s),t=e.value,o&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:o}),Er(t,s)}constructor(){Er(this,a)}async evaluate(e,...t){return e=wt(this.evaluate.name,e),await this.realm.evaluate(e,this,...t)}async evaluateHandle(e,...t){return e=wt(this.evaluateHandle.name,e),await this.realm.evaluateHandle(e,this,...t)}async getProperty(e){return await this.evaluateHandle(((e,t)=>e[t]),e)}async getProperties(){const e=await this.evaluate((e=>{const t=[],r=Object.getOwnPropertyDescriptors(e);for(const e in r)r[e]?.enumerable&&t.push(e);return t})),t=new Map,r=await Promise.all(e.map((e=>this.getProperty(e))));for(const[i,n]of Object.entries(e)){const e={stack:[],error:void 0,hasError:!1};try{const s=xr(e,r[i],!1);s&&t.set(n,s.move())}catch(t){e.error=t,e.hasError=!0}finally{Fr(e)}}return t}[(r=[Yt()],i=[Yt()],ze)](){this.dispose().catch(pt)}[Ge](){return this.dispose()}});return t})();var _r=self&&self.__addDisposableResource||function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t},Dr=self&&self.__disposeResources||function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}return function e(){for(;t.stack.length;){var i=t.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(e,(function(t){return r(t),e()}))}catch(e){r(e)}}if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i});class Pr{#fe;#ke;constructor(e,t){this.#fe=e,this.#ke=t}get name(){return this.#fe}async run(e,t,r,i){const n=new Qe;try{if(!i){const i={stack:[],error:void 0,hasError:!1};try{const s=_r(i,await e.evaluateHandle(((e,t)=>globalThis[e].args.get(t)),this.#fe,t),!1),a=await s.getProperties();for(const[e,t]of a)if(e in r)if("node"===t.remoteObject().subtype)r[+e]=t;else n.use(t);else n.use(t)}catch(e){i.error=e,i.hasError=!0}finally{Dr(i)}}await e.evaluate(((e,t,r)=>{const i=globalThis[e].callbacks;i.get(t).resolve(r),i.delete(t)}),this.#fe,t,await this.#ke(...r));for(const e of r)e instanceof Rr&&n.use(e)}catch(r){tt(r)?await e.evaluate(((e,t,r,i)=>{const n=new Error(r);n.stack=i;const s=globalThis[e].callbacks;s.get(t).reject(n),s.delete(t)}),this.#fe,t,r.message,r.stack).catch(pt):await e.evaluate(((e,t,r)=>{const i=globalThis[e].callbacks;i.get(t).reject(r),i.delete(t)}),this.#fe,t,r).catch(pt)}}}const Mr=st("puppeteer:protocol:SEND ►"),qr=st("puppeteer:protocol:RECV ◀");class Ar extends Xe{#Ce;#Se;#Te;#Ee;#Ie=new Map;#xe=!1;#Fe=new Set;#v=new $t;constructor(e,t,r=0,i){super(),this.#Ce=e,this.#Te=r,this.#Ee=i??18e4,this.#Se=t,this.#Se.onmessage=this.onMessage.bind(this),this.#Se.onclose=this.#Re.bind(this)}static fromSession(e){return e.connection()}get timeout(){return this.#Ee}get _closed(){return this.#xe}get _sessions(){return this.#Ie}session(e){return this.#Ie.get(e)||null}url(){return this.#Ce}send(e,...t){const r=t.length?t[0]:void 0;return this._rawSend(this.#v,e,r)}_rawSend(e,t,r,i){return e.create(t,this.#Ee,(e=>{const n=JSON.stringify({method:t,params:r,id:e,sessionId:i});Mr(n),this.#Se.send(n)}))}async closeBrowser(){await this.send("Browser.close")}async onMessage(e){this.#Te&&await new Promise((e=>setTimeout(e,this.#Te))),qr(e);const t=JSON.parse(e);if("Target.attachedToTarget"===t.method){const e=t.params.sessionId,r=new Vt(this,t.params.targetInfo.type,e,t.sessionId);this.#Ie.set(e,r),this.emit(Ot.SessionAttached,r);const i=this.#Ie.get(t.sessionId);i&&i.emit(Ot.SessionAttached,r)}else if("Target.detachedFromTarget"===t.method){const e=this.#Ie.get(t.params.sessionId);if(e){e._onClosed(),this.#Ie.delete(t.params.sessionId),this.emit(Ot.SessionDetached,e);const r=this.#Ie.get(t.sessionId);r&&r.emit(Ot.SessionDetached,e)}}if(t.sessionId){const e=this.#Ie.get(t.sessionId);e&&e._onMessage(t)}else t.id?t.error?this.#v.reject(t.id,it(t),t.error.message):this.#v.resolve(t.id,t.result):this.emit(t.method,t.params)}#Re(){if(!this.#xe){this.#xe=!0,this.#Se.onmessage=void 0,this.#Se.onclose=void 0,this.#v.clear();for(const e of this.#Ie.values())e._onClosed();this.#Ie.clear(),this.emit(Ot.Disconnected,void 0)}}dispose(){this.#Re(),this.#Se.close()}isAutoAttached(e){return!this.#Fe.has(e)}async _createSession(e,t=!0){t||this.#Fe.add(e.targetId);const{sessionId:r}=await this.send("Target.attachToTarget",{targetId:e.targetId,flatten:!0});this.#Fe.delete(e.targetId);const i=this.#Ie.get(r);if(!i)throw new Error("CDPSession creation failed.");return i}async createSession(e){return await this._createSession(e,!1)}}function Or(e){return e instanceof ht}class Nr{#_e;#De;constructor(e){this.#_e=new Br(e),this.#De=new Lr(e)}updateClient(e){this.#_e.updateClient(e),this.#De.updateClient(e)}async startJSCoverage(e={}){return await this.#_e.start(e)}async stopJSCoverage(){return await this.#_e.stop()}async startCSSCoverage(e={}){return await this.#De.start(e)}async stopCSSCoverage(){return await this.#De.stop()}}class Br{#le;#Pe=!1;#Me=new Map;#qe=new Map;#Ae;#Oe=!1;#Ne=!1;#Be=!1;constructor(e){this.#le=e}updateClient(e){this.#le=e}async start(e={}){et(!this.#Pe,"JSCoverage is already enabled");const{resetOnNavigation:t=!0,reportAnonymousScripts:r=!1,includeRawScriptCoverage:i=!1,useBlockCoverage:n=!0}=e;this.#Oe=t,this.#Ne=r,this.#Be=i,this.#Pe=!0,this.#Me.clear(),this.#qe.clear(),this.#Ae=new Qe,this.#Ae.use(new Ye(this.#le,"Debugger.scriptParsed",this.#Le.bind(this))),this.#Ae.use(new Ye(this.#le,"Runtime.executionContextsCleared",this.#je.bind(this))),await Promise.all([this.#le.send("Profiler.enable"),this.#le.send("Profiler.startPreciseCoverage",{callCount:this.#Be,detailed:n}),this.#le.send("Debugger.enable"),this.#le.send("Debugger.setSkipAllPauses",{skip:!0})])}#je(){this.#Oe&&(this.#Me.clear(),this.#qe.clear())}async#Le(e){if(!gt.isPuppeteerURL(e.url)&&(e.url||this.#Ne))try{const t=await this.#le.send("Debugger.getScriptSource",{scriptId:e.scriptId});this.#Me.set(e.scriptId,e.url),this.#qe.set(e.scriptId,t.scriptSource)}catch(e){pt(e)}}async stop(){et(this.#Pe,"JSCoverage is not enabled"),this.#Pe=!1;const e=await Promise.all([this.#le.send("Profiler.takePreciseCoverage"),this.#le.send("Profiler.stopPreciseCoverage"),this.#le.send("Profiler.disable"),this.#le.send("Debugger.disable")]);this.#Ae?.dispose();const t=[],r=e[0];for(const e of r.result){let r=this.#Me.get(e.scriptId);!r&&this.#Ne&&(r="debugger://VM"+e.scriptId);const i=this.#qe.get(e.scriptId);if(void 0===i||void 0===r)continue;const n=[];for(const t of e.functions)n.push(...t.ranges);const s=jr(n);this.#Be?t.push({url:r,ranges:s,text:i,rawScriptCoverage:e}):t.push({url:r,ranges:s,text:i})}return t}}class Lr{#le;#Pe=!1;#He=new Map;#$e=new Map;#Ke;#Oe=!1;constructor(e){this.#le=e}updateClient(e){this.#le=e}async start(e={}){et(!this.#Pe,"CSSCoverage is already enabled");const{resetOnNavigation:t=!0}=e;this.#Oe=t,this.#Pe=!0,this.#He.clear(),this.#$e.clear(),this.#Ke=new Qe,this.#Ke.use(new Ye(this.#le,"CSS.styleSheetAdded",this.#Ve.bind(this))),this.#Ke.use(new Ye(this.#le,"Runtime.executionContextsCleared",this.#je.bind(this))),await Promise.all([this.#le.send("DOM.enable"),this.#le.send("CSS.enable"),this.#le.send("CSS.startRuleUsageTracking")])}#je(){this.#Oe&&(this.#He.clear(),this.#$e.clear())}async#Ve(e){const t=e.header;if(t.sourceURL)try{const e=await this.#le.send("CSS.getStyleSheetText",{styleSheetId:t.styleSheetId});this.#He.set(t.styleSheetId,t.sourceURL),this.#$e.set(t.styleSheetId,e.text)}catch(e){pt(e)}}async stop(){et(this.#Pe,"CSSCoverage is not enabled"),this.#Pe=!1;const e=await this.#le.send("CSS.stopRuleUsageTracking");await Promise.all([this.#le.send("CSS.disable"),this.#le.send("DOM.disable")]),this.#Ke?.dispose();const t=new Map;for(const r of e.ruleUsage){let e=t.get(r.styleSheetId);e||(e=[],t.set(r.styleSheetId,e)),e.push({startOffset:r.startOffset,endOffset:r.endOffset,count:r.used?1:0})}const r=[];for(const e of this.#He.keys()){const i=this.#He.get(e);et(void 0!==i,`Stylesheet URL is undefined (styleSheetId=${e})`);const n=this.#$e.get(e);et(void 0!==n,`Stylesheet text is undefined (styleSheetId=${e})`);const s=jr(t.get(e)||[]);r.push({url:i,ranges:s,text:n})}return r}}function jr(e){const t=[];for(const r of e)t.push({offset:r.startOffset,type:0,range:r}),t.push({offset:r.endOffset,type:1,range:r});t.sort(((e,t)=>{if(e.offset!==t.offset)return e.offset-t.offset;if(e.type!==t.type)return t.type-e.type;const r=e.range.endOffset-e.range.startOffset,i=t.range.endOffset-t.range.startOffset;return 0===e.type?i-r:r-i}));const r=[],i=[];let n=0;for(const e of t){if(r.length&&n<e.offset&&r[r.length-1]>0){const t=i[i.length-1];t&&t.end===n?t.end=e.offset:i.push({start:n,end:e.offset})}n=e.offset,0===e.type?r.push(e.range.count):r.pop()}return i.filter((e=>e.end-e.start>0))}class Hr{#s;#Ue;#We;#ce=!1;constructor(e,t,r=""){this.#s=e,this.#Ue=t,this.#We=r}type(){return this.#s}message(){return this.#Ue}defaultValue(){return this.#We}async accept(e){et(!this.#ce,"Cannot accept dialog which is already handled!"),this.#ce=!0,await this.sendCommand({accept:!0,text:e})}async dismiss(){et(!this.#ce,"Cannot dismiss dialog which is already handled!"),this.#ce=!0,await this.sendCommand({accept:!1})}}class $r extends Hr{#le;constructor(e,t,r,i=""){super(t,r,i),this.#le=e}async sendCommand(e){await this.#le.send("Page.handleJavaScriptDialog",{accept:e.accept,promptText:e.text})}}var Kr=self&&self.__runInitializers||function(e,t,r){for(var i=arguments.length>2,n=0;n<t.length;n++)r=i?t[n].call(e,r):t[n].call(e);return i?r:void 0},Vr=self&&self.__esDecorate||function(e,t,r,i,n,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,c=i.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?i.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,i.name):{}),h=!1,p=r.length-1;p>=0;p--){var f={};for(var y in i)f[y]="access"===y?{}:i[y];for(var y in i.access)f.access[y]=i.access[y];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var m=(0,r[p])("accessor"===c?{get:u.get,set:u.set}:u[l],f);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(o=a(m.get))&&(u.get=o),(o=a(m.set))&&(u.set=o),(o=a(m.init))&&n.unshift(o)}else(o=a(m))&&("field"===c?n.unshift(o):u[l]=o)}d&&Object.defineProperty(d,i.name,u),h=!0},Ur=self&&self.__setFunctionName||function(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})};class Wr{#ze;#Ge;#Qe;constructor(e,t,r){this.#ze=e,this.#Ge=t,this.#Qe=r,this.#Ge.registerState(this)}async setState(e){this.#ze=e,await this.sync()}get state(){return this.#ze}async sync(){await Promise.all(this.#Ge.clients().map((e=>this.#Qe(e,this.#ze))))}}let zr=(()=>{let e,t,r,i,n,s,a,o,c,l,d,u,h,p,f,y,m,g,w,v,b=[];return class{static{const k="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;e=[Zt],r=[Zt],n=[Zt],a=[Zt],c=[Zt],d=[Zt],h=[Zt],f=[Zt],m=[Zt],w=[Zt],Vr(this,t={value:Ur((async function(e,t){if(!t.viewport)return;const{viewport:r}=t,i=r.isMobile||!1,n=r.width,s=r.height,a=r.deviceScaleFactor??1,o=r.isLandscape?{angle:90,type:"landscapePrimary"}:{angle:0,type:"portraitPrimary"},c=r.hasTouch||!1;await Promise.all([e.send("Emulation.setDeviceMetricsOverride",{mobile:i,width:n,height:s,deviceScaleFactor:a,screenOrientation:o}),e.send("Emulation.setTouchEmulationEnabled",{enabled:c})])}),"#applyViewport")},e,{kind:"method",name:"#applyViewport",static:!1,private:!0,access:{has:e=>#Je in e,get:e=>e.#Je},metadata:k},null,b),Vr(this,i={value:Ur((async function(e,t){t.active&&(t.overrides?await e.send("Emulation.setIdleOverride",{isUserActive:t.overrides.isUserActive,isScreenUnlocked:t.overrides.isScreenUnlocked}):await e.send("Emulation.clearIdleOverride"))}),"#emulateIdleState")},r,{kind:"method",name:"#emulateIdleState",static:!1,private:!0,access:{has:e=>#Xe in e,get:e=>e.#Xe},metadata:k},null,b),Vr(this,s={value:Ur((async function(e,t){if(t.active)try{await e.send("Emulation.setTimezoneOverride",{timezoneId:t.timezoneId||""})}catch(e){if(tt(e)&&e.message.includes("Invalid timezone"))throw new Error(`Invalid timezone ID: ${t.timezoneId}`);throw e}}),"#emulateTimezone")},n,{kind:"method",name:"#emulateTimezone",static:!1,private:!0,access:{has:e=>#Ye in e,get:e=>e.#Ye},metadata:k},null,b),Vr(this,o={value:Ur((async function(e,t){t.active&&await e.send("Emulation.setEmulatedVisionDeficiency",{type:t.visionDeficiency||"none"})}),"#emulateVisionDeficiency")},a,{kind:"method",name:"#emulateVisionDeficiency",static:!1,private:!0,access:{has:e=>#Ze in e,get:e=>e.#Ze},metadata:k},null,b),Vr(this,l={value:Ur((async function(e,t){t.active&&await e.send("Emulation.setCPUThrottlingRate",{rate:t.factor??1})}),"#emulateCpuThrottling")},c,{kind:"method",name:"#emulateCpuThrottling",static:!1,private:!0,access:{has:e=>#et in e,get:e=>e.#et},metadata:k},null,b),Vr(this,u={value:Ur((async function(e,t){t.active&&await e.send("Emulation.setEmulatedMedia",{features:t.mediaFeatures})}),"#emulateMediaFeatures")},d,{kind:"method",name:"#emulateMediaFeatures",static:!1,private:!0,access:{has:e=>#tt in e,get:e=>e.#tt},metadata:k},null,b),Vr(this,p={value:Ur((async function(e,t){t.active&&await e.send("Emulation.setEmulatedMedia",{media:t.type||""})}),"#emulateMediaType")},h,{kind:"method",name:"#emulateMediaType",static:!1,private:!0,access:{has:e=>#rt in e,get:e=>e.#rt},metadata:k},null,b),Vr(this,y={value:Ur((async function(e,t){t.active&&await e.send("Emulation.setGeolocationOverride",t.geoLocation?{longitude:t.geoLocation.longitude,latitude:t.geoLocation.latitude,accuracy:t.geoLocation.accuracy}:void 0)}),"#setGeolocation")},f,{kind:"method",name:"#setGeolocation",static:!1,private:!0,access:{has:e=>#it in e,get:e=>e.#it},metadata:k},null,b),Vr(this,g={value:Ur((async function(e,t){t.active&&await e.send("Emulation.setDefaultBackgroundColorOverride",{color:t.color})}),"#setDefaultBackgroundColor")},m,{kind:"method",name:"#setDefaultBackgroundColor",static:!1,private:!0,access:{has:e=>#nt in e,get:e=>e.#nt},metadata:k},null,b),Vr(this,v={value:Ur((async function(e,t){t.active&&await e.send("Emulation.setScriptExecutionDisabled",{value:!t.javaScriptEnabled})}),"#setJavaScriptEnabled")},w,{kind:"method",name:"#setJavaScriptEnabled",static:!1,private:!0,access:{has:e=>#st in e,get:e=>e.#st},metadata:k},null,b),k&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:k})}#le=void Kr(this,b);#at=!1;#ot=!1;#ct=[];#lt=new Wr({active:!1},this,this.#Je);#dt=new Wr({active:!1},this,this.#Xe);#ut=new Wr({active:!1},this,this.#Ye);#ht=new Wr({active:!1},this,this.#Ze);#pt=new Wr({active:!1},this,this.#et);#ft=new Wr({active:!1},this,this.#tt);#yt=new Wr({active:!1},this,this.#rt);#mt=new Wr({active:!1},this,this.#it);#gt=new Wr({active:!1},this,this.#nt);#wt=new Wr({javaScriptEnabled:!0,active:!1},this,this.#st);#vt=new Set;constructor(e){this.#le=e}updateClient(e){this.#le=e,this.#vt.delete(e)}registerState(e){this.#ct.push(e)}clients(){return[this.#le,...Array.from(this.#vt)]}async registerSpeculativeSession(e){this.#vt.add(e),e.once(Ot.Disconnected,(()=>{this.#vt.delete(e)})),Promise.all(this.#ct.map((e=>e.sync().catch(pt))))}get javascriptEnabled(){return this.#wt.state.javaScriptEnabled}async emulateViewport(e){await this.#lt.setState({viewport:e,active:!0});const t=e.isMobile||!1,r=e.hasTouch||!1,i=this.#at!==t||this.#ot!==r;return this.#at=t,this.#ot=r,i}get#Je(){return t.value}async emulateIdleState(e){await this.#dt.setState({active:!0,overrides:e})}get#Xe(){return i.value}get#Ye(){return s.value}async emulateTimezone(e){await this.#ut.setState({timezoneId:e,active:!0})}get#Ze(){return o.value}async emulateVisionDeficiency(e){const t=new Set(["none","achromatopsia","blurredVision","deuteranopia","protanopia","tritanopia"]);et(!e||t.has(e),`Unsupported vision deficiency: ${e}`),await this.#ht.setState({active:!0,visionDeficiency:e})}get#et(){return l.value}async emulateCPUThrottling(e){et(null===e||e>=1,"Throttling rate should be greater or equal to 1"),await this.#pt.setState({active:!0,factor:e??void 0})}get#tt(){return u.value}async emulateMediaFeatures(e){if(Array.isArray(e))for(const t of e){const e=t.name;et(/^(?:prefers-(?:color-scheme|reduced-motion)|color-gamut)$/.test(e),"Unsupported media feature: "+e)}await this.#ft.setState({active:!0,mediaFeatures:e})}get#rt(){return p.value}async emulateMediaType(e){et("screen"===e||"print"===e||void 0===(e??void 0),"Unsupported media type: "+e),await this.#yt.setState({type:e,active:!0})}get#it(){return y.value}async setGeolocation(e){const{longitude:t,latitude:r,accuracy:i=0}=e;if(t<-180||t>180)throw new Error(`Invalid longitude "${t}": precondition -180 <= LONGITUDE <= 180 failed.`);if(r<-90||r>90)throw new Error(`Invalid latitude "${r}": precondition -90 <= LATITUDE <= 90 failed.`);if(i<0)throw new Error(`Invalid accuracy "${i}": precondition 0 <= ACCURACY failed.`);await this.#mt.setState({active:!0,geoLocation:{longitude:t,latitude:r,accuracy:i}})}get#nt(){return g.value}async resetDefaultBackgroundColor(){await this.#gt.setState({active:!0,color:void 0})}async setTransparentBackgroundColor(){await this.#gt.setState({active:!0,color:{r:0,g:0,b:0,a:0}})}get#st(){return v.value}async setJavaScriptEnabled(e){await this.#wt.setState({active:!0,javaScriptEnabled:e})}}})();class Gr{static create=e=>new Gr(e);#bt;constructor(e){this.#bt=e}async get(e){return await this.#bt(e)}}const Qr=new class{#kt=!1;#Ct=new Set;append(e){this.#St((()=>{this.#Ct.add(e)}))}pop(e){this.#St((()=>{this.#Ct.delete(e)}))}inject(e,t=!1){(this.#kt||t)&&e(this.#bt()),this.#kt=!1}#St(e){e(),this.#kt=!0}#bt(){return`(() => {\n      const module = {};\n      "use strict";var C=Object.defineProperty;var ne=Object.getOwnPropertyDescriptor;var oe=Object.getOwnPropertyNames;var se=Object.prototype.hasOwnProperty;var u=(t,e)=>{for(var n in e)C(t,n,{get:e[n],enumerable:!0})},ie=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of oe(e))!se.call(t,o)&&o!==n&&C(t,o,{get:()=>e[o],enumerable:!(r=ne(e,o))||r.enumerable});return t};var le=t=>ie(C({},"__esModule",{value:!0}),t);var Oe={};u(Oe,{default:()=>Re});module.exports=le(Oe);var T=class extends Error{constructor(e){super(e),this.name=this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}},S=class extends T{},I=class extends T{#e;#t="";set code(e){this.#e=e}get code(){return this.#e}set originalMessage(e){this.#t=e}get originalMessage(){return this.#t}};var qe=Object.freeze({TimeoutError:S,ProtocolError:I});var f=class t{#e=!1;#t=!1;#n;#r=()=>{};#o=new Promise(e=>{this.#r=e});#s;#i;constructor(e){e&&e.timeout>0&&(this.#i=new S(e.message),this.#s=setTimeout(()=>{this.reject(this.#i)},e.timeout))}#l(e){clearTimeout(this.#s),this.#n=e,this.#r()}resolve(e){this.#t||this.#e||(this.#e=!0,this.#l(e))}reject(e){this.#t||this.#e||(this.#t=!0,this.#l(e))}resolved(){return this.#e}finished(){return this.#e||this.#t}value(){return this.#n}async valueOrThrow(){if(await this.#o,this.#t)throw this.#n;return this.#n}static create(e){return new t(e)}static async race(e){let n=new Set;try{let r=e.map(o=>o instanceof t?(o.#s&&n.add(o),o.valueOrThrow()):o);return await Promise.race(r)}finally{for(let r of n)r.reject(new Error("Timeout cleared"))}}};var X=new Map,G=t=>{let e=X.get(t);return e||(e=new Function(\`return \${t}\`)(),X.set(t,e),e)};var R={};u(R,{ariaQuerySelector:()=>ae,ariaQuerySelectorAll:()=>k});var ae=(t,e)=>window.__ariaQuerySelector(t,e),k=async function*(t,e){yield*await window.__ariaQuerySelectorAll(t,e)};var q={};u(q,{customQuerySelectors:()=>M});var O=class{#e=new Map;register(e,n){if(!n.queryOne&&n.queryAll){let r=n.queryAll;n.queryOne=(o,i)=>{for(let s of r(o,i))return s;return null}}else if(n.queryOne&&!n.queryAll){let r=n.queryOne;n.queryAll=(o,i)=>{let s=r(o,i);return s?[s]:[]}}else if(!n.queryOne||!n.queryAll)throw new Error("At least one query method must be defined.");this.#e.set(e,{querySelector:n.queryOne,querySelectorAll:n.queryAll})}unregister(e){this.#e.delete(e)}get(e){return this.#e.get(e)}clear(){this.#e.clear()}},M=new O;var D={};u(D,{pierceQuerySelector:()=>ce,pierceQuerySelectorAll:()=>ue});var ce=(t,e)=>{let n=null,r=o=>{let i=document.createTreeWalker(o,NodeFilter.SHOW_ELEMENT);do{let s=i.currentNode;s.shadowRoot&&r(s.shadowRoot),!(s instanceof ShadowRoot)&&s!==o&&!n&&s.matches(e)&&(n=s)}while(!n&&i.nextNode())};return t instanceof Document&&(t=t.documentElement),r(t),n},ue=(t,e)=>{let n=[],r=o=>{let i=document.createTreeWalker(o,NodeFilter.SHOW_ELEMENT);do{let s=i.currentNode;s.shadowRoot&&r(s.shadowRoot),!(s instanceof ShadowRoot)&&s!==o&&s.matches(e)&&n.push(s)}while(i.nextNode())};return t instanceof Document&&(t=t.documentElement),r(t),n};var m=(t,e)=>{if(!t)throw new Error(e)};var E=class{#e;#t;#n;#r;constructor(e,n){this.#e=e,this.#t=n}async start(){let e=this.#r=f.create(),n=await this.#e();if(n){e.resolve(n);return}this.#n=new MutationObserver(async()=>{let r=await this.#e();r&&(e.resolve(r),await this.stop())}),this.#n.observe(this.#t,{childList:!0,subtree:!0,attributes:!0})}async stop(){m(this.#r,"Polling never started."),this.#r.finished()||this.#r.reject(new Error("Polling stopped")),this.#n&&(this.#n.disconnect(),this.#n=void 0)}result(){return m(this.#r,"Polling never started."),this.#r.valueOrThrow()}},P=class{#e;#t;constructor(e){this.#e=e}async start(){let e=this.#t=f.create(),n=await this.#e();if(n){e.resolve(n);return}let r=async()=>{if(e.finished())return;let o=await this.#e();if(!o){window.requestAnimationFrame(r);return}e.resolve(o),await this.stop()};window.requestAnimationFrame(r)}async stop(){m(this.#t,"Polling never started."),this.#t.finished()||this.#t.reject(new Error("Polling stopped"))}result(){return m(this.#t,"Polling never started."),this.#t.valueOrThrow()}},x=class{#e;#t;#n;#r;constructor(e,n){this.#e=e,this.#t=n}async start(){let e=this.#r=f.create(),n=await this.#e();if(n){e.resolve(n);return}this.#n=setInterval(async()=>{let r=await this.#e();r&&(e.resolve(r),await this.stop())},this.#t)}async stop(){m(this.#r,"Polling never started."),this.#r.finished()||this.#r.reject(new Error("Polling stopped")),this.#n&&(clearInterval(this.#n),this.#n=void 0)}result(){return m(this.#r,"Polling never started."),this.#r.valueOrThrow()}};var W={};u(W,{pQuerySelector:()=>Ie,pQuerySelectorAll:()=>re});var c=class{static async*map(e,n){for await(let r of e)yield await n(r)}static async*flatMap(e,n){for await(let r of e)yield*n(r)}static async collect(e){let n=[];for await(let r of e)n.push(r);return n}static async first(e){for await(let n of e)return n}};var p={attribute:/\\[\\s*(?:(?<namespace>\\*|[-\\w\\P{ASCII}]*)\\|)?(?<name>[-\\w\\P{ASCII}]+)\\s*(?:(?<operator>\\W?=)\\s*(?<value>.+?)\\s*(\\s(?<caseSensitive>[iIsS]))?\\s*)?\\]/gu,id:/#(?<name>[-\\w\\P{ASCII}]+)/gu,class:/\\.(?<name>[-\\w\\P{ASCII}]+)/gu,comma:/\\s*,\\s*/g,combinator:/\\s*[\\s>+~]\\s*/g,"pseudo-element":/::(?<name>[-\\w\\P{ASCII}]+)(?:\\((?<argument>¶*)\\))?/gu,"pseudo-class":/:(?<name>[-\\w\\P{ASCII}]+)(?:\\((?<argument>¶*)\\))?/gu,universal:/(?:(?<namespace>\\*|[-\\w\\P{ASCII}]*)\\|)?\\*/gu,type:/(?:(?<namespace>\\*|[-\\w\\P{ASCII}]*)\\|)?(?<name>[-\\w\\P{ASCII}]+)/gu},fe=new Set(["combinator","comma"]);var de=t=>{switch(t){case"pseudo-element":case"pseudo-class":return new RegExp(p[t].source.replace("(?<argument>\\xB6*)","(?<argument>.*)"),"gu");default:return p[t]}};function me(t,e){let n=0,r="";for(;e<t.length;e++){let o=t[e];switch(o){case"(":++n;break;case")":--n;break}if(r+=o,n===0)return r}return r}function he(t,e=p){if(!t)return[];let n=[t];for(let[o,i]of Object.entries(e))for(let s=0;s<n.length;s++){let l=n[s];if(typeof l!="string")continue;i.lastIndex=0;let a=i.exec(l);if(!a)continue;let h=a.index-1,d=[],H=a[0],B=l.slice(0,h+1);B&&d.push(B),d.push({...a.groups,type:o,content:H});let z=l.slice(h+H.length+1);z&&d.push(z),n.splice(s,1,...d)}let r=0;for(let o of n)switch(typeof o){case"string":throw new Error(\`Unexpected sequence \${o} found at index \${r}\`);case"object":r+=o.content.length,o.pos=[r-o.content.length,r],fe.has(o.type)&&(o.content=o.content.trim()||" ");break}return n}var pe=/(['"])([^\\\\\\n]+?)\\1/g,ye=/\\\\./g;function K(t,e=p){if(t=t.trim(),t==="")return[];let n=[];t=t.replace(ye,(i,s)=>(n.push({value:i,offset:s}),"\\uE000".repeat(i.length))),t=t.replace(pe,(i,s,l,a)=>(n.push({value:i,offset:a}),\`\${s}\${"\\uE001".repeat(l.length)}\${s}\`));{let i=0,s;for(;(s=t.indexOf("(",i))>-1;){let l=me(t,s);n.push({value:l,offset:s}),t=\`\${t.substring(0,s)}(\${"\\xB6".repeat(l.length-2)})\${t.substring(s+l.length)}\`,i=s+l.length}}let r=he(t,e),o=new Set;for(let i of n.reverse())for(let s of r){let{offset:l,value:a}=i;if(!(s.pos[0]<=l&&l+a.length<=s.pos[1]))continue;let{content:h}=s,d=l-s.pos[0];s.content=h.slice(0,d)+a+h.slice(d+a.length),s.content!==h&&o.add(s)}for(let i of o){let s=de(i.type);if(!s)throw new Error(\`Unknown token type: \${i.type}\`);s.lastIndex=0;let l=s.exec(i.content);if(!l)throw new Error(\`Unable to parse content for \${i.type}: \${i.content}\`);Object.assign(i,l.groups)}return r}function*N(t,e){switch(t.type){case"list":for(let n of t.list)yield*N(n,t);break;case"complex":yield*N(t.left,t),yield*N(t.right,t);break;case"compound":yield*t.list.map(n=>[n,t]);break;default:yield[t,e]}}function y(t){let e;return Array.isArray(t)?e=t:e=[...N(t)].map(([n])=>n),e.map(n=>n.content).join("")}p.combinator=/\\s*(>>>>?|[\\s>+~])\\s*/g;var ge=/\\\\[\\s\\S]/g,we=t=>t.length<=1?t:((t[0]==='"'||t[0]==="'")&&t.endsWith(t[0])&&(t=t.slice(1,-1)),t.replace(ge,e=>e[1]));function Y(t){let e=!0,n=K(t);if(n.length===0)return[[],e];let r=[],o=[r],i=[o],s=[];for(let l of n){switch(l.type){case"combinator":switch(l.content){case">>>":e=!1,s.length&&(r.push(y(s)),s.splice(0)),r=[],o.push(">>>"),o.push(r);continue;case">>>>":e=!1,s.length&&(r.push(y(s)),s.splice(0)),r=[],o.push(">>>>"),o.push(r);continue}break;case"pseudo-element":if(!l.name.startsWith("-p-"))break;e=!1,s.length&&(r.push(y(s)),s.splice(0)),r.push({name:l.name.slice(3),value:we(l.argument??"")});continue;case"comma":s.length&&(r.push(y(s)),s.splice(0)),r=[],o=[r],i.push(o);continue}s.push(l)}return s.length&&r.push(y(s)),[i,e]}var Q={};u(Q,{textQuerySelectorAll:()=>b});var Se=new Set(["checkbox","image","radio"]),be=t=>t instanceof HTMLSelectElement||t instanceof HTMLTextAreaElement||t instanceof HTMLInputElement&&!Se.has(t.type),Te=new Set(["SCRIPT","STYLE"]),w=t=>!Te.has(t.nodeName)&&!document.head?.contains(t),_=new WeakMap,Z=t=>{for(;t;)_.delete(t),t instanceof ShadowRoot?t=t.host:t=t.parentNode},J=new WeakSet,Ee=new MutationObserver(t=>{for(let e of t)Z(e.target)}),g=t=>{let e=_.get(t);if(e||(e={full:"",immediate:[]},!w(t)))return e;let n="";if(be(t))e.full=t.value,e.immediate.push(t.value),t.addEventListener("input",r=>{Z(r.target)},{once:!0,capture:!0});else{for(let r=t.firstChild;r;r=r.nextSibling){if(r.nodeType===Node.TEXT_NODE){e.full+=r.nodeValue??"",n+=r.nodeValue??"";continue}n&&e.immediate.push(n),n="",r.nodeType===Node.ELEMENT_NODE&&(e.full+=g(r).full)}n&&e.immediate.push(n),t instanceof Element&&t.shadowRoot&&(e.full+=g(t.shadowRoot).full),J.has(t)||(Ee.observe(t,{childList:!0,characterData:!0,subtree:!0}),J.add(t))}return _.set(t,e),e};var b=function*(t,e){let n=!1;for(let r of t.childNodes)if(r instanceof Element&&w(r)){let o;r.shadowRoot?o=b(r.shadowRoot,e):o=b(r,e);for(let i of o)yield i,n=!0}n||t instanceof Element&&w(t)&&g(t).full.includes(e)&&(yield t)};var $={};u($,{checkVisibility:()=>xe,pierce:()=>A,pierceAll:()=>L});var Pe=["hidden","collapse"],xe=(t,e)=>{if(!t)return e===!1;if(e===void 0)return t;let n=t.nodeType===Node.TEXT_NODE?t.parentElement:t,r=window.getComputedStyle(n),o=r&&!Pe.includes(r.visibility)&&!Ne(n);return e===o?t:!1};function Ne(t){let e=t.getBoundingClientRect();return e.width===0||e.height===0}var Ae=t=>"shadowRoot"in t&&t.shadowRoot instanceof ShadowRoot;function*A(t){Ae(t)?yield t.shadowRoot:yield t}function*L(t){t=A(t).next().value,yield t;let e=[document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT)];for(let n of e){let r;for(;r=n.nextNode();)r.shadowRoot&&(yield r.shadowRoot,e.push(document.createTreeWalker(r.shadowRoot,NodeFilter.SHOW_ELEMENT)))}}var U={};u(U,{xpathQuerySelectorAll:()=>j});var j=function*(t,e,n=-1){let o=(t.ownerDocument||document).evaluate(e,t,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE),i=[],s;for(;(s=o.iterateNext())&&(i.push(s),!(n&&i.length===n)););for(let l=0;l<i.length;l++)s=i[l],yield s,delete i[l]};var ve=/[-\\w\\P{ASCII}*]/,ee=t=>"querySelectorAll"in t,v=class extends Error{constructor(e,n){super(\`\${e} is not a valid selector: \${n}\`)}},F=class{#e;#t;#n=[];#r=void 0;elements;constructor(e,n,r){this.elements=[e],this.#e=n,this.#t=r,this.#o()}async run(){if(typeof this.#r=="string")switch(this.#r.trimStart()){case":scope":this.#o();break}for(;this.#r!==void 0;this.#o()){let e=this.#r,n=this.#e;typeof e=="string"?e[0]&&ve.test(e[0])?this.elements=c.flatMap(this.elements,async function*(r){ee(r)&&(yield*r.querySelectorAll(e))}):this.elements=c.flatMap(this.elements,async function*(r){if(!r.parentElement){if(!ee(r))return;yield*r.querySelectorAll(e);return}let o=0;for(let i of r.parentElement.children)if(++o,i===r)break;yield*r.parentElement.querySelectorAll(\`:scope>:nth-child(\${o})\${e}\`)}):this.elements=c.flatMap(this.elements,async function*(r){switch(e.name){case"text":yield*b(r,e.value);break;case"xpath":yield*j(r,e.value);break;case"aria":yield*k(r,e.value);break;default:let o=M.get(e.name);if(!o)throw new v(n,\`Unknown selector type: \${e.name}\`);yield*o.querySelectorAll(r,e.value)}})}}#o(){if(this.#n.length!==0){this.#r=this.#n.shift();return}if(this.#t.length===0){this.#r=void 0;return}let e=this.#t.shift();switch(e){case">>>>":{this.elements=c.flatMap(this.elements,A),this.#o();break}case">>>":{this.elements=c.flatMap(this.elements,L),this.#o();break}default:this.#n=e,this.#o();break}}},V=class{#e=new WeakMap;calculate(e,n=[]){if(e===null)return n;e instanceof ShadowRoot&&(e=e.host);let r=this.#e.get(e);if(r)return[...r,...n];let o=0;for(let s=e.previousSibling;s;s=s.previousSibling)++o;let i=this.calculate(e.parentNode,[o]);return this.#e.set(e,i),[...i,...n]}},te=(t,e)=>{if(t.length+e.length===0)return 0;let[n=-1,...r]=t,[o=-1,...i]=e;return n===o?te(r,i):n<o?-1:1},Ce=async function*(t){let e=new Set;for await(let r of t)e.add(r);let n=new V;yield*[...e.values()].map(r=>[r,n.calculate(r)]).sort(([,r],[,o])=>te(r,o)).map(([r])=>r)},re=function(t,e){let n,r;try{[n,r]=Y(e)}catch{return t.querySelectorAll(e)}if(r)return t.querySelectorAll(e);if(n.some(o=>{let i=0;return o.some(s=>(typeof s=="string"?++i:i=0,i>1))}))throw new v(e,"Multiple deep combinators found in sequence.");return Ce(c.flatMap(n,o=>{let i=new F(t,e,o);return i.run(),i.elements}))},Ie=async function(t,e){for await(let n of re(t,e))return n;return null};var ke=Object.freeze({...R,...q,...D,...W,...Q,...$,...U,Deferred:f,createFunction:G,createTextContent:g,IntervalPoller:x,isSuitableNodeForTextMatching:w,MutationPoller:E,RAFPoller:P}),Re=ke;\n\n      ${[...this.#Ct].map((e=>`(${e})(module.exports.default);`)).join("")}\n      return module.exports.default;\n    })()`}};class Jr{static async*map(e,t){for await(const r of e)yield await t(r)}static async*flatMap(e,t){for await(const r of e)yield*t(r)}static async collect(e){const t=[];for await(const r of e)t.push(r);return t}static async first(e){for await(const t of e)return t}}const Xr=new Map;function Yr(e){let t=e.toString();try{new Function(`(${t})`)}catch{let e="function ";t.startsWith("async ")&&(e=`async ${e}`,t=t.substring(6)),t=`${e}${t}`;try{new Function(`(${t})`)}catch{throw new Error("Passed function cannot be serialized!")}}return t}const Zr=(e,t)=>{let r=Yr(e);for(const[e,i]of Object.entries(t))r=r.replace(new RegExp(`PLACEHOLDER\\(\\s*(?:'${e}'|"${e}")\\s*\\)`,"g"),`(${i})`);return(e=>{let t=Xr.get(e);return t||(t=new Function(`return ${e}`)(),Xr.set(e,t),t)})(r)},ei=Symbol("_isElementHandle");var ti=self&&self.__addDisposableResource||function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t},ri=self&&self.__disposeResources||function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}return function e(){for(;t.stack.length;){var i=t.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(e,(function(t){return r(t),e()}))}catch(e){r(e)}}if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i});const ii=20;async function*ni(e,t){const r={stack:[],error:void 0,hasError:!1};try{const i=ti(r,await e.evaluateHandle((async(e,t)=>{const r=[];for(;r.length<t;){const t=await e.next();if(t.done)break;r.push(t.value)}return r}),t),!1),n=await i.getProperties(),s=n.values();return ti(r,new Qe,!1).defer((()=>{for(const e of s){const t={stack:[],error:void 0,hasError:!1};try{ti(t,e,!1)[ze]()}catch(e){t.error=e,t.hasError=!0}finally{ri(t)}}})),yield*s,0===n.size}catch(e){r.error=e,r.hasError=!0}finally{ri(r)}}async function*si(e){const t={stack:[],error:void 0,hasError:!1};try{const r=ti(t,await e.evaluateHandle((e=>async function*(){yield*e}())),!1);yield*async function*(e){let t=ii;for(;!(yield*ni(e,t));)t<<=1}(r)}catch(e){t.error=e,t.hasError=!0}finally{ri(t)}}var ai=self&&self.__addDisposableResource||function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t},oi=self&&self.__disposeResources||function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}return function e(){for(;t.stack.length;){var i=t.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(e,(function(t){return r(t),e()}))}catch(e){r(e)}}if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i});class ci{static querySelectorAll;static querySelector;static get _querySelector(){if(this.querySelector)return this.querySelector;if(!this.querySelectorAll)throw new Error("Cannot create default `querySelector`.");return this.querySelector=Zr((async(e,t,r)=>{const i=PLACEHOLDER("querySelectorAll")(e,t,r);for await(const e of i)return e;return null}),{querySelectorAll:Yr(this.querySelectorAll)})}static get _querySelectorAll(){if(this.querySelectorAll)return this.querySelectorAll;if(!this.querySelector)throw new Error("Cannot create default `querySelectorAll`.");return this.querySelectorAll=Zr((async function*(e,t,r){const i=PLACEHOLDER("querySelector"),n=await i(e,t,r);n&&(yield n)}),{querySelector:Yr(this.querySelector)})}static async*queryAll(e,t){const r={stack:[],error:void 0,hasError:!1};try{const i=ai(r,await e.evaluateHandle(this._querySelectorAll,t,Gr.create((e=>e.puppeteerUtil))),!1);yield*si(i)}catch(e){r.error=e,r.hasError=!0}finally{oi(r)}}static async queryOne(e,t){const r={stack:[],error:void 0,hasError:!1};try{const i=ai(r,await e.evaluateHandle(this._querySelector,t,Gr.create((e=>e.puppeteerUtil))),!1);return ei in i?i.move():null}catch(e){r.error=e,r.hasError=!0}finally{oi(r)}}static async waitFor(e,t,r){const i={stack:[],error:void 0,hasError:!1};try{let n;const s=ai(i,await(async()=>{if(ei in e)return n=e.frame,await n.isolatedRealm().adoptHandle(e);n=e})(),!1),{visible:a=!1,hidden:o=!1,timeout:c,signal:l}=r;try{const e={stack:[],error:void 0,hasError:!1};try{l?.throwIfAborted();const r=ai(e,await n.isolatedRealm().waitForFunction((async(e,t,r,i,n)=>{const s=e.createFunction(t),a=await s(i??document,r,e);return e.checkVisibility(a,n)}),{polling:a||o?"raf":"mutation",root:s,timeout:c,signal:l},Gr.create((e=>e.puppeteerUtil)),Yr(this._querySelector),t,s,!!a||!o&&void 0),!1);if(l?.aborted)throw l.reason;return ei in r?await n.mainRealm().transferHandle(r):null}catch(t){e.error=t,e.hasError=!0}finally{oi(e)}}catch(e){if(!tt(e))throw e;if("AbortError"===e.name)throw e;throw e.message=`Waiting for selector \`${t}\` failed: ${e.message}`,e}}catch(e){i.error=e,i.hasError=!0}finally{oi(i)}}}const li=new Set(["StaticText","InlineTextBox"]),di=e=>e.replace(/ +/g," ").trim(),ui=/\[\s*(?<attribute>\w+)\s*=\s*(?<quote>"|')(?<value>\\.|.*?(?=\k<quote>))\k<quote>\s*\]/g;class hi extends ci{static querySelector=async(e,t,{ariaQuerySelector:r})=>await r(e,t);static async*queryAll(e,t){const{name:r,role:i}=(e=>{const t={},r=e.replace(ui,((e,r,i,n)=>(r=r.trim(),et((e=>["name","role"].includes(e))(r),`Unknown aria attribute "${r}" in selector`),t[r]=di(n),"")));return r&&!t.name&&(t.name=di(r)),t})(t),n=await(async(e,t,r,i)=>{const{nodes:n}=await e.send("Accessibility.queryAXTree",{objectId:t.id,accessibleName:r,role:i});return n.filter((e=>!e.role||!li.has(e.role.value)))})(e.realm.environment.client,e,r,i);yield*Jr.map(n,(t=>e.realm.adoptBackendNode(t.backendDOMNodeId)))}static queryOne=async(e,t)=>await Jr.first(this.queryAll(e,t))??null}const pi=new class{#i=new Map;get(e){const t=this.#i.get(e);return t?t[1]:void 0}register(e,t){et(!this.#i.has(e),`Cannot register over existing handler: ${e}`),et(/^[a-zA-Z]+$/.test(e),"Custom query handler names may only contain [a-zA-Z]"),et(t.queryAll||t.queryOne,"At least one query method must be implemented.");const r=class extends ci{static querySelectorAll=Zr(((e,t,r)=>r.customQuerySelectors.get(PLACEHOLDER("name")).querySelectorAll(e,t)),{name:JSON.stringify(e)});static querySelector=Zr(((e,t,r)=>r.customQuerySelectors.get(PLACEHOLDER("name")).querySelector(e,t)),{name:JSON.stringify(e)})},i=Zr((e=>{e.customQuerySelectors.register(PLACEHOLDER("name"),{queryAll:PLACEHOLDER("queryAll"),queryOne:PLACEHOLDER("queryOne")})}),{name:JSON.stringify(e),queryAll:t.queryAll?Yr(t.queryAll):String(void 0),queryOne:t.queryOne?Yr(t.queryOne):String(void 0)}).toString();this.#i.set(e,[i,r]),Qr.append(i)}unregister(e){const t=this.#i.get(e);if(!t)throw new Error(`Cannot unregister unknown handler: ${e}`);Qr.pop(t[0]),this.#i.delete(e)}names(){return[...this.#i.keys()]}clear(){for(const[e]of this.#i)Qr.pop(e);this.#i.clear()}};class fi extends ci{static querySelectorAll=(e,t,{pQuerySelectorAll:r})=>r(e,t);static querySelector=(e,t,{pQuerySelector:r})=>r(e,t)}const yi={aria:hi,pierce:class extends ci{static querySelector=(e,t,{pierceQuerySelector:r})=>r(e,t);static querySelectorAll=(e,t,{pierceQuerySelectorAll:r})=>r(e,t)},xpath:class extends ci{static querySelectorAll=(e,t,{xpathQuerySelectorAll:r})=>r(e,t);static querySelector=(e,t,{xpathQuerySelectorAll:r})=>{for(const i of r(e,t,1))return i;return null}},text:class extends ci{static querySelectorAll=(e,t,{textQuerySelectorAll:r})=>r(e,t)}},mi=["=","/"];function gi(e){for(const t of[pi.names().map((e=>[e,pi.get(e)])),Object.entries(yi)])for(const[r,i]of t)for(const t of mi){const n=`${r}${t}`;if(e.startsWith(n))return{updatedSelector:e=e.slice(n.length),QueryHandler:i}}return{updatedSelector:e,QueryHandler:fi}}var wi=self&&self.__runInitializers||function(e,t,r){for(var i=arguments.length>2,n=0;n<t.length;n++)r=i?t[n].call(e,r):t[n].call(e);return i?r:void 0},vi=self&&self.__esDecorate||function(e,t,r,i,n,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,c=i.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?i.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,i.name):{}),h=!1,p=r.length-1;p>=0;p--){var f={};for(var y in i)f[y]="access"===y?{}:i[y];for(var y in i.access)f.access[y]=i.access[y];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var m=(0,r[p])("accessor"===c?{get:u.get,set:u.set}:u[l],f);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(o=a(m.get))&&(u.get=o),(o=a(m.set))&&(u.set=o),(o=a(m.init))&&n.unshift(o)}else(o=a(m))&&("field"===c?n.unshift(o):u[l]=o)}d&&Object.defineProperty(d,i.name,u),h=!0},bi=self&&self.__addDisposableResource||function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t},ki=self&&self.__disposeResources||function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}return function e(){for(;t.stack.length;){var i=t.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(e,(function(t){return r(t),e()}))}catch(e){r(e)}}if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i});let Ci=(()=>{var e,t,r,i,n,s,a,o,c,l,d,u,h,p,f,y,m,g,w,v,b,k,C,S,T,E,I,x,F,R,_,D;let P,M,q,A,O,N,B,L,j,H,$,K,V,U,W,z,G,Q,J,X,Y,Z,ee,te,re,ie,ne,se,ae,oe,ce,le,de=Rr,ue=[];return class he extends de{static{const pe="function"==typeof Symbol&&Symbol.metadata?Object.create(de[Symbol.metadata]??null):void 0;P=[Yt(),(e=he).bindIsolatedHandle.bind(e)],M=[Yt(),(t=he).bindIsolatedHandle.bind(t)],q=[Yt(),(r=he).bindIsolatedHandle.bind(r)],A=[Yt(),(i=he).bindIsolatedHandle.bind(i)],O=[Yt(),(n=he).bindIsolatedHandle.bind(n)],N=[Yt(),(s=he).bindIsolatedHandle.bind(s)],B=[Yt(),(a=he).bindIsolatedHandle.bind(a)],L=[Yt(),(o=he).bindIsolatedHandle.bind(o)],j=[Yt(),(c=he).bindIsolatedHandle.bind(c)],H=[Yt(),(l=he).bindIsolatedHandle.bind(l)],$=[Yt(),(d=he).bindIsolatedHandle.bind(d)],K=[Yt(),(u=he).bindIsolatedHandle.bind(u)],V=[Yt(),(h=he).bindIsolatedHandle.bind(h)],U=[Yt(),(p=he).bindIsolatedHandle.bind(p)],W=[Yt(),(f=he).bindIsolatedHandle.bind(f)],z=[Yt(),(y=he).bindIsolatedHandle.bind(y)],G=[Yt(),(m=he).bindIsolatedHandle.bind(m)],Q=[Yt(),(g=he).bindIsolatedHandle.bind(g)],J=[Yt(),(w=he).bindIsolatedHandle.bind(w)],X=[Yt(),(v=he).bindIsolatedHandle.bind(v)],Y=[Yt(),(b=he).bindIsolatedHandle.bind(b)],Z=[Yt(),(k=he).bindIsolatedHandle.bind(k)],ee=[Yt(),(C=he).bindIsolatedHandle.bind(C)],te=[Yt(),(S=he).bindIsolatedHandle.bind(S)],re=[Yt(),(T=he).bindIsolatedHandle.bind(T)],ie=[Yt(),(E=he).bindIsolatedHandle.bind(E)],ne=[Yt(),(I=he).bindIsolatedHandle.bind(I)],se=[Yt(),(x=he).bindIsolatedHandle.bind(x)],ae=[Yt(),(F=he).bindIsolatedHandle.bind(F)],oe=[Yt(),(R=he).bindIsolatedHandle.bind(R)],ce=[Yt(),(_=he).bindIsolatedHandle.bind(_)],le=[Yt(),(D=he).bindIsolatedHandle.bind(D)],vi(this,null,P,{kind:"method",name:"getProperty",static:!1,private:!1,access:{has:e=>"getProperty"in e,get:e=>e.getProperty},metadata:pe},null,ue),vi(this,null,M,{kind:"method",name:"getProperties",static:!1,private:!1,access:{has:e=>"getProperties"in e,get:e=>e.getProperties},metadata:pe},null,ue),vi(this,null,q,{kind:"method",name:"jsonValue",static:!1,private:!1,access:{has:e=>"jsonValue"in e,get:e=>e.jsonValue},metadata:pe},null,ue),vi(this,null,A,{kind:"method",name:"$",static:!1,private:!1,access:{has:e=>"$"in e,get:e=>e.$},metadata:pe},null,ue),vi(this,null,O,{kind:"method",name:"$$",static:!1,private:!1,access:{has:e=>"$$"in e,get:e=>e.$$},metadata:pe},null,ue),vi(this,null,N,{kind:"method",name:"$x",static:!1,private:!1,access:{has:e=>"$x"in e,get:e=>e.$x},metadata:pe},null,ue),vi(this,null,B,{kind:"method",name:"waitForSelector",static:!1,private:!1,access:{has:e=>"waitForSelector"in e,get:e=>e.waitForSelector},metadata:pe},null,ue),vi(this,null,L,{kind:"method",name:"isVisible",static:!1,private:!1,access:{has:e=>"isVisible"in e,get:e=>e.isVisible},metadata:pe},null,ue),vi(this,null,j,{kind:"method",name:"isHidden",static:!1,private:!1,access:{has:e=>"isHidden"in e,get:e=>e.isHidden},metadata:pe},null,ue),vi(this,null,H,{kind:"method",name:"waitForXPath",static:!1,private:!1,access:{has:e=>"waitForXPath"in e,get:e=>e.waitForXPath},metadata:pe},null,ue),vi(this,null,$,{kind:"method",name:"toElement",static:!1,private:!1,access:{has:e=>"toElement"in e,get:e=>e.toElement},metadata:pe},null,ue),vi(this,null,K,{kind:"method",name:"clickablePoint",static:!1,private:!1,access:{has:e=>"clickablePoint"in e,get:e=>e.clickablePoint},metadata:pe},null,ue),vi(this,null,V,{kind:"method",name:"hover",static:!1,private:!1,access:{has:e=>"hover"in e,get:e=>e.hover},metadata:pe},null,ue),vi(this,null,U,{kind:"method",name:"click",static:!1,private:!1,access:{has:e=>"click"in e,get:e=>e.click},metadata:pe},null,ue),vi(this,null,W,{kind:"method",name:"drag",static:!1,private:!1,access:{has:e=>"drag"in e,get:e=>e.drag},metadata:pe},null,ue),vi(this,null,z,{kind:"method",name:"dragEnter",static:!1,private:!1,access:{has:e=>"dragEnter"in e,get:e=>e.dragEnter},metadata:pe},null,ue),vi(this,null,G,{kind:"method",name:"dragOver",static:!1,private:!1,access:{has:e=>"dragOver"in e,get:e=>e.dragOver},metadata:pe},null,ue),vi(this,null,Q,{kind:"method",name:"drop",static:!1,private:!1,access:{has:e=>"drop"in e,get:e=>e.drop},metadata:pe},null,ue),vi(this,null,J,{kind:"method",name:"dragAndDrop",static:!1,private:!1,access:{has:e=>"dragAndDrop"in e,get:e=>e.dragAndDrop},metadata:pe},null,ue),vi(this,null,X,{kind:"method",name:"select",static:!1,private:!1,access:{has:e=>"select"in e,get:e=>e.select},metadata:pe},null,ue),vi(this,null,Y,{kind:"method",name:"tap",static:!1,private:!1,access:{has:e=>"tap"in e,get:e=>e.tap},metadata:pe},null,ue),vi(this,null,Z,{kind:"method",name:"touchStart",static:!1,private:!1,access:{has:e=>"touchStart"in e,get:e=>e.touchStart},metadata:pe},null,ue),vi(this,null,ee,{kind:"method",name:"touchMove",static:!1,private:!1,access:{has:e=>"touchMove"in e,get:e=>e.touchMove},metadata:pe},null,ue),vi(this,null,te,{kind:"method",name:"touchEnd",static:!1,private:!1,access:{has:e=>"touchEnd"in e,get:e=>e.touchEnd},metadata:pe},null,ue),vi(this,null,re,{kind:"method",name:"focus",static:!1,private:!1,access:{has:e=>"focus"in e,get:e=>e.focus},metadata:pe},null,ue),vi(this,null,ie,{kind:"method",name:"type",static:!1,private:!1,access:{has:e=>"type"in e,get:e=>e.type},metadata:pe},null,ue),vi(this,null,ne,{kind:"method",name:"press",static:!1,private:!1,access:{has:e=>"press"in e,get:e=>e.press},metadata:pe},null,ue),vi(this,null,se,{kind:"method",name:"boundingBox",static:!1,private:!1,access:{has:e=>"boundingBox"in e,get:e=>e.boundingBox},metadata:pe},null,ue),vi(this,null,ae,{kind:"method",name:"boxModel",static:!1,private:!1,access:{has:e=>"boxModel"in e,get:e=>e.boxModel},metadata:pe},null,ue),vi(this,null,oe,{kind:"method",name:"screenshot",static:!1,private:!1,access:{has:e=>"screenshot"in e,get:e=>e.screenshot},metadata:pe},null,ue),vi(this,null,ce,{kind:"method",name:"isIntersectingViewport",static:!1,private:!1,access:{has:e=>"isIntersectingViewport"in e,get:e=>e.isIntersectingViewport},metadata:pe},null,ue),vi(this,null,le,{kind:"method",name:"scrollIntoView",static:!1,private:!1,access:{has:e=>"scrollIntoView"in e,get:e=>e.scrollIntoView},metadata:pe},null,ue),pe&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:pe})}static bindIsolatedHandle(e,t){return async function(...t){const r={stack:[],error:void 0,hasError:!1};try{if(this.realm===this.frame.isolatedRealm())return await e.call(this,...t);const i=bi(r,await this.frame.isolatedRealm().adoptHandle(this),!1),n=await e.call(i,...t);return n===i?this:n instanceof Rr?await this.realm.transferHandle(n):(Array.isArray(n)&&await Promise.all(n.map((async(e,t,r)=>{e instanceof Rr&&(r[t]=await this.realm.transferHandle(e))}))),n instanceof Map&&await Promise.all([...n.entries()].map((async([e,t])=>{t instanceof Rr&&n.set(e,await this.realm.transferHandle(t))}))),n)}catch(e){r.error=e,r.hasError=!0}finally{ki(r)}}}handle=void wi(this,ue);constructor(e){super(),this.handle=e,this[ei]=!0}get id(){return this.handle.id}get disposed(){return this.handle.disposed}async getProperty(e){return await this.handle.getProperty(e)}async getProperties(){return await this.handle.getProperties()}async evaluate(e,...t){return e=wt(this.evaluate.name,e),await this.handle.evaluate(e,...t)}async evaluateHandle(e,...t){return e=wt(this.evaluateHandle.name,e),await this.handle.evaluateHandle(e,...t)}async jsonValue(){return await this.handle.jsonValue()}toString(){return this.handle.toString()}remoteObject(){return this.handle.remoteObject()}dispose(){return this.handle.dispose()}asElement(){return this}async $(e){const{updatedSelector:t,QueryHandler:r}=gi(e);return await r.queryOne(this,t)}async $$(e){const{updatedSelector:t,QueryHandler:r}=gi(e);return await Jr.collect(r.queryAll(this,t))}async $eval(e,t,...r){const i={stack:[],error:void 0,hasError:!1};try{t=wt(this.$eval.name,t);const n=bi(i,await this.$(e),!1);if(!n)throw new Error(`Error: failed to find element matching selector "${e}"`);return await n.evaluate(t,...r)}catch(e){i.error=e,i.hasError=!0}finally{ki(i)}}async $$eval(e,t,...r){const i={stack:[],error:void 0,hasError:!1};try{t=wt(this.$$eval.name,t);const n=await this.$$(e),s=bi(i,await this.evaluateHandle(((e,...t)=>t),...n),!1),[a]=await Promise.all([s.evaluate(t,...r),...n.map((e=>e.dispose()))]);return a}catch(e){i.error=e,i.hasError=!0}finally{ki(i)}}async $x(e){return e.startsWith("//")&&(e=`.${e}`),await this.$$(`xpath/${e}`)}async waitForSelector(e,t={}){const{updatedSelector:r,QueryHandler:i}=gi(e);return await i.waitFor(this,r,t)}async#Tt(e){return await this.evaluate((async(e,t,r)=>Boolean(t.checkVisibility(e,r))),Gr.create((e=>e.puppeteerUtil)),e)}async isVisible(){return await this.#Tt(!0)}async isHidden(){return await this.#Tt(!1)}async waitForXPath(e,t={}){return e.startsWith("//")&&(e=`.${e}`),await this.waitForSelector(`xpath/${e}`,t)}async toElement(e){const t=await this.evaluate(((e,t)=>e.nodeName===t.toUpperCase()),e);if(!t)throw new Error(`Element is not a(n) \`${e}\` element`);return this}async clickablePoint(e){const t=await this.#Et();if(!t)throw new Error("Node is either not clickable or not an Element");return void 0!==e?{x:t.x+e.x,y:t.y+e.y}:{x:t.x+t.width/2,y:t.y+t.height/2}}async hover(){await this.scrollIntoViewIfNeeded();const{x:e,y:t}=await this.clickablePoint();await this.frame.page().mouse.move(e,t)}async click(e={}){await this.scrollIntoViewIfNeeded();const{x:t,y:r}=await this.clickablePoint(e.offset);await this.frame.page().mouse.click(t,r,e)}async drag(e){await this.scrollIntoViewIfNeeded();const t=this.frame.page();if(t.isDragInterceptionEnabled()){const r=await this.clickablePoint();return e instanceof he&&(e=await e.clickablePoint()),await t.mouse.drag(r,e)}try{t._isDragging||(t._isDragging=!0,await this.hover(),await t.mouse.down()),e instanceof he?await e.hover():await t.mouse.move(e.x,e.y)}catch(e){throw t._isDragging=!1,e}}async dragEnter(e={items:[],dragOperationsMask:1}){const t=this.frame.page();await this.scrollIntoViewIfNeeded();const r=await this.clickablePoint();await t.mouse.dragEnter(r,e)}async dragOver(e={items:[],dragOperationsMask:1}){const t=this.frame.page();await this.scrollIntoViewIfNeeded();const r=await this.clickablePoint();await t.mouse.dragOver(r,e)}async drop(e={items:[],dragOperationsMask:1}){const t=this.frame.page();if("items"in e){await this.scrollIntoViewIfNeeded();const r=await this.clickablePoint();await t.mouse.drop(r,e)}else await e.drag(this),t._isDragging=!1,await t.mouse.up()}async dragAndDrop(e,t){const r=this.frame.page();et(r.isDragInterceptionEnabled(),"Drag Interception is not enabled!"),await this.scrollIntoViewIfNeeded();const i=await this.clickablePoint(),n=await e.clickablePoint();await r.mouse.dragAndDrop(i,n,t)}async select(...e){for(const t of e)et(bt(t),'Values must be strings. Found value "'+t+'" of type "'+typeof t+'"');return await this.evaluate(((e,t)=>{const r=new Set(t);if(!(e instanceof HTMLSelectElement))throw new Error("Element is not a <select> element.");const i=new Set;if(e.multiple)for(const t of e.options)t.selected=r.has(t.value),t.selected&&i.add(t.value);else{for(const t of e.options)t.selected=!1;for(const t of e.options)if(r.has(t.value)){t.selected=!0,i.add(t.value);break}}return e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})),[...i.values()]}),e)}async tap(){await this.scrollIntoViewIfNeeded();const{x:e,y:t}=await this.clickablePoint();await this.frame.page().touchscreen.tap(e,t)}async touchStart(){await this.scrollIntoViewIfNeeded();const{x:e,y:t}=await this.clickablePoint();await this.frame.page().touchscreen.touchStart(e,t)}async touchMove(){await this.scrollIntoViewIfNeeded();const{x:e,y:t}=await this.clickablePoint();await this.frame.page().touchscreen.touchMove(e,t)}async touchEnd(){await this.scrollIntoViewIfNeeded(),await this.frame.page().touchscreen.touchEnd()}async focus(){await this.evaluate((e=>{if(!(e instanceof HTMLElement))throw new Error("Cannot focus non-HTMLElement");return e.focus()}))}async type(e,t){await this.focus(),await this.frame.page().keyboard.type(e,t)}async press(e,t){await this.focus(),await this.frame.page().keyboard.press(e,t)}async#Et(){const e=await this.evaluate((e=>e instanceof Element?[...e.getClientRects()].map((e=>({x:e.x,y:e.y,width:e.width,height:e.height}))):null));if(!e?.length)return null;await this.#It(e);let t,r=this.frame;for(;t=r?.parentFrame();){const i={stack:[],error:void 0,hasError:!1};try{const n=bi(i,await r.frameElement(),!1);if(!n)throw new Error("Unsupported frame type");const s=await n.evaluate((e=>{if(0===e.getClientRects().length)return null;const t=e.getBoundingClientRect(),r=window.getComputedStyle(e);return{left:t.left+parseInt(r.paddingLeft,10)+parseInt(r.borderLeftWidth,10),top:t.top+parseInt(r.paddingTop,10)+parseInt(r.borderTopWidth,10)}}));if(!s)return null;for(const t of e)t.x+=s.left,t.y+=s.top;await n.#It(e),r=t}catch(e){i.error=e,i.hasError=!0}finally{ki(i)}}const i=e.find((e=>e.width>=1&&e.height>=1));return i?{x:i.x,y:i.y,height:i.height,width:i.width}:null}async#It(e){const{documentWidth:t,documentHeight:r}=await this.frame.isolatedRealm().evaluate((()=>({documentWidth:document.documentElement.clientWidth,documentHeight:document.documentElement.clientHeight})));for(const i of e)Si(i,t,r)}async boundingBox(){const e=await this.evaluate((e=>{if(!(e instanceof Element))return null;if(0===e.getClientRects().length)return null;const t=e.getBoundingClientRect();return{x:t.x,y:t.y,width:t.width,height:t.height}}));if(!e)return null;const t=await this.#xt();return t?{x:e.x+t.x,y:e.y+t.y,height:e.height,width:e.width}:null}async boxModel(){const e=await this.evaluate((e=>{if(!(e instanceof Element))return null;if(0===e.getClientRects().length)return null;const t=e.getBoundingClientRect(),r=window.getComputedStyle(e),i={padding:{left:parseInt(r.paddingLeft,10),top:parseInt(r.paddingTop,10),right:parseInt(r.paddingRight,10),bottom:parseInt(r.paddingBottom,10)},margin:{left:-parseInt(r.marginLeft,10),top:-parseInt(r.marginTop,10),right:-parseInt(r.marginRight,10),bottom:-parseInt(r.marginBottom,10)},border:{left:parseInt(r.borderLeft,10),top:parseInt(r.borderTop,10),right:parseInt(r.borderRight,10),bottom:parseInt(r.borderBottom,10)}},n=[{x:t.left,y:t.top},{x:t.left+t.width,y:t.top},{x:t.left+t.width,y:t.top+t.bottom},{x:t.left,y:t.top+t.bottom}],s=a(n,i.border);return{content:a(s,i.padding),padding:s,border:n,margin:a(n,i.margin),width:t.width,height:t.height};function a(e,t){return[{x:e[0].x+t.left,y:e[0].y+t.top},{x:e[1].x-t.right,y:e[1].y+t.top},{x:e[2].x-t.right,y:e[2].y-t.bottom},{x:e[3].x+t.left,y:e[3].y-t.bottom}]}}));if(!e)return null;const t=await this.#xt();if(!t)return null;for(const r of["content","padding","border","margin"])for(const i of e[r])i.x+=t.x,i.y+=t.y;return e}async#xt(){const e={x:0,y:0};let t,r=this.frame;for(;t=r?.parentFrame();){const i={stack:[],error:void 0,hasError:!1};try{const n=bi(i,await r.frameElement(),!1);if(!n)throw new Error("Unsupported frame type");const s=await n.evaluate((e=>{if(0===e.getClientRects().length)return null;const t=e.getBoundingClientRect(),r=window.getComputedStyle(e);return{left:t.left+parseInt(r.paddingLeft,10)+parseInt(r.borderLeftWidth,10),top:t.top+parseInt(r.paddingTop,10)+parseInt(r.borderTopWidth,10)}}));if(!s)return null;e.x+=s.left,e.y+=s.top,r=t}catch(e){i.error=e,i.hasError=!0}finally{ki(i)}}return e}async screenshot(e={}){const{scrollIntoView:t=!0}=e;let r=await this.#Ft();const i=this.frame.page();t&&(await this.scrollIntoViewIfNeeded(),r=await this.#Ft());const[n,s]=await this.evaluate((()=>{if(!window.visualViewport)throw new Error("window.visualViewport is not supported.");return[window.visualViewport.pageLeft,window.visualViewport.pageTop]}));return r.x+=n,r.y+=s,await i.screenshot({...e,clip:r})}async#Ft(){const e=await this.boundingBox();return et(e,"Node is either not visible or not an HTMLElement"),et(0!==e.width,"Node has 0 width."),et(0!==e.height,"Node has 0 height."),e}async assertConnectedElement(){const e=await this.evaluate((async e=>e.isConnected?e.nodeType!==Node.ELEMENT_NODE?"Node is not of type HTMLElement":void 0:"Node is detached from document"));if(e)throw new Error(e)}async scrollIntoViewIfNeeded(){await this.isIntersectingViewport({threshold:1})||await this.scrollIntoView()}async isIntersectingViewport(e={}){const t={stack:[],error:void 0,hasError:!1};try{await this.assertConnectedElement();const r=await this.#Rt(),i=bi(t,r&&await r.#_t(),!1);return await(i??this).evaluate((async(e,t)=>{const r=await new Promise((t=>{const r=new IntersectionObserver((e=>{t(e[0].intersectionRatio),r.disconnect()}));r.observe(e)}));return 1===t?1===r:r>t}),e.threshold??0)}catch(e){t.error=e,t.hasError=!0}finally{ki(t)}}async scrollIntoView(){await this.assertConnectedElement(),await this.evaluate((async e=>{e.scrollIntoView({block:"center",inline:"center",behavior:"instant"})}))}async#Rt(){return await this.evaluate((e=>e instanceof SVGElement))?this:null}async#_t(){return await this.evaluateHandle((e=>e instanceof SVGSVGElement?e:e.ownerSVGElement))}}})();function Si(e,t,r){e.width=Math.max(e.x>=0?Math.min(t-e.x,e.width):Math.min(t,e.width+e.x),0),e.height=Math.max(e.y>=0?Math.min(r-e.y,e.height):Math.min(r,e.height+e.y),0)}class Ti extends Rr{#e=!1;#Dt;#Pt;constructor(e,t){super(),this.#Pt=e,this.#Dt=t}get disposed(){return this.#e}get realm(){return this.#Pt}get client(){return this.realm.environment.client}async jsonValue(){if(!this.#Dt.objectId)return vt(this.#Dt);const e=await this.evaluate((e=>e));if(void 0===e)throw new Error("Could not serialize referenced object");return e}asElement(){return null}async dispose(){this.#e||(this.#e=!0,await Ei(this.client,this.#Dt))}toString(){if(!this.#Dt.objectId)return"JSHandle:"+vt(this.#Dt);return"JSHandle@"+(this.#Dt.subtype||this.#Dt.type)}get id(){return this.#Dt.objectId}remoteObject(){return this.#Dt}}async function Ei(e,t){t.objectId&&await e.send("Runtime.releaseObject",{objectId:t.objectId}).catch((e=>{pt(e)}))}var Ii=self&&self.__runInitializers||function(e,t,r){for(var i=arguments.length>2,n=0;n<t.length;n++)r=i?t[n].call(e,r):t[n].call(e);return i?r:void 0},xi=self&&self.__esDecorate||function(e,t,r,i,n,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,c=i.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?i.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,i.name):{}),h=!1,p=r.length-1;p>=0;p--){var f={};for(var y in i)f[y]="access"===y?{}:i[y];for(var y in i.access)f.access[y]=i.access[y];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var m=(0,r[p])("accessor"===c?{get:u.get,set:u.set}:u[l],f);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(o=a(m.get))&&(u.get=o),(o=a(m.set))&&(u.set=o),(o=a(m.init))&&n.unshift(o)}else(o=a(m))&&("field"===c?n.unshift(o):u[l]=o)}d&&Object.defineProperty(d,i.name,u),h=!0};let Fi=(()=>{var e,t;let r,i,n,s,a=Ci,o=[];return class extends a{static{const c="function"==typeof Symbol&&Symbol.metadata?Object.create(a[Symbol.metadata]??null):void 0;r=[Yt()],i=[Yt(),(e=Ci).bindIsolatedHandle.bind(e)],n=[Yt(),(t=Ci).bindIsolatedHandle.bind(t)],s=[Yt()],xi(this,null,r,{kind:"method",name:"contentFrame",static:!1,private:!1,access:{has:e=>"contentFrame"in e,get:e=>e.contentFrame},metadata:c},null,o),xi(this,null,i,{kind:"method",name:"scrollIntoView",static:!1,private:!1,access:{has:e=>"scrollIntoView"in e,get:e=>e.scrollIntoView},metadata:c},null,o),xi(this,null,n,{kind:"method",name:"uploadFile",static:!1,private:!1,access:{has:e=>"uploadFile"in e,get:e=>e.uploadFile},metadata:c},null,o),xi(this,null,s,{kind:"method",name:"autofill",static:!1,private:!1,access:{has:e=>"autofill"in e,get:e=>e.autofill},metadata:c},null,o),c&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:c})}constructor(e,t){super(new Ti(e,t)),Ii(this,o)}get realm(){return this.handle.realm}get client(){return this.handle.client}remoteObject(){return this.handle.remoteObject()}get#Mt(){return this.frame._frameManager}get frame(){return this.realm.environment}async contentFrame(){const e=await this.client.send("DOM.describeNode",{objectId:this.id});return"string"!=typeof e.node.frameId?null:this.#Mt.frame(e.node.frameId)}async scrollIntoView(){await this.assertConnectedElement();try{await this.client.send("DOM.scrollIntoViewIfNeeded",{objectId:this.id})}catch(e){pt(e),await super.scrollIntoView()}}async uploadFile(...e){const t=await this.evaluate((e=>e.multiple));let r;et(e.length<=1||t,"Multiple file uploads only work with <input type=file multiple>");try{r=await import("path")}catch(e){if(e instanceof TypeError)throw new Error("JSHandle#uploadFile can only be used in Node-like environments.");throw e}const i=e.map((e=>r.win32.isAbsolute(e)||r.posix.isAbsolute(e)?e:r.resolve(e)));if(0===i.length)return void await this.evaluate((e=>{e.files=(new DataTransfer).files,e.dispatchEvent(new Event("input",{bubbles:!0,composed:!0})),e.dispatchEvent(new Event("change",{bubbles:!0}))}));const{node:{backendNodeId:n}}=await this.client.send("DOM.describeNode",{objectId:this.id});await this.client.send("DOM.setFileInputFiles",{objectId:this.id,files:i,backendNodeId:n})}async autofill(e){const t=(await this.client.send("DOM.describeNode",{objectId:this.handle.id})).node.backendNodeId,r=this.frame._id;await this.client.send("Autofill.trigger",{fieldId:t,frameId:r,card:e.creditCard})}}})();class Ri{_client;_world;_contextId;_contextName;constructor(e,t,r){this._client=e,this._world=r,this._contextId=t.id,t.name&&(this._contextName=t.name)}#qt=!1;#At;get puppeteerUtil(){let e=Promise.resolve();return this.#qt||(e=Promise.all([this.#Ot(new Pr("__ariaQuerySelector",hi.queryOne)),this.#Ot(new Pr("__ariaQuerySelectorAll",(async(e,t)=>{const r=hi.queryAll(e,t);return await e.realm.evaluateHandle(((...e)=>e),...await Jr.collect(r))})))]),this.#qt=!0),Qr.inject((t=>{this.#At&&this.#At.then((e=>{e.dispose()})),this.#At=e.then((()=>this.evaluateHandle(t)))}),!this.#At),this.#At}async#Ot(e){try{this._world&&(this._world._bindings.set(e.name,e),await this._world._addBindingToContext(this,e.name))}catch{}}async evaluate(e,...t){return await this.#Nt(!0,e,...t)}async evaluateHandle(e,...t){return await this.#Nt(!1,e,...t)}async#Nt(e,t,...r){const i=`//# sourceURL=${(e=>{if(Object.prototype.hasOwnProperty.call(e,mt))return e[mt]})(t)?.toString()??gt.INTERNAL_URL}`;if(bt(t)){const r=this._contextId,n=t,s=_t.test(n)?n:`${n}\n${i}\n`,{exceptionDetails:a,result:o}=await this._client.send("Runtime.evaluate",{expression:s,contextId:r,returnByValue:e,awaitPromise:!0,userGesture:!0}).catch(_i);if(a)throw ft(a);return e?vt(o):Di(this._world,o)}const n=Yr(t),s=_t.test(n)?n:`${n}\n${i}\n`;let a;try{a=this._client.send("Runtime.callFunctionOn",{functionDeclaration:s,executionContextId:this._contextId,arguments:r.length?await Promise.all(r.map(async function(e){e instanceof Gr&&(e=await e.get(this));if("bigint"==typeof e)return{unserializableValue:`${e.toString()}n`};if(Object.is(e,-0))return{unserializableValue:"-0"};if(Object.is(e,1/0))return{unserializableValue:"Infinity"};if(Object.is(e,-1/0))return{unserializableValue:"-Infinity"};if(Object.is(e,NaN))return{unserializableValue:"NaN"};const t=e&&(e instanceof Ti||e instanceof Fi)?e:null;if(t){if(t.realm!==this._world)throw new Error("JSHandles can be evaluated only in the context they were created!");if(t.disposed)throw new Error("JSHandle is disposed!");return t.remoteObject().unserializableValue?{unserializableValue:t.remoteObject().unserializableValue}:t.remoteObject().objectId?{objectId:t.remoteObject().objectId}:{value:t.remoteObject().value}}return{value:e}}.bind(this))):[],returnByValue:e,awaitPromise:!0,userGesture:!0})}catch(e){throw e instanceof TypeError&&e.message.startsWith("Converting circular structure to JSON")&&(e.message+=" Recursive objects are not allowed."),e}const{exceptionDetails:o,result:c}=await a.catch(_i);if(o)throw ft(o);return e?vt(c):Di(this._world,c)}}const _i=e=>{if(e.message.includes("Object reference chain is too long"))return{result:{type:"undefined"}};if(e.message.includes("Object couldn't be returned by value"))return{result:{type:"undefined"}};if(e.message.endsWith("Cannot find context with specified id")||e.message.endsWith("Inspected target navigated or closed"))throw new Error("Execution context was destroyed, most likely because of a navigation.");throw e};function Di(e,t){return"node"===t.subtype?new Fi(e,t):new Ti(e,t)}class Pi extends Xe{#F;#Bt=new Map;#Lt=new Map;#jt=new Map;#Ht=new Set;#$t;#Kt;#Vt=new WeakMap;#Ut=jt.create();#Wt=new Set;constructor(e,t,r){super(),this.#F=e,this.#$t=r,this.#Kt=t,this.#F.on("Target.targetCreated",this.#zt),this.#F.on("Target.targetDestroyed",this.#Gt),this.#F.on(Ot.SessionDetached,this.#Qt),this.setupAttachmentListeners(this.#F)}setupAttachmentListeners(e){const t=t=>this.#Jt(e,t);et(!this.#Vt.has(e)),this.#Vt.set(e,t),e.on("Target.attachedToTarget",t)}#Qt=e=>{this.removeSessionListeners(e),this.#jt.delete(e.id())};removeSessionListeners(e){this.#Vt.has(e)&&(e.off("Target.attachedToTarget",this.#Vt.get(e)),this.#Vt.delete(e))}getAvailableTargets(){return this.#Lt}dispose(){this.#F.off("Target.targetCreated",this.#zt),this.#F.off("Target.targetDestroyed",this.#Gt)}async initialize(){await this.#F.send("Target.setDiscoverTargets",{discover:!0,filter:[{}]}),this.#Wt=new Set(this.#Bt.keys()),await this.#Ut.valueOrThrow()}#zt=async e=>{if(this.#Bt.has(e.targetInfo.targetId))return;if(this.#Bt.set(e.targetInfo.targetId,e.targetInfo),"browser"===e.targetInfo.type&&e.targetInfo.attached){const t=this.#Kt(e.targetInfo,void 0);return t._initialize(),this.#Lt.set(e.targetInfo.targetId,t),void this.#Xt(t._targetId)}const t=this.#Kt(e.targetInfo,void 0);if(this.#$t&&!this.#$t(t))return this.#Ht.add(e.targetInfo.targetId),void this.#Xt(e.targetInfo.targetId);t._initialize(),this.#Lt.set(e.targetInfo.targetId,t),this.emit("targetAvailable",t),this.#Xt(t._targetId)};#Gt=e=>{this.#Bt.delete(e.targetId),this.#Xt(e.targetId);const t=this.#Lt.get(e.targetId);t&&(this.emit("targetGone",t),this.#Lt.delete(e.targetId))};#Jt=async(e,t)=>{const r=t.targetInfo,i=this.#F.session(t.sessionId);if(!i)throw new Error(`Session ${t.sessionId} was not created.`);const n=this.#Lt.get(r.targetId);et(n,`Target ${r.targetId} is missing`),i._setTarget(n),this.setupAttachmentListeners(i),this.#jt.set(i.id(),this.#Lt.get(r.targetId)),e.emit(Ot.Ready,i)};#Xt(e){this.#Wt.delete(e),0===this.#Wt.size&&this.#Ut.resolve()}}var Mi,qi=self&&self.__runInitializers||function(e,t,r){for(var i=arguments.length>2,n=0;n<t.length;n++)r=i?t[n].call(e,r):t[n].call(e);return i?r:void 0},Ai=self&&self.__esDecorate||function(e,t,r,i,n,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,c=i.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?i.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,i.name):{}),h=!1,p=r.length-1;p>=0;p--){var f={};for(var y in i)f[y]="access"===y?{}:i[y];for(var y in i.access)f.access[y]=i.access[y];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var m=(0,r[p])("accessor"===c?{get:u.get,set:u.set}:u[l],f);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(o=a(m.get))&&(u.get=o),(o=a(m.set))&&(u.set=o),(o=a(m.init))&&n.unshift(o)}else(o=a(m))&&("field"===c?n.unshift(o):u[l]=o)}d&&Object.defineProperty(d,i.name,u),h=!0},Oi=self&&self.__addDisposableResource||function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t},Ni=self&&self.__disposeResources||function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}return function e(){for(;t.stack.length;){var i=t.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(e,(function(t){return r(t),e()}))}catch(e){r(e)}}if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i});!function(e){e.FrameNavigated=Symbol("Frame.FrameNavigated"),e.FrameSwapped=Symbol("Frame.FrameSwapped"),e.LifecycleEvent=Symbol("Frame.LifecycleEvent"),e.FrameNavigatedWithinDocument=Symbol("Frame.FrameNavigatedWithinDocument"),e.FrameDetached=Symbol("Frame.FrameDetached"),e.FrameSwappedByActivation=Symbol("Frame.FrameSwappedByActivation")}(Mi||(Mi={}));const Bi=Yt((e=>`Attempted to use detached Frame '${e._id}'.`));let Li=(()=>{let e,t,r,i,n,s,a,o,c,l,d,u,h,p,f,y,m,g,w,v,b,k,C=Xe,S=[];return class extends C{static{const T="function"==typeof Symbol&&Symbol.metadata?Object.create(C[Symbol.metadata]??null):void 0;e=[Bi],t=[Bi],r=[Bi],i=[Bi],n=[Bi],s=[Bi],a=[Bi],o=[Bi],c=[Bi],l=[Bi],d=[Bi],u=[Bi],h=[Bi],p=[Bi],f=[Bi],y=[Bi],m=[Bi],g=[Bi],w=[Bi],v=[Bi],b=[Bi],k=[Bi],Ai(this,null,e,{kind:"method",name:"frameElement",static:!1,private:!1,access:{has:e=>"frameElement"in e,get:e=>e.frameElement},metadata:T},null,S),Ai(this,null,t,{kind:"method",name:"evaluateHandle",static:!1,private:!1,access:{has:e=>"evaluateHandle"in e,get:e=>e.evaluateHandle},metadata:T},null,S),Ai(this,null,r,{kind:"method",name:"evaluate",static:!1,private:!1,access:{has:e=>"evaluate"in e,get:e=>e.evaluate},metadata:T},null,S),Ai(this,null,i,{kind:"method",name:"locator",static:!1,private:!1,access:{has:e=>"locator"in e,get:e=>e.locator},metadata:T},null,S),Ai(this,null,n,{kind:"method",name:"$",static:!1,private:!1,access:{has:e=>"$"in e,get:e=>e.$},metadata:T},null,S),Ai(this,null,s,{kind:"method",name:"$$",static:!1,private:!1,access:{has:e=>"$$"in e,get:e=>e.$$},metadata:T},null,S),Ai(this,null,a,{kind:"method",name:"$eval",static:!1,private:!1,access:{has:e=>"$eval"in e,get:e=>e.$eval},metadata:T},null,S),Ai(this,null,o,{kind:"method",name:"$$eval",static:!1,private:!1,access:{has:e=>"$$eval"in e,get:e=>e.$$eval},metadata:T},null,S),Ai(this,null,c,{kind:"method",name:"$x",static:!1,private:!1,access:{has:e=>"$x"in e,get:e=>e.$x},metadata:T},null,S),Ai(this,null,l,{kind:"method",name:"waitForSelector",static:!1,private:!1,access:{has:e=>"waitForSelector"in e,get:e=>e.waitForSelector},metadata:T},null,S),Ai(this,null,d,{kind:"method",name:"waitForXPath",static:!1,private:!1,access:{has:e=>"waitForXPath"in e,get:e=>e.waitForXPath},metadata:T},null,S),Ai(this,null,u,{kind:"method",name:"waitForFunction",static:!1,private:!1,access:{has:e=>"waitForFunction"in e,get:e=>e.waitForFunction},metadata:T},null,S),Ai(this,null,h,{kind:"method",name:"content",static:!1,private:!1,access:{has:e=>"content"in e,get:e=>e.content},metadata:T},null,S),Ai(this,null,p,{kind:"method",name:"addScriptTag",static:!1,private:!1,access:{has:e=>"addScriptTag"in e,get:e=>e.addScriptTag},metadata:T},null,S),Ai(this,null,f,{kind:"method",name:"addStyleTag",static:!1,private:!1,access:{has:e=>"addStyleTag"in e,get:e=>e.addStyleTag},metadata:T},null,S),Ai(this,null,y,{kind:"method",name:"click",static:!1,private:!1,access:{has:e=>"click"in e,get:e=>e.click},metadata:T},null,S),Ai(this,null,m,{kind:"method",name:"focus",static:!1,private:!1,access:{has:e=>"focus"in e,get:e=>e.focus},metadata:T},null,S),Ai(this,null,g,{kind:"method",name:"hover",static:!1,private:!1,access:{has:e=>"hover"in e,get:e=>e.hover},metadata:T},null,S),Ai(this,null,w,{kind:"method",name:"select",static:!1,private:!1,access:{has:e=>"select"in e,get:e=>e.select},metadata:T},null,S),Ai(this,null,v,{kind:"method",name:"tap",static:!1,private:!1,access:{has:e=>"tap"in e,get:e=>e.tap},metadata:T},null,S),Ai(this,null,b,{kind:"method",name:"type",static:!1,private:!1,access:{has:e=>"type"in e,get:e=>e.type},metadata:T},null,S),Ai(this,null,k,{kind:"method",name:"title",static:!1,private:!1,access:{has:e=>"title"in e,get:e=>e.title},metadata:T},null,S),T&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:T})}_id=void qi(this,S);_parentId;worlds;_name;_hasStartedLoading=!1;constructor(){super()}#Yt;#Zt(){return this.#Yt||(this.#Yt=this.isolatedRealm().evaluateHandle((()=>document)).then((e=>this.mainRealm().transferHandle(e)))),this.#Yt}clearDocumentHandle(){this.#Yt=void 0}async frameElement(){const e={stack:[],error:void 0,hasError:!1};try{const t=this.parentFrame();if(!t)return null;const r=Oi(e,await t.isolatedRealm().evaluateHandle((()=>document.querySelectorAll("iframe"))),!1);for await(const e of si(r)){const t={stack:[],error:void 0,hasError:!1};try{const r=Oi(t,e,!1);if((await r.contentFrame())._id===this._id)return r.move()}catch(e){t.error=e,t.hasError=!0}finally{Ni(t)}}return null}catch(t){e.error=t,e.hasError=!0}finally{Ni(e)}}async evaluateHandle(e,...t){return e=wt(this.evaluateHandle.name,e),await this.mainRealm().evaluateHandle(e,...t)}async evaluate(e,...t){return e=wt(this.evaluate.name,e),await this.mainRealm().evaluate(e,...t)}locator(e){return"string"==typeof e?lr.create(this,e):sr.create(this,e)}async $(e){const t=await this.#Zt();return await t.$(e)}async $$(e){const t=await this.#Zt();return await t.$$(e)}async $eval(e,t,...r){t=wt(this.$eval.name,t);const i=await this.#Zt();return await i.$eval(e,t,...r)}async $$eval(e,t,...r){t=wt(this.$$eval.name,t);const i=await this.#Zt();return await i.$$eval(e,t,...r)}async $x(e){const t=await this.#Zt();return await t.$x(e)}async waitForSelector(e,t={}){const{updatedSelector:r,QueryHandler:i}=gi(e);return await i.waitFor(this,r,t)}async waitForXPath(e,t={}){return e.startsWith("//")&&(e=`.${e}`),await this.waitForSelector(`xpath/${e}`,t)}async waitForFunction(e,t={},...r){return await this.mainRealm().waitForFunction(e,t,...r)}async content(){return await this.evaluate(xt)}async setFrameContent(e){return await this.evaluate((e=>{document.open(),document.write(e),document.close()}),e)}name(){return this._name||""}isDetached(){return this.detached}get disposed(){return this.detached}async addScriptTag(e){let{content:t="",type:r}=e;const{path:i}=e;if(+!!e.url+ +!!i+ +!!t!=1)throw new Error("Exactly one of `url`, `path`, or `content` must be specified.");if(i){const e=await Tt();t=await e.readFile(i,"utf8"),t+=`//# sourceURL=${i.replace(/\n/g,"")}`}return r=r??"text/javascript",await this.mainRealm().transferHandle(await this.isolatedRealm().evaluateHandle((async({Deferred:e},{url:t,id:r,type:i,content:n})=>{const s=e.create(),a=document.createElement("script");return a.type=i,a.text=n,t?(a.src=t,a.addEventListener("load",(()=>s.resolve()),{once:!0}),a.addEventListener("error",(e=>{s.reject(new Error(e.message??"Could not load script"))}),{once:!0})):s.resolve(),r&&(a.id=r),document.head.appendChild(a),await s.valueOrThrow(),a}),Gr.create((e=>e.puppeteerUtil)),{...e,type:r,content:t}))}async addStyleTag(e){let{content:t=""}=e;const{path:r}=e;if(+!!e.url+ +!!r+ +!!t!=1)throw new Error("Exactly one of `url`, `path`, or `content` must be specified.");if(r){const i=await Tt();t=await i.readFile(r,"utf8"),t+="/*# sourceURL="+r.replace(/\n/g,"")+"*/",e.content=t}return await this.mainRealm().transferHandle(await this.isolatedRealm().evaluateHandle((async({Deferred:e},{url:t,content:r})=>{const i=e.create();let n;if(t){const e=document.createElement("link");e.rel="stylesheet",e.href=t,n=e}else n=document.createElement("style"),n.appendChild(document.createTextNode(r));return n.addEventListener("load",(()=>{i.resolve()}),{once:!0}),n.addEventListener("error",(e=>{i.reject(new Error(e.message??"Could not load style"))}),{once:!0}),document.head.appendChild(n),await i.valueOrThrow(),n}),Gr.create((e=>e.puppeteerUtil)),e))}async click(e,t={}){const r={stack:[],error:void 0,hasError:!1};try{const i=Oi(r,await this.$(e),!1);et(i,`No element found for selector: ${e}`),await i.click(t),await i.dispose()}catch(e){r.error=e,r.hasError=!0}finally{Ni(r)}}async focus(e){const t={stack:[],error:void 0,hasError:!1};try{const r=Oi(t,await this.$(e),!1);et(r,`No element found for selector: ${e}`),await r.focus()}catch(e){t.error=e,t.hasError=!0}finally{Ni(t)}}async hover(e){const t={stack:[],error:void 0,hasError:!1};try{const r=Oi(t,await this.$(e),!1);et(r,`No element found for selector: ${e}`),await r.hover()}catch(e){t.error=e,t.hasError=!0}finally{Ni(t)}}async select(e,...t){const r={stack:[],error:void 0,hasError:!1};try{const i=Oi(r,await this.$(e),!1);return et(i,`No element found for selector: ${e}`),await i.select(...t)}catch(e){r.error=e,r.hasError=!0}finally{Ni(r)}}async tap(e){const t={stack:[],error:void 0,hasError:!1};try{const r=Oi(t,await this.$(e),!1);et(r,`No element found for selector: ${e}`),await r.tap()}catch(e){t.error=e,t.hasError=!0}finally{Ni(t)}}async type(e,t,r){const i={stack:[],error:void 0,hasError:!1};try{const n=Oi(i,await this.$(e),!1);et(n,`No element found for selector: ${e}`),await n.type(t,r)}catch(e){i.error=e,i.hasError=!0}finally{Ni(i)}}async waitForTimeout(e){return await new Promise((t=>{setTimeout(t,e)}))}async title(){return await this.isolatedRealm().evaluate((()=>document.title))}}})();class ji{id;name;constructor(e,t){this.id=e,this.name=t}}class Hi{#le;#er;#k;#ce=!1;#tr=this.#rr.bind(this);#ir=new Set;devices=[];constructor(e,t,r){this.#le=e,this.#er=t,this.#k=r.id,this.#le.on("DeviceAccess.deviceRequestPrompted",this.#tr),this.#le.on("Target.detachedFromTarget",(()=>{this.#le=null})),this.#rr(r)}#rr(e){if(e.id===this.#k)for(const t of e.devices){if(this.devices.some((e=>e.id===t.id)))continue;const e=new ji(t.id,t.name);this.devices.push(e);for(const t of this.#ir)t.filter(e)&&t.promise.resolve(e)}}async waitForDevice(e,t={}){for(const t of this.devices)if(e(t))return t;const{timeout:r=this.#er.timeout()}=t,i=jt.create({message:`Waiting for \`DeviceRequestPromptDevice\` failed: ${r}ms exceeded`,timeout:r}),n={filter:e,promise:i};this.#ir.add(n);try{return await i.valueOrThrow()}finally{this.#ir.delete(n)}}async select(e){return et(null!==this.#le,"Cannot select device through detached session!"),et(this.devices.includes(e),"Cannot select unknown device!"),et(!this.#ce,"Cannot select DeviceRequestPrompt which is already handled!"),this.#le.off("DeviceAccess.deviceRequestPrompted",this.#tr),this.#ce=!0,await this.#le.send("DeviceAccess.selectPrompt",{id:this.#k,deviceId:e.id})}async cancel(){return et(null!==this.#le,"Cannot cancel prompt through detached session!"),et(!this.#ce,"Cannot cancel DeviceRequestPrompt which is already handled!"),this.#le.off("DeviceAccess.deviceRequestPrompted",this.#tr),this.#ce=!0,await this.#le.send("DeviceAccess.cancelPrompt",{id:this.#k})}}class $i{#le;#er;#nr=new Set;constructor(e,t){this.#le=e,this.#er=t,this.#le.on("DeviceAccess.deviceRequestPrompted",(e=>{this.#sr(e)})),this.#le.on("Target.detachedFromTarget",(()=>{this.#le=null}))}async waitForDevicePrompt(e={}){et(null!==this.#le,"Cannot wait for device prompt through detached session!");let t;0===this.#nr.size&&(t=this.#le.send("DeviceAccess.enable"));const{timeout:r=this.#er.timeout()}=e,i=jt.create({message:`Waiting for \`DeviceRequestPrompt\` failed: ${r}ms exceeded`,timeout:r});this.#nr.add(i);try{const[e]=await Promise.all([i.valueOrThrow(),t]);return e}finally{this.#nr.delete(i)}}#sr(e){if(!this.#nr.size)return;et(null!==this.#le);const t=new Hi(this.#le,this.#er,e);for(const e of this.#nr)e.resolve(t);this.#nr.clear()}}class Ki{#Pt;#ar;#or;#ke;#ne;#Ee;#g;#cr=jt.create();#lr;#dr;#ur=[];constructor(e,t,r,...i){if(this.#Pt=e,this.#ar=t.polling,this.#or=t.root,this.#dr=t.signal,this.#dr?.addEventListener("abort",(()=>{this.terminate(this.#dr?.reason)}),{once:!0}),"string"==typeof r)this.#ke=`() => {return (${r});}`;else this.#ke=Yr(r);this.#ne=i,this.#Pt.taskManager.add(this),t.timeout&&(this.#g=new lt(`Waiting failed: ${t.timeout}ms exceeded`),this.#Ee=setTimeout((()=>{this.terminate(this.#g)}),t.timeout)),this.rerun()}get result(){return this.#cr.valueOrThrow()}async rerun(){for(const e of this.#ur)e.abort();this.#ur.length=0;const e=new AbortController;this.#ur.push(e);try{switch(this.#ar){case"raf":this.#lr=await this.#Pt.evaluateHandle((({RAFPoller:e,createFunction:t},r,...i)=>{const n=t(r);return new e((()=>n(...i)))}),Gr.create((e=>e.puppeteerUtil)),this.#ke,...this.#ne);break;case"mutation":this.#lr=await this.#Pt.evaluateHandle((({MutationPoller:e,createFunction:t},r,i,...n)=>{const s=t(i);return new e((()=>s(...n)),r||document)}),Gr.create((e=>e.puppeteerUtil)),this.#or,this.#ke,...this.#ne);break;default:this.#lr=await this.#Pt.evaluateHandle((({IntervalPoller:e,createFunction:t},r,i,...n)=>{const s=t(i);return new e((()=>s(...n)),r)}),Gr.create((e=>e.puppeteerUtil)),this.#ar,this.#ke,...this.#ne)}await this.#lr.evaluate((e=>{e.start()}));const e=await this.#lr.evaluateHandle((e=>e.result()));this.#cr.resolve(e),await this.terminate()}catch(t){if(e.signal.aborted)return;const r=this.getBadError(t);r&&await this.terminate(r)}}async terminate(e){if(this.#Pt.taskManager.delete(this),clearTimeout(this.#Ee),e&&!this.#cr.finished()&&this.#cr.reject(e),this.#lr)try{await this.#lr.evaluateHandle((async e=>{await e.stop()})),this.#lr&&(await this.#lr.dispose(),this.#lr=void 0)}catch{}}getBadError(e){if(tt(e)){if(e.message.includes("Execution context is not available in detached frame"))return new Error("Waiting failed: Frame detached");if(e.message.includes("Execution context was destroyed"))return;if(e.message.includes("Cannot find context with specified id"))return;if(e.message.includes("AbortError: Actor 'MessageHandlerFrame' destroyed"))return;return e}return new Error("WaitTask failed with an error",{cause:e})}}class Vi{#hr=new Set;add(e){this.#hr.add(e)}delete(e){this.#hr.delete(e)}terminateAll(e){for(const t of this.#hr)t.terminate(e);this.#hr.clear()}async rerunAll(){await Promise.all([...this.#hr].map((e=>e.rerun())))}}class Ui{timeoutSettings;taskManager=new Vi;constructor(e){this.timeoutSettings=e}async waitForFunction(e,t={},...r){const{polling:i="raf",timeout:n=this.timeoutSettings.timeout(),root:s,signal:a}=t;if("number"==typeof i&&i<0)throw new Error("Cannot poll with non-positive interval");const o=new Ki(this,{polling:i,root:s,timeout:n,signal:a},e,...r);return await o.result}get disposed(){return this.#e}#e=!1;[ze](){this.#e=!0,this.taskManager.terminateAll(new Error("waitForFunction failed: frame got detached."))}}var Wi=self&&self.__addDisposableResource||function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t},zi=self&&self.__disposeResources||function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}return function e(){for(;t.stack.length;){var i=t.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(e,(function(t){return r(t),e()}))}catch(e){r(e)}}if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i});class Gi extends Ui{#pr=jt.create();#fr=new Set;#yr=new Map;get _bindings(){return this.#yr}#mr;constructor(e,t){super(t),this.#mr=e,this.frameUpdated()}get environment(){return this.#mr}frameUpdated(){this.client.on("Runtime.bindingCalled",this.#gr)}get client(){return this.#mr.client}clearContext(){this.#pr=jt.create(),"clearDocumentHandle"in this.#mr&&this.#mr.clearDocumentHandle()}setContext(e){this.#fr.clear(),this.#pr.resolve(e),this.taskManager.rerunAll()}hasContext(){return this.#pr.resolved()}#wr(){if(this.disposed)throw new Error(`Execution context is not available in detached frame "${this.environment.url()}" (are you trying to evaluate?)`);if(null===this.#pr)throw new Error("Execution content promise is missing");return this.#pr.valueOrThrow()}async evaluateHandle(e,...t){e=wt(this.evaluateHandle.name,e);const r=await this.#wr();return await r.evaluateHandle(e,...t)}async evaluate(e,...t){e=wt(this.evaluate.name,e);let r=this.#pr.value();return r&&r instanceof Ri||(r=await this.#wr()),await r.evaluate(e,...t)}#P=new zt;async _addBindingToContext(e,t){const r={stack:[],error:void 0,hasError:!1};try{if(this.#fr.has(t))return;Wi(r,await this.#P.acquire(),!1);try{await e._client.send("Runtime.addBinding",e._contextName?{name:t,executionContextName:e._contextName}:{name:t,executionContextId:e._contextId}),await e.evaluate(Ct,"internal",t),this.#fr.add(t)}catch(e){if(e instanceof Error){if(e.message.includes("Execution context was destroyed"))return;if(e.message.includes("Cannot find context with specified id"))return}pt(e)}}catch(e){r.error=e,r.hasError=!0}finally{zi(r)}}#gr=async e=>{let t;try{t=JSON.parse(e.payload)}catch{return}const{type:r,name:i,seq:n,args:s,isTrivial:a}=t;if("internal"===r&&this.#fr.has(i))try{const t=await this.#pr.valueOrThrow();if(e.executionContextId!==t._contextId)return;const r=this._bindings.get(i);await(r?.run(t,n,s,a))}catch(e){pt(e)}};async adoptBackendNode(e){const t=await this.#wr(),{object:r}=await this.client.send("DOM.resolveNode",{backendNodeId:e,executionContextId:t._contextId});return Di(this,r)}async adoptHandle(e){if(e.realm===this)return await e.evaluateHandle((e=>e));const t=await this.client.send("DOM.describeNode",{objectId:e.id});return await this.adoptBackendNode(t.node.backendNodeId)}async transferHandle(e){if(e.realm===this)return e;if(void 0===e.remoteObject().objectId)return e;const t=await this.client.send("DOM.describeNode",{objectId:e.remoteObject().objectId}),r=await this.adoptBackendNode(t.node.backendNodeId);return await e.dispose(),r}[ze](){super[ze](),this.client.off("Runtime.bindingCalled",this.#gr)}}const Qi=Symbol("mainWorld"),Ji=Symbol("puppeteerWorld");var Xi;!function(e){e.FrameAttached=Symbol("FrameManager.FrameAttached"),e.FrameNavigated=Symbol("FrameManager.FrameNavigated"),e.FrameDetached=Symbol("FrameManager.FrameDetached"),e.FrameSwapped=Symbol("FrameManager.FrameSwapped"),e.LifecycleEvent=Symbol("FrameManager.LifecycleEvent"),e.FrameNavigatedWithinDocument=Symbol("FrameManager.FrameNavigatedWithinDocument")}(Xi||(Xi={}));const Yi=new Map([["load","load"],["domcontentloaded","DOMContentLoaded"],["networkidle0","networkIdle"],["networkidle2","networkAlmostIdle"]]);class Zi{#vr;#br;#Ee;#kr=null;#Ae=new Qe;#Cr;#Sr;#Tr=jt.create();#Er=jt.create();#Ir=jt.create();#xr;#Fr;#Rr;constructor(e,t,r,i){Array.isArray(r)?r=r.slice():"string"==typeof r&&(r=[r]),this.#Cr=t._loaderId,this.#vr=r.map((e=>{const t=Yi.get(e);return et(t,"Unknown value for options.waitUntil: "+e),t})),this.#br=t,this.#Ee=i,this.#Ae.use(new Ye(t._frameManager,Xi.LifecycleEvent,this.#_r.bind(this))),this.#Ae.use(new Ye(t,Mi.FrameNavigatedWithinDocument,this.#Dr.bind(this))),this.#Ae.use(new Ye(t,Mi.FrameNavigated,this.#Pr.bind(this))),this.#Ae.use(new Ye(t,Mi.FrameSwapped,this.#Mr.bind(this))),this.#Ae.use(new Ye(t,Mi.FrameSwappedByActivation,this.#Mr.bind(this))),this.#Ae.use(new Ye(t,Mi.FrameDetached,this.#qr.bind(this))),this.#Ae.use(new Ye(e,Bt.Request,this.#Ar.bind(this))),this.#Ae.use(new Ye(e,Bt.Response,this.#Or.bind(this))),this.#Ae.use(new Ye(e,Bt.RequestFailed,this.#Nr.bind(this))),this.#Sr=jt.create({timeout:this.#Ee,message:`Navigation timeout of ${this.#Ee} ms exceeded`}),this.#_r()}#Ar(e){e.frame()===this.#br&&e.isNavigationRequest()&&(this.#kr=e,this.#Rr?.resolve(),this.#Rr=jt.create(),null!==e.response()&&this.#Rr?.resolve())}#Nr(e){this.#kr?._requestId===e._requestId&&this.#Rr?.resolve()}#Or(e){this.#kr?._requestId===e.request()._requestId&&this.#Rr?.resolve()}#qr(e){this.#br!==e?this.#_r():this.#Sr.resolve(new Error("Navigating frame was detached"))}async navigationResponse(){return await(this.#Rr?.valueOrThrow()),this.#kr?this.#kr.response():null}sameDocumentNavigationPromise(){return this.#Tr.valueOrThrow()}newDocumentNavigationPromise(){return this.#Ir.valueOrThrow()}lifecyclePromise(){return this.#Er.valueOrThrow()}terminationPromise(){return this.#Sr.valueOrThrow()}#Dr(){this.#xr=!0,this.#_r()}#Pr(e){if("BackForwardCacheRestore"===e)return this.#Mr();this.#_r()}#Mr(){this.#Fr=!0,this.#_r()}#_r(){(function e(t,r){for(const e of r)if(!t._lifecycleEvents.has(e))return!1;for(const i of t.childFrames())if(i._hasStartedLoading&&!e(i,r))return!1;return!0})(this.#br,this.#vr)&&(this.#Er.resolve(),this.#xr&&this.#Tr.resolve(void 0),(this.#Fr||this.#br._loaderId!==this.#Cr)&&this.#Ir.resolve(void 0))}dispose(){this.#Ae.dispose(),this.#Sr.resolve(new Error("LifecycleWatcher disposed"))}}var en=self&&self.__runInitializers||function(e,t,r){for(var i=arguments.length>2,n=0;n<t.length;n++)r=i?t[n].call(e,r):t[n].call(e);return i?r:void 0},tn=self&&self.__esDecorate||function(e,t,r,i,n,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,c=i.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?i.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,i.name):{}),h=!1,p=r.length-1;p>=0;p--){var f={};for(var y in i)f[y]="access"===y?{}:i[y];for(var y in i.access)f.access[y]=i.access[y];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var m=(0,r[p])("accessor"===c?{get:u.get,set:u.set}:u[l],f);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(o=a(m.get))&&(u.get=o),(o=a(m.set))&&(u.set=o),(o=a(m.init))&&n.unshift(o)}else(o=a(m))&&("field"===c?n.unshift(o):u[l]=o)}d&&Object.defineProperty(d,i.name,u),h=!0};let rn=(()=>{let e,t,r,i,n=Li,s=[];return class extends n{static{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;tn(this,null,e,{kind:"method",name:"goto",static:!1,private:!1,access:{has:e=>"goto"in e,get:e=>e.goto},metadata:a},null,s),tn(this,null,t,{kind:"method",name:"waitForNavigation",static:!1,private:!1,access:{has:e=>"waitForNavigation"in e,get:e=>e.waitForNavigation},metadata:a},null,s),tn(this,null,r,{kind:"method",name:"setContent",static:!1,private:!1,access:{has:e=>"setContent"in e,get:e=>e.setContent},metadata:a},null,s),tn(this,null,i,{kind:"method",name:"waitForDevicePrompt",static:!1,private:!1,access:{has:e=>"waitForDevicePrompt"in e,get:e=>e.waitForDevicePrompt},metadata:a},null,s),a&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a})}#Ce=(en(this,s),"");#Br=!1;#le;_frameManager;_id;_loaderId="";_lifecycleEvents=new Set;_parentId;constructor(e,t,r,i){super(),this._frameManager=e,this.#Ce="",this._id=t,this._parentId=r,this.#Br=!1,this._loaderId="",this.updateClient(i),this.on(Mi.FrameSwappedByActivation,(()=>{this._onLoadingStarted(),this._onLoadingStopped()}))}_client(){return this.#le}updateId(e){this._id=e}updateClient(e,t=!1){this.#le=e,t?(this.worlds[Qi].frameUpdated(),this.worlds[Ji].frameUpdated()):this.worlds={[Qi]:new Gi(this,this._frameManager.timeoutSettings),[Ji]:new Gi(this,this._frameManager.timeoutSettings)}}page(){return this._frameManager.page()}isOOPFrame(){return this.#le!==this._frameManager.client}async goto(e,t={}){const{referer:r=this._frameManager.networkManager.extraHTTPHeaders().referer,referrerPolicy:i=this._frameManager.networkManager.extraHTTPHeaders()["referer-policy"],waitUntil:n=["load"],timeout:s=this._frameManager.timeoutSettings.navigationTimeout()}=t;let a=!1;const o=new Zi(this._frameManager.networkManager,this,n,s);let c=await jt.race([async function(e,t,r,i,n){try{const s=await e.send("Page.navigate",{url:t,referrer:r,frameId:n,referrerPolicy:i});return a=!!s.loaderId,"net::ERR_HTTP_RESPONSE_CODE_FAILURE"===s.errorText?null:s.errorText?new Error(`${s.errorText} at ${t}`):null}catch(e){if(tt(e))return e;throw e}}(this.#le,e,r,i,this._id),o.terminationPromise()]);c||(c=await jt.race([o.terminationPromise(),a?o.newDocumentNavigationPromise():o.sameDocumentNavigationPromise()]));try{if(c)throw c;return await o.navigationResponse()}finally{o.dispose()}}async waitForNavigation(e={}){const{waitUntil:t=["load"],timeout:r=this._frameManager.timeoutSettings.navigationTimeout()}=e,i=new Zi(this._frameManager.networkManager,this,t,r),n=await jt.race([i.terminationPromise(),i.sameDocumentNavigationPromise(),i.newDocumentNavigationPromise()]);try{if(n)throw n;return await i.navigationResponse()}finally{i.dispose()}}get client(){return this.#le}mainRealm(){return this.worlds[Qi]}isolatedRealm(){return this.worlds[Ji]}async setContent(e,t={}){const{waitUntil:r=["load"],timeout:i=this._frameManager.timeoutSettings.navigationTimeout()}=t;await this.setFrameContent(e);const n=new Zi(this._frameManager.networkManager,this,r,i),s=await jt.race([n.terminationPromise(),n.lifecyclePromise()]);if(n.dispose(),s)throw s}url(){return this.#Ce}parentFrame(){return this._frameManager._frameTree.parentFrame(this._id)||null}childFrames(){return this._frameManager._frameTree.childFrames(this._id)}#Lr(){const e=this.page().mainFrame();return this.isOOPFrame()||null===e?this._frameManager._deviceRequestPromptManager(this.#le):e._frameManager._deviceRequestPromptManager(this.#le)}async waitForDevicePrompt(e={}){return await this.#Lr().waitForDevicePrompt(e)}_navigated(e){this._name=e.name,this.#Ce=`${e.url}${e.urlFragment||""}`}_navigatedWithinDocument(e){this.#Ce=e}_onLifecycleEvent(e,t){"init"===t&&(this._loaderId=e,this._lifecycleEvents.clear()),this._lifecycleEvents.add(t)}_onLoadingStopped(){this._lifecycleEvents.add("DOMContentLoaded"),this._lifecycleEvents.add("load")}_onLoadingStarted(){this._hasStartedLoading=!0}get detached(){return this.#Br}[(e=[Bi],t=[Bi],r=[Bi],i=[Bi],ze)](){this.#Br||(this.#Br=!0,this.worlds[Qi][ze](),this.worlds[Ji][ze]())}exposeFunction(){throw new ut}}})();class nn{#jr=new Map;#Hr=new Map;#$r=new Map;#Kr;#Vr=new Map;getMainFrame(){return this.#Kr}getById(e){return this.#jr.get(e)}waitForFrame(e){const t=this.getById(e);if(t)return Promise.resolve(t);const r=jt.create();return(this.#Vr.get(e)||new Set).add(r),r.valueOrThrow()}frames(){return Array.from(this.#jr.values())}addFrame(e){this.#jr.set(e._id,e),e._parentId?(this.#Hr.set(e._id,e._parentId),this.#$r.has(e._parentId)||this.#$r.set(e._parentId,new Set),this.#$r.get(e._parentId).add(e._id)):this.#Kr||(this.#Kr=e),this.#Vr.get(e._id)?.forEach((t=>t.resolve(e)))}removeFrame(e){this.#jr.delete(e._id),this.#Hr.delete(e._id),e._parentId?this.#$r.get(e._parentId)?.delete(e._id):this.#Kr=void 0}childFrames(e){const t=this.#$r.get(e);return t?Array.from(t).map((e=>this.getById(e))).filter((e=>void 0!==e)):[]}parentFrame(e){const t=this.#Hr.get(e);return t?this.getById(t):void 0}}class sn{_requestId="";_interceptionId;_failureText=null;_response=null;_fromMemoryCache=!1;_redirectChain=[];constructor(){}}var an;function on(e){const t=[];for(const r in e){const i=e[r];if(!Object.is(i,void 0)){const e=Array.isArray(i)?i:[i];t.push(...e.map((e=>({name:r,value:e+""}))))}}return t}!function(e){e.Abort="abort",e.Respond="respond",e.Continue="continue",e.Disabled="disabled",e.None="none",e.AlreadyHandled="already-handled"}(an||(an={}));const cn={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Switch Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};class ln extends sn{#le;#Ur;#Wr;#zr=!1;#Ce;#Gr;#Qr;#Jr;#Xr={};#br;#Yr;#Zr=null;#ei=null;#ti={action:an.None};#ri;#ii;get client(){return this.#le}constructor(e,t,r,i,n,s){super(),this.#le=e,this._requestId=n.requestId,this.#Ur=n.requestId===n.loaderId&&"Document"===n.type,this._interceptionId=r,this.#Wr=i,this.#Ce=n.request.url,this.#Gr=(n.type||"other").toLowerCase(),this.#Qr=n.request.method,this.#Jr=n.request.postData,this.#br=t,this._redirectChain=s,this.#Yr={},this.#ri=[],this.#ii=n.initiator;for(const[e,t]of Object.entries(n.request.headers))this.#Xr[e.toLowerCase()]=t}url(){return this.#Ce}continueRequestOverrides(){return et(this.#Wr,"Request Interception is not enabled!"),this.#Yr}responseForRequest(){return et(this.#Wr,"Request Interception is not enabled!"),this.#Zr}abortErrorReason(){return et(this.#Wr,"Request Interception is not enabled!"),this.#ei}interceptResolutionState(){return this.#Wr?this.#zr?{action:an.AlreadyHandled}:{...this.#ti}:{action:an.Disabled}}isInterceptResolutionHandled(){return this.#zr}enqueueInterceptAction(e){this.#ri.push(e)}async finalizeInterceptions(){await this.#ri.reduce(((e,t)=>e.then(t)),Promise.resolve());const{action:e}=this.interceptResolutionState();switch(e){case"abort":return await this.#ni(this.#ei);case"respond":if(null===this.#Zr)throw new Error("Response is missing for the interception");return await this.#si(this.#Zr);case"continue":return await this.#ai(this.#Yr)}}resourceType(){return this.#Gr}method(){return this.#Qr}postData(){return this.#Jr}headers(){return this.#Xr}response(){return this._response}frame(){return this.#br}isNavigationRequest(){return this.#Ur}initiator(){return this.#ii}redirectChain(){return this._redirectChain.slice()}failure(){return this._failureText?{errorText:this._failureText}:null}async continue(e={},t){if(!this.#Ce.startsWith("data:")){if(et(this.#Wr,"Request Interception is not enabled!"),et(!this.#zr,"Request is already handled!"),void 0===t)return await this.#ai(e);if(this.#Yr=e,void 0===this.#ti.priority||t>this.#ti.priority)this.#ti={action:an.Continue,priority:t};else if(t===this.#ti.priority){if("abort"===this.#ti.action||"respond"===this.#ti.action)return;this.#ti.action=an.Continue}}}async#ai(e={}){const{url:t,method:r,postData:i,headers:n}=e;this.#zr=!0;const s=i?Buffer.from(i).toString("base64"):void 0;if(void 0===this._interceptionId)throw new Error("HTTPRequest is missing _interceptionId needed for Fetch.continueRequest");await this.#le.send("Fetch.continueRequest",{requestId:this._interceptionId,url:t,method:r,postData:s,headers:n?on(n):void 0}).catch((e=>(this.#zr=!1,un(e))))}async respond(e,t){if(!this.#Ce.startsWith("data:")){if(et(this.#Wr,"Request Interception is not enabled!"),et(!this.#zr,"Request is already handled!"),void 0===t)return await this.#si(e);if(this.#Zr=e,void 0===this.#ti.priority||t>this.#ti.priority)this.#ti={action:an.Respond,priority:t};else if(t===this.#ti.priority){if("abort"===this.#ti.action)return;this.#ti.action=an.Respond}}}async#si(e){this.#zr=!0;const t=e.body&&bt(e.body)?Buffer.from(e.body):e.body||null,r={};if(e.headers)for(const t of Object.keys(e.headers)){const i=e.headers[t];r[t.toLowerCase()]=Array.isArray(i)?i.map((e=>String(e))):String(i)}e.contentType&&(r["content-type"]=e.contentType),t&&!("content-length"in r)&&(r["content-length"]=String(Buffer.byteLength(t)));const i=e.status||200;if(void 0===this._interceptionId)throw new Error("HTTPRequest is missing _interceptionId needed for Fetch.fulfillRequest");await this.#le.send("Fetch.fulfillRequest",{requestId:this._interceptionId,responseCode:i,responsePhrase:cn[i],responseHeaders:on(r),body:t?t.toString("base64"):void 0}).catch((e=>(this.#zr=!1,un(e))))}async abort(e="failed",t){if(this.#Ce.startsWith("data:"))return;const r=dn[e];if(et(r,"Unknown error code: "+e),et(this.#Wr,"Request Interception is not enabled!"),et(!this.#zr,"Request is already handled!"),void 0===t)return await this.#ni(r);this.#ei=r,(void 0===this.#ti.priority||t>=this.#ti.priority)&&(this.#ti={action:an.Abort,priority:t})}async#ni(e){if(this.#zr=!0,void 0===this._interceptionId)throw new Error("HTTPRequest is missing _interceptionId needed for Fetch.failRequest");await this.#le.send("Fetch.failRequest",{requestId:this._interceptionId,errorReason:e||"Failed"}).catch(un)}}const dn={aborted:"Aborted",accessdenied:"AccessDenied",addressunreachable:"AddressUnreachable",blockedbyclient:"BlockedByClient",blockedbyresponse:"BlockedByResponse",connectionaborted:"ConnectionAborted",connectionclosed:"ConnectionClosed",connectionfailed:"ConnectionFailed",connectionrefused:"ConnectionRefused",connectionreset:"ConnectionReset",internetdisconnected:"InternetDisconnected",namenotresolved:"NameNotResolved",timedout:"TimedOut",failed:"Failed"};async function un(e){if(["Invalid header"].includes(e.originalMessage))throw e;pt(e)}class hn{constructor(){}ok(){const e=this.status();return 0===e||e>=200&&e<=299}async text(){return(await this.buffer()).toString("utf8")}async json(){const e=await this.text();return JSON.parse(e)}}class pn{#oi;#ci;#li;#di;#ui;#hi;constructor(e){this.#oi=e.subjectName,this.#ci=e.issuer,this.#li=e.validFrom,this.#di=e.validTo,this.#ui=e.protocol,this.#hi=e.sanList}issuer(){return this.#ci}validFrom(){return this.#li}validTo(){return this.#di}protocol(){return this.#ui}subjectName(){return this.#oi}subjectAlternativeNames(){return this.#hi}}class fn extends hn{#le;#pi;#fi=null;#yi=jt.create();#mi;#gi;#wi;#Ce;#vi;#bi;#Xr={};#ki;#Ci;constructor(e,t,r,i){super(),this.#le=e,this.#pi=t,this.#mi={ip:r.remoteIPAddress,port:r.remotePort},this.#wi=this.#Si(i)||r.statusText,this.#Ce=t.url(),this.#vi=!!r.fromDiskCache,this.#bi=!!r.fromServiceWorker,this.#gi=i?i.statusCode:r.status;const n=i?i.headers:r.headers;for(const[e,t]of Object.entries(n))this.#Xr[e.toLowerCase()]=t;this.#ki=r.securityDetails?new pn(r.securityDetails):null,this.#Ci=r.timing||null}#Si(e){if(!e||!e.headersText)return;const t=e.headersText.split("\r",1)[0];if(!t)return;const r=t.match(/[^ ]* [^ ]* (.*)/);if(!r)return;const i=r[1];return i||void 0}_resolveBody(e){return e?this.#yi.reject(e):this.#yi.resolve()}remoteAddress(){return this.#mi}url(){return this.#Ce}status(){return this.#gi}statusText(){return this.#wi}headers(){return this.#Xr}securityDetails(){return this.#ki}timing(){return this.#Ci}buffer(){return this.#fi||(this.#fi=this.#yi.valueOrThrow().then((async()=>{try{const e=await this.#le.send("Network.getResponseBody",{requestId:this.#pi._requestId});return Buffer.from(e.body,e.base64Encoded?"base64":"utf8")}catch(e){if(e instanceof dt&&"No resource with given identifier found"===e.originalMessage)throw new dt("Could not load body for this request. This might happen if the request is a preflight request.");throw e}}))),this.#fi}request(){return this.#pi}fromCache(){return this.#vi||this.#pi._fromMemoryCache}fromServiceWorker(){return this.#bi}frame(){return this.#pi.frame()}}class yn{#Ti=new Map;#Ei=new Map;#Ii=new Map;#xi=new Map;#Fi=new Map;#Ri=new Map;forget(e){this.#Ti.delete(e),this.#Ei.delete(e),this.#Ri.delete(e),this.#Fi.delete(e),this.#xi.delete(e)}responseExtraInfo(e){return this.#xi.has(e)||this.#xi.set(e,[]),this.#xi.get(e)}queuedRedirectInfo(e){return this.#Fi.has(e)||this.#Fi.set(e,[]),this.#Fi.get(e)}queueRedirectInfo(e,t){this.queuedRedirectInfo(e).push(t)}takeQueuedRedirectInfo(e){return this.queuedRedirectInfo(e).shift()}inFlightRequestsCount(){let e=0;for(const t of this.#Ii.values())t.response()||e++;return e}storeRequestWillBeSent(e,t){this.#Ti.set(e,t)}getRequestWillBeSent(e){return this.#Ti.get(e)}forgetRequestWillBeSent(e){this.#Ti.delete(e)}getRequestPaused(e){return this.#Ei.get(e)}forgetRequestPaused(e){this.#Ei.delete(e)}storeRequestPaused(e,t){this.#Ei.set(e,t)}getRequest(e){return this.#Ii.get(e)}storeRequest(e,t){this.#Ii.set(e,t)}forgetRequest(e){this.#Ii.delete(e)}getQueuedEventGroup(e){return this.#Ri.get(e)}queueEventGroup(e,t){this.#Ri.set(e,t)}forgetQueuedEventGroup(e){this.#Ri.delete(e)}}class mn extends Xe{#_i;#Mt;#Di=new yn;#Pi;#Mi;#qi=new Set;#Ai=!1;#Oi=!1;#Ni;#Bi;#Li;#ji;#i=[["Fetch.requestPaused",this.#Hi],["Fetch.authRequired",this.#$i],["Network.requestWillBeSent",this.#Ki],["Network.requestServedFromCache",this.#Vi],["Network.responseReceived",this.#Ui],["Network.loadingFinished",this.#Wi],["Network.loadingFailed",this.#zi],["Network.responseReceivedExtraInfo",this.#Gi],[Ot.Disconnected,this.#Qi]];#Ji=new Map;constructor(e,t){super(),this.#_i=e,this.#Mt=t}async addClient(e){if(this.#Ji.has(e))return;const t=new Qe;this.#Ji.set(e,t);for(const[r,i]of this.#i)t.use(new Ye(e,r,(t=>i.bind(this)(e,t))));await Promise.all([this.#_i?e.send("Security.setIgnoreCertificateErrors",{ignore:!0}):null,e.send("Network.enable"),this.#Xi(e),this.#Yi(e),this.#Zi(e),this.#en(e),this.#tn(e)])}async#Qi(e){this.#Ji.get(e)?.dispose(),this.#Ji.delete(e)}async authenticate(e){this.#Mi=e;const t=this.#Ai||!!this.#Mi;t!==this.#Oi&&(this.#Oi=t,await this.#rn(this.#en.bind(this)))}async setExtraHTTPHeaders(e){this.#Pi={};for(const t of Object.keys(e)){const r=e[t];et(bt(r),`Expected value of header "${t}" to be String, but "${typeof r}" is found.`),this.#Pi[t.toLowerCase()]=r}await this.#rn(this.#Xi.bind(this))}async#Xi(e){void 0!==this.#Pi&&await e.send("Network.setExtraHTTPHeaders",{headers:this.#Pi})}extraHTTPHeaders(){return Object.assign({},this.#Pi)}inFlightRequestsCount(){return this.#Di.inFlightRequestsCount()}async setOfflineMode(e){this.#Bi||(this.#Bi={offline:!1,upload:-1,download:-1,latency:0}),this.#Bi.offline=e,await this.#rn(this.#Yi.bind(this))}async emulateNetworkConditions(e){this.#Bi||(this.#Bi={offline:!1,upload:-1,download:-1,latency:0}),this.#Bi.upload=e?e.upload:-1,this.#Bi.download=e?e.download:-1,this.#Bi.latency=e?e.latency:0,await this.#rn(this.#Yi.bind(this))}async#rn(e){await Promise.all(Array.from(this.#Ji.keys()).map((t=>e(t))))}async#Yi(e){void 0!==this.#Bi&&await e.send("Network.emulateNetworkConditions",{offline:this.#Bi.offline,latency:this.#Bi.latency,uploadThroughput:this.#Bi.upload,downloadThroughput:this.#Bi.download})}async setUserAgent(e,t){this.#Li=e,this.#ji=t,await this.#rn(this.#tn.bind(this))}async#tn(e){void 0!==this.#Li&&await e.send("Network.setUserAgentOverride",{userAgent:this.#Li,userAgentMetadata:this.#ji})}async setCacheEnabled(e){this.#Ni=!e,await this.#rn(this.#Zi.bind(this))}async setRequestInterception(e){this.#Ai=e;const t=this.#Ai||!!this.#Mi;t!==this.#Oi&&(this.#Oi=t,await this.#rn(this.#en.bind(this)))}async#en(e){void 0===this.#Ni&&(this.#Ni=!1),this.#Oi?await Promise.all([this.#Zi(e),e.send("Fetch.enable",{handleAuthRequests:!0,patterns:[{urlPattern:"*"}]})]):await Promise.all([this.#Zi(e),e.send("Fetch.disable")])}async#Zi(e){void 0!==this.#Ni&&await e.send("Network.setCacheDisabled",{cacheDisabled:this.#Ni})}#Ki(e,t){if(!this.#Ai||t.request.url.startsWith("data:"))this.#Ar(e,t,void 0);else{const{requestId:r}=t;this.#Di.storeRequestWillBeSent(r,t);const i=this.#Di.getRequestPaused(r);if(i){const{requestId:n}=i;this.#in(t,i),this.#Ar(e,t,n),this.#Di.forgetRequestPaused(r)}}}#$i(e,t){let r="Default";this.#qi.has(t.requestId)?r="CancelAuth":this.#Mi&&(r="ProvideCredentials",this.#qi.add(t.requestId));const{username:i,password:n}=this.#Mi||{username:void 0,password:void 0};e.send("Fetch.continueWithAuth",{requestId:t.requestId,authChallengeResponse:{response:r,username:i,password:n}}).catch(pt)}#Hi(e,t){!this.#Ai&&this.#Oi&&e.send("Fetch.continueRequest",{requestId:t.requestId}).catch(pt);const{networkId:r,requestId:i}=t;if(!r)return void this.#nn(e,t);const n=(()=>{const e=this.#Di.getRequestWillBeSent(r);if(!e||e.request.url===t.request.url&&e.request.method===t.request.method)return e;this.#Di.forgetRequestWillBeSent(r)})();n?(this.#in(n,t),this.#Ar(e,n,i)):this.#Di.storeRequestPaused(r,t)}#in(e,t){e.request.headers={...e.request.headers,...t.request.headers}}#nn(e,t){const r=t.frameId?this.#Mt.frame(t.frameId):null,i=new ln(e,r,t.requestId,this.#Ai,t,[]);this.emit(Bt.Request,i),i.finalizeInterceptions()}#Ar(e,t,r){let i=[];if(t.redirectResponse){let n=null;if(t.redirectHasExtraInfo&&(n=this.#Di.responseExtraInfo(t.requestId).shift(),!n))return void this.#Di.queueRedirectInfo(t.requestId,{event:t,fetchRequestId:r});const s=this.#Di.getRequest(t.requestId);s&&(this.#sn(e,s,t.redirectResponse,n),i=s._redirectChain)}const n=t.frameId?this.#Mt.frame(t.frameId):null,s=new ln(e,n,r,this.#Ai,t,i);this.#Di.storeRequest(t.requestId,s),this.emit(Bt.Request,s),s.finalizeInterceptions()}#Vi(e,t){const r=this.#Di.getRequest(t.requestId);r&&(r._fromMemoryCache=!0),this.emit(Bt.RequestServedFromCache,r)}#sn(e,t,r,i){const n=new fn(e,t,r,i);t._response=n,t._redirectChain.push(t),n._resolveBody(new Error("Response body is unavailable for redirect responses")),this.#an(t,!1),this.emit(Bt.Response,n),this.emit(Bt.RequestFinished,t)}#on(e,t,r){const i=this.#Di.getRequest(t.requestId);if(!i)return;this.#Di.responseExtraInfo(t.requestId).length&&pt(new Error("Unexpected extraInfo events for request "+t.requestId)),t.response.fromDiskCache&&(r=null);const n=new fn(e,i,t.response,r);i._response=n,this.emit(Bt.Response,n)}#Ui(e,t){const r=this.#Di.getRequest(t.requestId);let i=null;!r||r._fromMemoryCache||!t.hasExtraInfo||(i=this.#Di.responseExtraInfo(t.requestId).shift(),i)?this.#on(e,t,i):this.#Di.queueEventGroup(t.requestId,{responseReceivedEvent:t})}#Gi(e,t){const r=this.#Di.takeQueuedRedirectInfo(t.requestId);if(r)return this.#Di.responseExtraInfo(t.requestId).push(t),void this.#Ar(e,r.event,r.fetchRequestId);const i=this.#Di.getQueuedEventGroup(t.requestId);if(i)return this.#Di.forgetQueuedEventGroup(t.requestId),this.#on(e,i.responseReceivedEvent,t),i.loadingFinishedEvent&&this.#cn(i.loadingFinishedEvent),void(i.loadingFailedEvent&&this.#ln(i.loadingFailedEvent));this.#Di.responseExtraInfo(t.requestId).push(t)}#an(e,t){const r=e._requestId,i=e._interceptionId;this.#Di.forgetRequest(r),void 0!==i&&this.#qi.delete(i),t&&this.#Di.forget(r)}#Wi(e,t){const r=this.#Di.getQueuedEventGroup(t.requestId);r?r.loadingFinishedEvent=t:this.#cn(t)}#cn(e){const t=this.#Di.getRequest(e.requestId);t&&(t.response()&&t.response()?._resolveBody(),this.#an(t,!0),this.emit(Bt.RequestFinished,t))}#zi(e,t){const r=this.#Di.getQueuedEventGroup(t.requestId);r?r.loadingFailedEvent=t:this.#ln(t)}#ln(e){const t=this.#Di.getRequest(e.requestId);if(!t)return;t._failureText=e.errorText;const r=t.response();r&&r._resolveBody(),this.#an(t,!0),this.emit(Bt.RequestFailed,t)}}class gn extends Xe{#dn;#un;#er;#hn=new Map;#pn=new Set;#le;_frameTree=new nn;#fn=new Set;#yn=new WeakMap;#mn;get timeoutSettings(){return this.#er}get networkManager(){return this.#un}get client(){return this.#le}constructor(e,t,r,i){super(),this.#le=e,this.#dn=t,this.#un=new mn(r,this),this.#er=i,this.setupEventListeners(this.#le),e.once(Ot.Disconnected,(()=>{this.#gn().catch(pt)}))}async#gn(){const e=this._frameTree.getMainFrame();if(!e)return;for(const t of e.childFrames())this.#wn(t);const t=jt.create({timeout:100,message:"Frame was not swapped"});e.once(Mi.FrameSwappedByActivation,(()=>{t.resolve()}));try{await t.valueOrThrow()}catch(t){this.#wn(e)}}async swapFrameTree(e){this.#je(this.#le),this.#le=e,et(this.#le instanceof Vt,"CDPSession is not an instance of CDPSessionImpl.");const t=this._frameTree.getMainFrame();t&&(this.#fn.add(this.#le._target()._targetId),this._frameTree.removeFrame(t),t.updateId(this.#le._target()._targetId),t.mainRealm().clearContext(),t.isolatedRealm().clearContext(),this._frameTree.addFrame(t),t.updateClient(e,!0)),this.setupEventListeners(e),e.once(Ot.Disconnected,(()=>{this.#gn().catch(pt)})),await this.initialize(e),await this.#un.addClient(e),t&&t.emit(Mi.FrameSwappedByActivation,void 0)}async registerSpeculativeSession(e){await this.#un.addClient(e)}setupEventListeners(e){e.on("Page.frameAttached",(async t=>{await(this.#mn?.valueOrThrow()),this.#vn(e,t.frameId,t.parentFrameId)})),e.on("Page.frameNavigated",(async e=>{this.#fn.add(e.frame.id),await(this.#mn?.valueOrThrow()),this.#bn(e.frame,e.type)})),e.on("Page.navigatedWithinDocument",(async e=>{await(this.#mn?.valueOrThrow()),this.#kn(e.frameId,e.url)})),e.on("Page.frameDetached",(async e=>{await(this.#mn?.valueOrThrow()),this.#qr(e.frameId,e.reason)})),e.on("Page.frameStartedLoading",(async e=>{await(this.#mn?.valueOrThrow()),this.#Cn(e.frameId)})),e.on("Page.frameStoppedLoading",(async e=>{await(this.#mn?.valueOrThrow()),this.#Sn(e.frameId)})),e.on("Runtime.executionContextCreated",(async t=>{await(this.#mn?.valueOrThrow()),this.#Tn(t.context,e)})),e.on("Runtime.executionContextDestroyed",(async t=>{await(this.#mn?.valueOrThrow()),this.#En(t.executionContextId,e)})),e.on("Runtime.executionContextsCleared",(async()=>{await(this.#mn?.valueOrThrow()),this.#je(e)})),e.on("Page.lifecycleEvent",(async e=>{await(this.#mn?.valueOrThrow()),this.#In(e)}))}async initialize(e){try{this.#mn?.resolve(),this.#mn=jt.create(),await Promise.all([this.#un.addClient(e),e.send("Page.enable"),e.send("Page.getFrameTree").then((({frameTree:t})=>{this.#xn(e,t),this.#mn?.resolve()})),e.send("Page.setLifecycleEventsEnabled",{enabled:!0}),e.send("Runtime.enable").then((()=>this.#Fn(e,Rt)))])}catch(e){if(this.#mn?.resolve(),tt(e)&&Or(e))return;throw e}}executionContextById(e,t=this.#le){const r=this.getExecutionContextById(e,t);return et(r,"INTERNAL ERROR: missing context with id = "+e),r}getExecutionContextById(e,t=this.#le){return this.#hn.get(`${t.id()}:${e}`)}page(){return this.#dn}mainFrame(){const e=this._frameTree.getMainFrame();return et(e,"Requesting main frame too early!"),e}frames(){return Array.from(this._frameTree.frames())}frame(e){return this._frameTree.getById(e)||null}onAttachedToTarget(e){if("iframe"!==e._getTargetInfo().type)return;const t=this.frame(e._getTargetInfo().targetId);t&&t.updateClient(e._session()),this.setupEventListeners(e._session()),this.initialize(e._session())}_deviceRequestPromptManager(e){let t=this.#yn.get(e);return void 0===t&&(t=new $i(e,this.#er),this.#yn.set(e,t)),t}#In(e){const t=this.frame(e.frameId);t&&(t._onLifecycleEvent(e.loaderId,e.name),this.emit(Xi.LifecycleEvent,t),t.emit(Mi.LifecycleEvent,void 0))}#Cn(e){const t=this.frame(e);t&&t._onLoadingStarted()}#Sn(e){const t=this.frame(e);t&&(t._onLoadingStopped(),this.emit(Xi.LifecycleEvent,t),t.emit(Mi.LifecycleEvent,void 0))}#xn(e,t){if(t.frame.parentId&&this.#vn(e,t.frame.id,t.frame.parentId),this.#fn.has(t.frame.id)?this.#fn.delete(t.frame.id):this.#bn(t.frame,"Navigation"),t.childFrames)for(const r of t.childFrames)this.#xn(e,r)}#vn(e,t,r){let i=this.frame(t);i?e&&i.isOOPFrame()&&i.updateClient(e):(i=new rn(this,t,r,e),this._frameTree.addFrame(i),this.emit(Xi.FrameAttached,i))}async#bn(e,t){const r=e.id,i=!e.parentId;let n=this._frameTree.getById(r);if(n)for(const e of n.childFrames())this.#wn(e);i&&(n?(this._frameTree.removeFrame(n),n._id=r):n=new rn(this,r,void 0,this.#le),this._frameTree.addFrame(n)),n=await this._frameTree.waitForFrame(r),n._navigated(e),this.emit(Xi.FrameNavigated,n),n.emit(Mi.FrameNavigated,t)}async#Fn(e,t){const r=`${e.id()}:${t}`;this.#pn.has(r)||(await e.send("Page.addScriptToEvaluateOnNewDocument",{source:`//# sourceURL=${gt.INTERNAL_URL}`,worldName:t}),await Promise.all(this.frames().filter((t=>t.client===e)).map((r=>e.send("Page.createIsolatedWorld",{frameId:r._id,worldName:t,grantUniveralAccess:!0}).catch(pt)))),this.#pn.add(r))}#kn(e,t){const r=this.frame(e);r&&(r._navigatedWithinDocument(t),this.emit(Xi.FrameNavigatedWithinDocument,r),r.emit(Mi.FrameNavigatedWithinDocument,void 0),this.emit(Xi.FrameNavigated,r),r.emit(Mi.FrameNavigated,"Navigation"))}#qr(e,t){const r=this.frame(e);if(r)switch(t){case"remove":this.#wn(r);break;case"swap":this.emit(Xi.FrameSwapped,r),r.emit(Mi.FrameSwapped,void 0)}}#Tn(e,t){const r=e.auxData,i=r&&r.frameId,n="string"==typeof i?this.frame(i):void 0;let s;if(n){if(n.client!==t)return;e.auxData&&e.auxData.isDefault?s=n.worlds[Qi]:e.name!==Rt||n.worlds[Ji].hasContext()||(s=n.worlds[Ji])}if(!s)return;const a=new Ri(n?.client||this.#le,e,s);s&&s.setContext(a);const o=`${t.id()}:${e.id}`;this.#hn.set(o,a)}#En(e,t){const r=`${t.id()}:${e}`,i=this.#hn.get(r);i&&(this.#hn.delete(r),i._world&&i._world.clearContext())}#je(e){for(const[t,r]of this.#hn.entries())r._client===e&&(r._world&&r._world.clearContext(),this.#hn.delete(t))}#wn(e){for(const t of e.childFrames())this.#wn(t);e[ze](),this._frameTree.removeFrame(e),this.emit(Xi.FrameDetached,e),e.emit(Mi.FrameDetached,e)}}class wn{constructor(){}}const vn=Object.freeze({Left:"left",Right:"right",Middle:"middle",Back:"back",Forward:"forward"});class bn{constructor(){}}class kn{constructor(){}async tap(e,t){await this.touchStart(e,t),await this.touchEnd()}}const Cn={0:{keyCode:48,key:"0",code:"Digit0"},1:{keyCode:49,key:"1",code:"Digit1"},2:{keyCode:50,key:"2",code:"Digit2"},3:{keyCode:51,key:"3",code:"Digit3"},4:{keyCode:52,key:"4",code:"Digit4"},5:{keyCode:53,key:"5",code:"Digit5"},6:{keyCode:54,key:"6",code:"Digit6"},7:{keyCode:55,key:"7",code:"Digit7"},8:{keyCode:56,key:"8",code:"Digit8"},9:{keyCode:57,key:"9",code:"Digit9"},Power:{key:"Power",code:"Power"},Eject:{key:"Eject",code:"Eject"},Abort:{keyCode:3,code:"Abort",key:"Cancel"},Help:{keyCode:6,code:"Help",key:"Help"},Backspace:{keyCode:8,code:"Backspace",key:"Backspace"},Tab:{keyCode:9,code:"Tab",key:"Tab"},Numpad5:{keyCode:12,shiftKeyCode:101,key:"Clear",code:"Numpad5",shiftKey:"5",location:3},NumpadEnter:{keyCode:13,code:"NumpadEnter",key:"Enter",text:"\r",location:3},Enter:{keyCode:13,code:"Enter",key:"Enter",text:"\r"},"\r":{keyCode:13,code:"Enter",key:"Enter",text:"\r"},"\n":{keyCode:13,code:"Enter",key:"Enter",text:"\r"},ShiftLeft:{keyCode:16,code:"ShiftLeft",key:"Shift",location:1},ShiftRight:{keyCode:16,code:"ShiftRight",key:"Shift",location:2},ControlLeft:{keyCode:17,code:"ControlLeft",key:"Control",location:1},ControlRight:{keyCode:17,code:"ControlRight",key:"Control",location:2},AltLeft:{keyCode:18,code:"AltLeft",key:"Alt",location:1},AltRight:{keyCode:18,code:"AltRight",key:"Alt",location:2},Pause:{keyCode:19,code:"Pause",key:"Pause"},CapsLock:{keyCode:20,code:"CapsLock",key:"CapsLock"},Escape:{keyCode:27,code:"Escape",key:"Escape"},Convert:{keyCode:28,code:"Convert",key:"Convert"},NonConvert:{keyCode:29,code:"NonConvert",key:"NonConvert"},Space:{keyCode:32,code:"Space",key:" "},Numpad9:{keyCode:33,shiftKeyCode:105,key:"PageUp",code:"Numpad9",shiftKey:"9",location:3},PageUp:{keyCode:33,code:"PageUp",key:"PageUp"},Numpad3:{keyCode:34,shiftKeyCode:99,key:"PageDown",code:"Numpad3",shiftKey:"3",location:3},PageDown:{keyCode:34,code:"PageDown",key:"PageDown"},End:{keyCode:35,code:"End",key:"End"},Numpad1:{keyCode:35,shiftKeyCode:97,key:"End",code:"Numpad1",shiftKey:"1",location:3},Home:{keyCode:36,code:"Home",key:"Home"},Numpad7:{keyCode:36,shiftKeyCode:103,key:"Home",code:"Numpad7",shiftKey:"7",location:3},ArrowLeft:{keyCode:37,code:"ArrowLeft",key:"ArrowLeft"},Numpad4:{keyCode:37,shiftKeyCode:100,key:"ArrowLeft",code:"Numpad4",shiftKey:"4",location:3},Numpad8:{keyCode:38,shiftKeyCode:104,key:"ArrowUp",code:"Numpad8",shiftKey:"8",location:3},ArrowUp:{keyCode:38,code:"ArrowUp",key:"ArrowUp"},ArrowRight:{keyCode:39,code:"ArrowRight",key:"ArrowRight"},Numpad6:{keyCode:39,shiftKeyCode:102,key:"ArrowRight",code:"Numpad6",shiftKey:"6",location:3},Numpad2:{keyCode:40,shiftKeyCode:98,key:"ArrowDown",code:"Numpad2",shiftKey:"2",location:3},ArrowDown:{keyCode:40,code:"ArrowDown",key:"ArrowDown"},Select:{keyCode:41,code:"Select",key:"Select"},Open:{keyCode:43,code:"Open",key:"Execute"},PrintScreen:{keyCode:44,code:"PrintScreen",key:"PrintScreen"},Insert:{keyCode:45,code:"Insert",key:"Insert"},Numpad0:{keyCode:45,shiftKeyCode:96,key:"Insert",code:"Numpad0",shiftKey:"0",location:3},Delete:{keyCode:46,code:"Delete",key:"Delete"},NumpadDecimal:{keyCode:46,shiftKeyCode:110,code:"NumpadDecimal",key:"\0",shiftKey:".",location:3},Digit0:{keyCode:48,code:"Digit0",shiftKey:")",key:"0"},Digit1:{keyCode:49,code:"Digit1",shiftKey:"!",key:"1"},Digit2:{keyCode:50,code:"Digit2",shiftKey:"@",key:"2"},Digit3:{keyCode:51,code:"Digit3",shiftKey:"#",key:"3"},Digit4:{keyCode:52,code:"Digit4",shiftKey:"$",key:"4"},Digit5:{keyCode:53,code:"Digit5",shiftKey:"%",key:"5"},Digit6:{keyCode:54,code:"Digit6",shiftKey:"^",key:"6"},Digit7:{keyCode:55,code:"Digit7",shiftKey:"&",key:"7"},Digit8:{keyCode:56,code:"Digit8",shiftKey:"*",key:"8"},Digit9:{keyCode:57,code:"Digit9",shiftKey:"(",key:"9"},KeyA:{keyCode:65,code:"KeyA",shiftKey:"A",key:"a"},KeyB:{keyCode:66,code:"KeyB",shiftKey:"B",key:"b"},KeyC:{keyCode:67,code:"KeyC",shiftKey:"C",key:"c"},KeyD:{keyCode:68,code:"KeyD",shiftKey:"D",key:"d"},KeyE:{keyCode:69,code:"KeyE",shiftKey:"E",key:"e"},KeyF:{keyCode:70,code:"KeyF",shiftKey:"F",key:"f"},KeyG:{keyCode:71,code:"KeyG",shiftKey:"G",key:"g"},KeyH:{keyCode:72,code:"KeyH",shiftKey:"H",key:"h"},KeyI:{keyCode:73,code:"KeyI",shiftKey:"I",key:"i"},KeyJ:{keyCode:74,code:"KeyJ",shiftKey:"J",key:"j"},KeyK:{keyCode:75,code:"KeyK",shiftKey:"K",key:"k"},KeyL:{keyCode:76,code:"KeyL",shiftKey:"L",key:"l"},KeyM:{keyCode:77,code:"KeyM",shiftKey:"M",key:"m"},KeyN:{keyCode:78,code:"KeyN",shiftKey:"N",key:"n"},KeyO:{keyCode:79,code:"KeyO",shiftKey:"O",key:"o"},KeyP:{keyCode:80,code:"KeyP",shiftKey:"P",key:"p"},KeyQ:{keyCode:81,code:"KeyQ",shiftKey:"Q",key:"q"},KeyR:{keyCode:82,code:"KeyR",shiftKey:"R",key:"r"},KeyS:{keyCode:83,code:"KeyS",shiftKey:"S",key:"s"},KeyT:{keyCode:84,code:"KeyT",shiftKey:"T",key:"t"},KeyU:{keyCode:85,code:"KeyU",shiftKey:"U",key:"u"},KeyV:{keyCode:86,code:"KeyV",shiftKey:"V",key:"v"},KeyW:{keyCode:87,code:"KeyW",shiftKey:"W",key:"w"},KeyX:{keyCode:88,code:"KeyX",shiftKey:"X",key:"x"},KeyY:{keyCode:89,code:"KeyY",shiftKey:"Y",key:"y"},KeyZ:{keyCode:90,code:"KeyZ",shiftKey:"Z",key:"z"},MetaLeft:{keyCode:91,code:"MetaLeft",key:"Meta",location:1},MetaRight:{keyCode:92,code:"MetaRight",key:"Meta",location:2},ContextMenu:{keyCode:93,code:"ContextMenu",key:"ContextMenu"},NumpadMultiply:{keyCode:106,code:"NumpadMultiply",key:"*",location:3},NumpadAdd:{keyCode:107,code:"NumpadAdd",key:"+",location:3},NumpadSubtract:{keyCode:109,code:"NumpadSubtract",key:"-",location:3},NumpadDivide:{keyCode:111,code:"NumpadDivide",key:"/",location:3},F1:{keyCode:112,code:"F1",key:"F1"},F2:{keyCode:113,code:"F2",key:"F2"},F3:{keyCode:114,code:"F3",key:"F3"},F4:{keyCode:115,code:"F4",key:"F4"},F5:{keyCode:116,code:"F5",key:"F5"},F6:{keyCode:117,code:"F6",key:"F6"},F7:{keyCode:118,code:"F7",key:"F7"},F8:{keyCode:119,code:"F8",key:"F8"},F9:{keyCode:120,code:"F9",key:"F9"},F10:{keyCode:121,code:"F10",key:"F10"},F11:{keyCode:122,code:"F11",key:"F11"},F12:{keyCode:123,code:"F12",key:"F12"},F13:{keyCode:124,code:"F13",key:"F13"},F14:{keyCode:125,code:"F14",key:"F14"},F15:{keyCode:126,code:"F15",key:"F15"},F16:{keyCode:127,code:"F16",key:"F16"},F17:{keyCode:128,code:"F17",key:"F17"},F18:{keyCode:129,code:"F18",key:"F18"},F19:{keyCode:130,code:"F19",key:"F19"},F20:{keyCode:131,code:"F20",key:"F20"},F21:{keyCode:132,code:"F21",key:"F21"},F22:{keyCode:133,code:"F22",key:"F22"},F23:{keyCode:134,code:"F23",key:"F23"},F24:{keyCode:135,code:"F24",key:"F24"},NumLock:{keyCode:144,code:"NumLock",key:"NumLock"},ScrollLock:{keyCode:145,code:"ScrollLock",key:"ScrollLock"},AudioVolumeMute:{keyCode:173,code:"AudioVolumeMute",key:"AudioVolumeMute"},AudioVolumeDown:{keyCode:174,code:"AudioVolumeDown",key:"AudioVolumeDown"},AudioVolumeUp:{keyCode:175,code:"AudioVolumeUp",key:"AudioVolumeUp"},MediaTrackNext:{keyCode:176,code:"MediaTrackNext",key:"MediaTrackNext"},MediaTrackPrevious:{keyCode:177,code:"MediaTrackPrevious",key:"MediaTrackPrevious"},MediaStop:{keyCode:178,code:"MediaStop",key:"MediaStop"},MediaPlayPause:{keyCode:179,code:"MediaPlayPause",key:"MediaPlayPause"},Semicolon:{keyCode:186,code:"Semicolon",shiftKey:":",key:";"},Equal:{keyCode:187,code:"Equal",shiftKey:"+",key:"="},NumpadEqual:{keyCode:187,code:"NumpadEqual",key:"=",location:3},Comma:{keyCode:188,code:"Comma",shiftKey:"<",key:","},Minus:{keyCode:189,code:"Minus",shiftKey:"_",key:"-"},Period:{keyCode:190,code:"Period",shiftKey:">",key:"."},Slash:{keyCode:191,code:"Slash",shiftKey:"?",key:"/"},Backquote:{keyCode:192,code:"Backquote",shiftKey:"~",key:"`"},BracketLeft:{keyCode:219,code:"BracketLeft",shiftKey:"{",key:"["},Backslash:{keyCode:220,code:"Backslash",shiftKey:"|",key:"\\"},BracketRight:{keyCode:221,code:"BracketRight",shiftKey:"}",key:"]"},Quote:{keyCode:222,code:"Quote",shiftKey:'"',key:"'"},AltGraph:{keyCode:225,code:"AltGraph",key:"AltGraph"},Props:{keyCode:247,code:"Props",key:"CrSel"},Cancel:{keyCode:3,key:"Cancel",code:"Abort"},Clear:{keyCode:12,key:"Clear",code:"Numpad5",location:3},Shift:{keyCode:16,key:"Shift",code:"ShiftLeft",location:1},Control:{keyCode:17,key:"Control",code:"ControlLeft",location:1},Alt:{keyCode:18,key:"Alt",code:"AltLeft",location:1},Accept:{keyCode:30,key:"Accept"},ModeChange:{keyCode:31,key:"ModeChange"}," ":{keyCode:32,key:" ",code:"Space"},Print:{keyCode:42,key:"Print"},Execute:{keyCode:43,key:"Execute",code:"Open"},"\0":{keyCode:46,key:"\0",code:"NumpadDecimal",location:3},a:{keyCode:65,key:"a",code:"KeyA"},b:{keyCode:66,key:"b",code:"KeyB"},c:{keyCode:67,key:"c",code:"KeyC"},d:{keyCode:68,key:"d",code:"KeyD"},e:{keyCode:69,key:"e",code:"KeyE"},f:{keyCode:70,key:"f",code:"KeyF"},g:{keyCode:71,key:"g",code:"KeyG"},h:{keyCode:72,key:"h",code:"KeyH"},i:{keyCode:73,key:"i",code:"KeyI"},j:{keyCode:74,key:"j",code:"KeyJ"},k:{keyCode:75,key:"k",code:"KeyK"},l:{keyCode:76,key:"l",code:"KeyL"},m:{keyCode:77,key:"m",code:"KeyM"},n:{keyCode:78,key:"n",code:"KeyN"},o:{keyCode:79,key:"o",code:"KeyO"},p:{keyCode:80,key:"p",code:"KeyP"},q:{keyCode:81,key:"q",code:"KeyQ"},r:{keyCode:82,key:"r",code:"KeyR"},s:{keyCode:83,key:"s",code:"KeyS"},t:{keyCode:84,key:"t",code:"KeyT"},u:{keyCode:85,key:"u",code:"KeyU"},v:{keyCode:86,key:"v",code:"KeyV"},w:{keyCode:87,key:"w",code:"KeyW"},x:{keyCode:88,key:"x",code:"KeyX"},y:{keyCode:89,key:"y",code:"KeyY"},z:{keyCode:90,key:"z",code:"KeyZ"},Meta:{keyCode:91,key:"Meta",code:"MetaLeft",location:1},"*":{keyCode:106,key:"*",code:"NumpadMultiply",location:3},"+":{keyCode:107,key:"+",code:"NumpadAdd",location:3},"-":{keyCode:109,key:"-",code:"NumpadSubtract",location:3},"/":{keyCode:111,key:"/",code:"NumpadDivide",location:3},";":{keyCode:186,key:";",code:"Semicolon"},"=":{keyCode:187,key:"=",code:"Equal"},",":{keyCode:188,key:",",code:"Comma"},".":{keyCode:190,key:".",code:"Period"},"`":{keyCode:192,key:"`",code:"Backquote"},"[":{keyCode:219,key:"[",code:"BracketLeft"},"\\":{keyCode:220,key:"\\",code:"Backslash"},"]":{keyCode:221,key:"]",code:"BracketRight"},"'":{keyCode:222,key:"'",code:"Quote"},Attn:{keyCode:246,key:"Attn"},CrSel:{keyCode:247,key:"CrSel",code:"Props"},ExSel:{keyCode:248,key:"ExSel"},EraseEof:{keyCode:249,key:"EraseEof"},Play:{keyCode:250,key:"Play"},ZoomOut:{keyCode:251,key:"ZoomOut"},")":{keyCode:48,key:")",code:"Digit0"},"!":{keyCode:49,key:"!",code:"Digit1"},"@":{keyCode:50,key:"@",code:"Digit2"},"#":{keyCode:51,key:"#",code:"Digit3"},$:{keyCode:52,key:"$",code:"Digit4"},"%":{keyCode:53,key:"%",code:"Digit5"},"^":{keyCode:54,key:"^",code:"Digit6"},"&":{keyCode:55,key:"&",code:"Digit7"},"(":{keyCode:57,key:"(",code:"Digit9"},A:{keyCode:65,key:"A",code:"KeyA"},B:{keyCode:66,key:"B",code:"KeyB"},C:{keyCode:67,key:"C",code:"KeyC"},D:{keyCode:68,key:"D",code:"KeyD"},E:{keyCode:69,key:"E",code:"KeyE"},F:{keyCode:70,key:"F",code:"KeyF"},G:{keyCode:71,key:"G",code:"KeyG"},H:{keyCode:72,key:"H",code:"KeyH"},I:{keyCode:73,key:"I",code:"KeyI"},J:{keyCode:74,key:"J",code:"KeyJ"},K:{keyCode:75,key:"K",code:"KeyK"},L:{keyCode:76,key:"L",code:"KeyL"},M:{keyCode:77,key:"M",code:"KeyM"},N:{keyCode:78,key:"N",code:"KeyN"},O:{keyCode:79,key:"O",code:"KeyO"},P:{keyCode:80,key:"P",code:"KeyP"},Q:{keyCode:81,key:"Q",code:"KeyQ"},R:{keyCode:82,key:"R",code:"KeyR"},S:{keyCode:83,key:"S",code:"KeyS"},T:{keyCode:84,key:"T",code:"KeyT"},U:{keyCode:85,key:"U",code:"KeyU"},V:{keyCode:86,key:"V",code:"KeyV"},W:{keyCode:87,key:"W",code:"KeyW"},X:{keyCode:88,key:"X",code:"KeyX"},Y:{keyCode:89,key:"Y",code:"KeyY"},Z:{keyCode:90,key:"Z",code:"KeyZ"},":":{keyCode:186,key:":",code:"Semicolon"},"<":{keyCode:188,key:"<",code:"Comma"},_:{keyCode:189,key:"_",code:"Minus"},">":{keyCode:190,key:">",code:"Period"},"?":{keyCode:191,key:"?",code:"Slash"},"~":{keyCode:192,key:"~",code:"Backquote"},"{":{keyCode:219,key:"{",code:"BracketLeft"},"|":{keyCode:220,key:"|",code:"Backslash"},"}":{keyCode:221,key:"}",code:"BracketRight"},'"':{keyCode:222,key:'"',code:"Quote"},SoftLeft:{key:"SoftLeft",code:"SoftLeft",location:4},SoftRight:{key:"SoftRight",code:"SoftRight",location:4},Camera:{keyCode:44,key:"Camera",code:"Camera",location:4},Call:{key:"Call",code:"Call",location:4},EndCall:{keyCode:95,key:"EndCall",code:"EndCall",location:4},VolumeDown:{keyCode:182,key:"VolumeDown",code:"VolumeDown",location:4},VolumeUp:{keyCode:183,key:"VolumeUp",code:"VolumeUp",location:4}};class Sn extends wn{#le;#Rn=new Set;_modifiers=0;constructor(e){super(),this.#le=e}updateClient(e){this.#le=e}async down(e,t={text:void 0,commands:[]}){const r=this.#_n(e),i=this.#Rn.has(r.code);this.#Rn.add(r.code),this._modifiers|=this.#Dn(r.key);const n=void 0===t.text?r.text:t.text;await this.#le.send("Input.dispatchKeyEvent",{type:n?"keyDown":"rawKeyDown",modifiers:this._modifiers,windowsVirtualKeyCode:r.keyCode,code:r.code,key:r.key,text:n,unmodifiedText:n,autoRepeat:i,location:r.location,isKeypad:3===r.location,commands:t.commands})}#Dn(e){return"Alt"===e?1:"Control"===e?2:"Meta"===e?4:"Shift"===e?8:0}#_n(e){const t=8&this._modifiers,r={key:"",keyCode:0,code:"",text:"",location:0},i=Cn[e];return et(i,`Unknown key: "${e}"`),i.key&&(r.key=i.key),t&&i.shiftKey&&(r.key=i.shiftKey),i.keyCode&&(r.keyCode=i.keyCode),t&&i.shiftKeyCode&&(r.keyCode=i.shiftKeyCode),i.code&&(r.code=i.code),i.location&&(r.location=i.location),1===r.key.length&&(r.text=r.key),i.text&&(r.text=i.text),t&&i.shiftText&&(r.text=i.shiftText),-9&this._modifiers&&(r.text=""),r}async up(e){const t=this.#_n(e);this._modifiers&=~this.#Dn(t.key),this.#Rn.delete(t.code),await this.#le.send("Input.dispatchKeyEvent",{type:"keyUp",modifiers:this._modifiers,key:t.key,windowsVirtualKeyCode:t.keyCode,code:t.code,location:t.location})}async sendCharacter(e){await this.#le.send("Input.insertText",{text:e})}charIsKey(e){return!!Cn[e]}async type(e,t={}){const r=t.delay||void 0;for(const t of e)this.charIsKey(t)?await this.press(t,{delay:r}):(r&&await new Promise((e=>setTimeout(e,r))),await this.sendCharacter(t))}async press(e,t={}){const{delay:r=null}=t;await this.down(e,t),r&&await new Promise((e=>setTimeout(e,t.delay))),await this.up(e)}}const Tn=e=>{switch(e){case vn.Left:return 1;case vn.Right:return 2;case vn.Middle:return 4;case vn.Back:return 8;case vn.Forward:return 16}},En=e=>1&e?vn.Left:2&e?vn.Right:4&e?vn.Middle:8&e?vn.Back:16&e?vn.Forward:"none";class In extends bn{#le;#Pn;constructor(e,t){super(),this.#le=e,this.#Pn=t}updateClient(e){this.#le=e}#Mn={position:{x:0,y:0},buttons:0};get#ze(){return Object.assign({...this.#Mn},...this.#qn)}#qn=[];#An(){const e={};this.#qn.push(e);const t=()=>{this.#qn.splice(this.#qn.indexOf(e),1)};return{update:t=>{Object.assign(e,t)},commit:()=>{this.#Mn={...this.#Mn,...e},t()},rollback:t}}async#On(e){const{update:t,commit:r,rollback:i}=this.#An();try{await e(t),r()}catch(e){throw i(),e}}async reset(){const e=[];for(const[t,r]of[[1,vn.Left],[4,vn.Middle],[2,vn.Right],[16,vn.Forward],[8,vn.Back]])this.#ze.buttons&t&&e.push(this.up({button:r}));0===this.#ze.position.x&&0===this.#ze.position.y||e.push(this.move(0,0)),await Promise.all(e)}async move(e,t,r={}){const{steps:i=1}=r,n=this.#ze.position,s=e,a=t;for(let e=1;e<=i;e++)await this.#On((t=>{t({position:{x:n.x+(s-n.x)*(e/i),y:n.y+(a-n.y)*(e/i)}});const{buttons:r,position:o}=this.#ze;return this.#le.send("Input.dispatchMouseEvent",{type:"mouseMoved",modifiers:this.#Pn._modifiers,buttons:r,button:En(r),...o})}))}async down(e={}){const{button:t=vn.Left,clickCount:r=1}=e,i=Tn(t);if(!i)throw new Error(`Unsupported mouse button: ${t}`);if(this.#ze.buttons&i)throw new Error(`'${t}' is already pressed.`);await this.#On((e=>{e({buttons:this.#ze.buttons|i});const{buttons:n,position:s}=this.#ze;return this.#le.send("Input.dispatchMouseEvent",{type:"mousePressed",modifiers:this.#Pn._modifiers,clickCount:r,buttons:n,button:t,...s})}))}async up(e={}){const{button:t=vn.Left,clickCount:r=1}=e,i=Tn(t);if(!i)throw new Error(`Unsupported mouse button: ${t}`);if(!(this.#ze.buttons&i))throw new Error(`'${t}' is not pressed.`);await this.#On((e=>{e({buttons:this.#ze.buttons&~i});const{buttons:n,position:s}=this.#ze;return this.#le.send("Input.dispatchMouseEvent",{type:"mouseReleased",modifiers:this.#Pn._modifiers,clickCount:r,buttons:n,button:t,...s})}))}async click(e,t,r={}){const{delay:i,count:n=1,clickCount:s=n}=r;if(n<1)throw new Error("Click must occur a positive number of times.");const a=[this.move(e,t)];if(s===n)for(let e=1;e<n;++e)a.push(this.down({...r,clickCount:e}),this.up({...r,clickCount:e}));a.push(this.down({...r,clickCount:s})),"number"==typeof i&&(await Promise.all(a),a.length=0,await new Promise((e=>{setTimeout(e,i)}))),a.push(this.up({...r,clickCount:s})),await Promise.all(a)}async wheel(e={}){const{deltaX:t=0,deltaY:r=0}=e,{position:i,buttons:n}=this.#ze;await this.#le.send("Input.dispatchMouseEvent",{type:"mouseWheel",pointerType:"mouse",modifiers:this.#Pn._modifiers,deltaY:r,deltaX:t,buttons:n,...i})}async drag(e,t){const r=new Promise((e=>{this.#le.once("Input.dragIntercepted",(t=>e(t.data)))}));return await this.move(e.x,e.y),await this.down(),await this.move(t.x,t.y),await r}async dragEnter(e,t){await this.#le.send("Input.dispatchDragEvent",{type:"dragEnter",x:e.x,y:e.y,modifiers:this.#Pn._modifiers,data:t})}async dragOver(e,t){await this.#le.send("Input.dispatchDragEvent",{type:"dragOver",x:e.x,y:e.y,modifiers:this.#Pn._modifiers,data:t})}async drop(e,t){await this.#le.send("Input.dispatchDragEvent",{type:"drop",x:e.x,y:e.y,modifiers:this.#Pn._modifiers,data:t})}async dragAndDrop(e,t,r={}){const{delay:i=null}=r,n=await this.drag(e,t);await this.dragEnter(t,n),await this.dragOver(t,n),i&&await new Promise((e=>setTimeout(e,i))),await this.drop(t,n),await this.up()}}class xn extends kn{#le;#Pn;constructor(e,t){super(),this.#le=e,this.#Pn=t}updateClient(e){this.#le=e}async touchStart(e,t){await this.#le.send("Input.dispatchTouchEvent",{type:"touchStart",touchPoints:[{x:Math.round(e),y:Math.round(t),radiusX:.5,radiusY:.5}],modifiers:this.#Pn._modifiers})}async touchMove(e,t){await this.#le.send("Input.dispatchTouchEvent",{type:"touchMove",touchPoints:[{x:Math.round(e),y:Math.round(t),radiusX:.5,radiusY:.5}],modifiers:this.#Pn._modifiers})}async touchEnd(){await this.#le.send("Input.dispatchTouchEvent",{type:"touchEnd",touchPoints:[],modifiers:this.#Pn._modifiers})}}class Fn{#le;#Nn=!1;#Bn;constructor(e){this.#le=e}updateClient(e){this.#le=e}async start(e={}){et(!this.#Nn,"Cannot start recording trace while already recording trace.");const t=["-*","devtools.timeline","v8.execute","disabled-by-default-devtools.timeline","disabled-by-default-devtools.timeline.frame","toplevel","blink.console","blink.user_timing","latencyInfo","disabled-by-default-devtools.timeline.stack","disabled-by-default-v8.cpu_profiler"],{path:r,screenshots:i=!1,categories:n=t}=e;i&&n.push("disabled-by-default-devtools.screenshot");const s=n.filter((e=>e.startsWith("-"))).map((e=>e.slice(1))),a=n.filter((e=>!e.startsWith("-")));this.#Bn=r,this.#Nn=!0,await this.#le.send("Tracing.start",{transferMode:"ReturnAsStream",traceConfig:{excludedCategories:s,includedCategories:a}})}async stop(){const e=jt.create();return this.#le.once("Tracing.tracingComplete",(async t=>{try{et(t.stream,'Missing "stream"');const r=await It(this.#le,t.stream),i=await Et(r,this.#Bn);e.resolve(i??void 0)}catch(t){tt(t)?e.reject(t):e.reject(new Error(`Unknown error: ${t}`))}})),await this.#le.send("Tracing.end"),this.#Nn=!1,await e.valueOrThrow()}}class Rn extends Xe{timeoutSettings=new Wt;#Pt;#le;#Ce;constructor(e,t,r,i){super(),this.#le=e,this.#Ce=t,this.#Pt=new Gi(this,new Wt),this.#le.once("Runtime.executionContextCreated",(async t=>{this.#Pt.setContext(new Ri(e,t.context,this.#Pt))})),this.#le.on("Runtime.consoleAPICalled",(async e=>{try{return r(e.type,e.args.map((e=>new Ti(this.#Pt,e))),e.stackTrace)}catch(e){pt(e)}})),this.#le.on("Runtime.exceptionThrown",i),this.#le.send("Runtime.enable").catch(pt)}mainRealm(){return this.#Pt}url(){return this.#Ce}get client(){return this.#le}async evaluate(e,...t){return e=wt(this.evaluate.name,e),await this.mainRealm().evaluate(e,...t)}async evaluateHandle(e,...t){return e=wt(this.evaluateHandle.name,e),await this.mainRealm().evaluateHandle(e,...t)}}var _n=self&&self.__addDisposableResource||function(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t},Dn=self&&self.__disposeResources||function(e){return function(t){function r(r){t.error=t.hasError?new e(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}return function e(){for(;t.stack.length;){var i=t.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(e,(function(t){return r(t),e()}))}catch(e){r(e)}}if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i});class Pn extends mr{static async _create(e,t,r,i){const n=new Pn(e,t,r);if(await n.#Ln(),i)try{await n.setViewport(i)}catch(e){if(!tt(e)||!Or(e))throw e;pt(e)}return n}#xe=!1;#jn;#Hn;#$n;#Kn;#Vn;#Pn;#Un;#Wn;#zn;#Mt;#Gn;#Qn;#yr=new Map;#Jn=new Map;#Xn;#Yn;#Zn=new Map;#es=new Set;#ts=jt.create();#rs=!1;#is=!1;#ns=[[Xi.FrameAttached,e=>{this.emit("frameattached",e)}],[Xi.FrameDetached,e=>{this.emit("framedetached",e)}],[Xi.FrameNavigated,e=>{this.emit("framenavigated",e)}]];#ss=[[Bt.Request,e=>{this.emit("request",e)}],[Bt.RequestServedFromCache,e=>{this.emit("requestservedfromcache",e)}],[Bt.Response,e=>{this.emit("response",e)}],[Bt.RequestFailed,e=>{this.emit("requestfailed",e)}],[Bt.RequestFinished,e=>{this.emit("requestfinished",e)}]];#as=[[Ot.Disconnected,()=>{this.#ts.reject(new ht("Target closed"))}],["Page.domContentEventFired",()=>this.emit("domcontentloaded",void 0)],["Page.loadEventFired",()=>this.emit("load",void 0)],["Runtime.consoleAPICalled",this.#os.bind(this)],["Runtime.bindingCalled",this.#gr.bind(this)],["Page.javascriptDialogOpening",this.#cs.bind(this)],["Runtime.exceptionThrown",this.#ls.bind(this)],["Inspector.targetCrashed",this.#ds.bind(this)],["Performance.metrics",this.#us.bind(this)],["Log.entryAdded",this.#hs.bind(this)],["Page.fileChooserOpened",this.#ps.bind(this)]];constructor(e,t,r){super(),this.#Hn=e,this.#Kn=e.parentSession(),et(this.#Kn,"Tab target session is not defined."),this.#Vn=this.#Kn._target(),et(this.#Vn,"Tab target is not defined."),this.#$n=t,this.#jn=t._targetManager(),this.#Pn=new Sn(e),this.#Un=new In(e,this.#Pn),this.#Wn=new xn(e,this.#Pn),this.#zn=new Sr(e),this.#Mt=new gn(e,this,r,this._timeoutSettings),this.#Gn=new zr(e),this.#Qn=new Fn(e),this.#Xn=new Nr(e),this.#Yn=null;for(const[e,t]of this.#ns)this.#Mt.on(e,t);for(const[e,t]of this.#ss)this.#Mt.networkManager.on(e,t);this.#Kn.on(Ot.Swapped,this.#fs.bind(this)),this.#Kn.on(Ot.Ready,this.#ys.bind(this)),this.#jn.on("targetGone",this.#ms),this.#Vn._isClosedDeferred.valueOrThrow().then((()=>{this.#jn.off("targetGone",this.#ms),this.emit("close",void 0),this.#xe=!0})).catch(pt),this.#gs()}async#fs(e){this.#Hn=e,et(this.#Hn instanceof Vt,"CDPSession is not instance of CDPSessionImpl"),this.#$n=this.#Hn._target(),et(this.#$n,"Missing target on swap"),this.#Pn.updateClient(e),this.#Un.updateClient(e),this.#Wn.updateClient(e),this.#zn.updateClient(e),this.#Gn.updateClient(e),this.#Qn.updateClient(e),this.#Xn.updateClient(e),await this.#Mt.swapFrameTree(e),this.#gs()}async#ys(e){et(e instanceof Vt),"prerender"===e._target()._subtype()&&(this.#Mt.registerSpeculativeSession(e).catch(pt),this.#Gn.registerSpeculativeSession(e).catch(pt))}#gs(){this.#Hn.on(Ot.Ready,this.#Jt);for(const[e,t]of this.#as)this.#Hn.on(e,t)}#ms=e=>{const t=e._session()?.id(),r=this.#Zn.get(t);r&&(this.#Zn.delete(t),this.emit("workerdestroyed",r))};#Jt=e=>{if(et(e instanceof Vt),this.#Mt.onAttachedToTarget(e._target()),"worker"===e._target()._getTargetInfo().type){const t=new Rn(e,e._target().url(),this.#ws.bind(this),this.#ls.bind(this));this.#Zn.set(e.id(),t),this.emit("workercreated",t)}e.on(Ot.Ready,this.#Jt)};async#Ln(){try{await Promise.all([this.#Mt.initialize(this.#Hn),this.#Hn.send("Performance.enable"),this.#Hn.send("Log.enable")])}catch(e){if(!tt(e)||!Or(e))throw e;pt(e)}}async#ps(e){const t={stack:[],error:void 0,hasError:!1};try{if(!this.#es.size)return;const r=this.#Mt.frame(e.frameId);et(r,"This should never happen.");const i=_n(t,await r.worlds[Qi].adoptBackendNode(e.backendNodeId),!1),n=new Cr(i.move(),e);for(const e of this.#es)e.resolve(n);this.#es.clear()}catch(e){t.error=e,t.hasError=!0}finally{Dn(t)}}_client(){return this.#Hn}isServiceWorkerBypassed(){return this.#rs}isDragInterceptionEnabled(){return this.#is}isJavaScriptEnabled(){return this.#Gn.javascriptEnabled}async waitForFileChooser(e={}){const t=0===this.#es.size,{timeout:r=this._timeoutSettings.timeout()}=e,i=jt.create({message:`Waiting for \`FileChooser\` failed: ${r}ms exceeded`,timeout:r});let n;this.#es.add(i),t&&(n=this.#Hn.send("Page.setInterceptFileChooserDialog",{enabled:!0}));try{const[e]=await Promise.all([i.valueOrThrow(),n]);return e}catch(e){throw this.#es.delete(i),e}}async setGeolocation(e){return await this.#Gn.setGeolocation(e)}target(){return this.#$n}browser(){return this.#$n.browser()}browserContext(){return this.#$n.browserContext()}#ds(){this.emit("error",new Error("Page crashed!"))}#hs(e){const{level:t,text:r,args:i,source:n,url:s,lineNumber:a}=e.entry;i&&i.map((e=>Ei(this.#Hn,e))),"worker"!==n&&this.emit("console",new kr(t,r,[],[{url:s,lineNumber:a}]))}mainFrame(){return this.#Mt.mainFrame()}get keyboard(){return this.#Pn}get touchscreen(){return this.#Wn}get coverage(){return this.#Xn}get tracing(){return this.#Qn}get accessibility(){return this.#zn}frames(){return this.#Mt.frames()}workers(){return Array.from(this.#Zn.values())}async setRequestInterception(e){return await this.#Mt.networkManager.setRequestInterception(e)}async setBypassServiceWorker(e){return this.#rs=e,await this.#Hn.send("Network.setBypassServiceWorker",{bypass:e})}async setDragInterception(e){return this.#is=e,await this.#Hn.send("Input.setInterceptDrags",{enabled:e})}async setOfflineMode(e){return await this.#Mt.networkManager.setOfflineMode(e)}async emulateNetworkConditions(e){return await this.#Mt.networkManager.emulateNetworkConditions(e)}setDefaultNavigationTimeout(e){this._timeoutSettings.setDefaultNavigationTimeout(e)}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e)}getDefaultTimeout(){return this._timeoutSettings.timeout()}async queryObjects(e){et(!e.disposed,"Prototype JSHandle is disposed!"),et(e.id,"Prototype JSHandle must not be referencing primitive value");const t=await this.mainFrame().client.send("Runtime.queryObjects",{prototypeObjectId:e.id});return Di(this.mainFrame().mainRealm(),t.objects)}async cookies(...e){const t=(await this.#Hn.send("Network.getCookies",{urls:e.length?e:[this.url()]})).cookies,r=["priority"];return t.map((e=>{for(const t of r)delete e[t];return e}))}async deleteCookie(...e){const t=this.url();for(const r of e){const e=Object.assign({},r);!r.url&&t.startsWith("http")&&(e.url=t),await this.#Hn.send("Network.deleteCookies",e)}}async setCookie(...e){const t=this.url(),r=t.startsWith("http"),i=e.map((e=>{const i=Object.assign({},e);return!i.url&&r&&(i.url=t),et("about:blank"!==i.url,`Blank page can not have cookie "${i.name}"`),et(!String.prototype.startsWith.call(i.url||"","data:"),`Data URL page can not have cookie "${i.name}"`),i}));await this.deleteCookie(...i),i.length&&await this.#Hn.send("Network.setCookies",{cookies:i})}async exposeFunction(e,t){if(this.#yr.has(e))throw new Error(`Failed to add page binding with name ${e}: window['${e}'] already exists!`);let r;if("function"==typeof t)r=new Pr(e,t);else r=new Pr(e,t.default);this.#yr.set(e,r);const i=function(e,t){return kt(Ct,e,t)}("exposedFun",e);await this.#Hn.send("Runtime.addBinding",{name:e});const{identifier:n}=await this.#Hn.send("Page.addScriptToEvaluateOnNewDocument",{source:i});this.#Jn.set(e,n),await Promise.all(this.frames().map((e=>e.evaluate(i).catch(pt))))}async removeExposedFunction(e){const t=this.#Jn.get(e);if(!t)throw new Error(`Failed to remove page binding with name ${e}: window['${e}'] does not exists!`);await this.#Hn.send("Runtime.removeBinding",{name:e}),await this.removeScriptToEvaluateOnNewDocument(t),await Promise.all(this.frames().map((t=>t.evaluate((e=>{globalThis[e]=void 0}),e).catch(pt)))),this.#Jn.delete(e),this.#yr.delete(e)}async authenticate(e){return await this.#Mt.networkManager.authenticate(e)}async setExtraHTTPHeaders(e){return await this.#Mt.networkManager.setExtraHTTPHeaders(e)}async setUserAgent(e,t){return await this.#Mt.networkManager.setUserAgent(e,t)}async metrics(){const e=await this.#Hn.send("Performance.getMetrics");return this.#vs(e.metrics)}#us(e){this.emit("metrics",{title:e.title,metrics:this.#vs(e.metrics)})}#vs(e){const t={};for(const r of e||[])Mn.has(r.name)&&(t[r.name]=r.value);return t}#ls(e){this.emit("pageerror",function(e){let t,r;if(e.exception){if(!("object"===e.exception.type&&"error"===e.exception.subtype||e.exception.objectId))return vt(e.exception);{const i=yt(e);t=i.name,r=i.message}}else t="Error",r=e.text;const i=new Error(r);i.name=t;const n=i.message.split("\n").length,s=i.stack.split("\n").splice(0,n),a=[];if(e.stackTrace)for(const t of e.stackTrace.callFrames)if(a.push(`    at ${t.functionName||"<anonymous>"} (${t.url}:${t.lineNumber+1}:${t.columnNumber+1})`),a.length>=Error.stackTraceLimit)break;return i.stack=[...s,...a].join("\n"),i}(e.exceptionDetails))}async#os(e){if(0===e.executionContextId)return;const t=this.#Mt.getExecutionContextById(e.executionContextId,this.#Hn);if(!t)return void pt(new Error(`ExecutionContext not found for a console message: ${JSON.stringify(e)}`));const r=e.args.map((e=>Di(t._world,e)));this.#ws(e.type,r,e.stackTrace)}async#gr(e){let t;try{t=JSON.parse(e.payload)}catch{return}const{type:r,name:i,seq:n,args:s,isTrivial:a}=t;if("exposedFun"!==r)return;const o=this.#Mt.executionContextById(e.executionContextId,this.#Hn);if(!o)return;const c=this.#yr.get(i);await(c?.run(o,n,s,a))}#ws(e,t,r){if(!this.listenerCount("console"))return void t.forEach((e=>e.dispose()));const i=[];for(const e of t){const t=e.remoteObject();t.objectId?i.push(e.toString()):i.push(vt(t))}const n=[];if(r)for(const e of r.callFrames)n.push({url:e.url,lineNumber:e.lineNumber,columnNumber:e.columnNumber});const s=new kr(e,i.join(" "),t,n);this.emit("console",s)}#cs(e){const t=function(e){let t=null;return new Set(["alert","confirm","prompt","beforeunload"]).has(e)&&(t=e),et(t,`Unknown javascript dialog type: ${e}`),t}(e.type),r=new $r(this.#Hn,t,e.message,e.defaultPrompt);this.emit("dialog",r)}async reload(e){const[t]=await Promise.all([this.waitForNavigation(e),this.#Hn.send("Page.reload")]);return t}async createCDPSession(){return await this.target().createCDPSession()}async waitForRequest(e,t={}){const{timeout:r=this._timeoutSettings.timeout()}=t;return await Dt(this.#Mt.networkManager,Bt.Request,e,r,this.#ts)}async waitForResponse(e,t={}){const{timeout:r=this._timeoutSettings.timeout()}=t;return await Dt(this.#Mt.networkManager,Bt.Response,e,r,this.#ts)}async waitForNetworkIdle(e={}){const{idleTime:t=Pt,timeout:r=this._timeoutSettings.timeout()}=e;await ye(this._waitForNetworkIdle(this.#Mt.networkManager,t).pipe(Ke(Ft(r),pe(this.#ts.valueOrThrow()))))}async goBack(e={}){return await this.#bs(-1,e)}async goForward(e={}){return await this.#bs(1,e)}async#bs(e,t){const r=await this.#Hn.send("Page.getNavigationHistory"),i=r.entries[r.currentIndex+e];if(!i)return null;return(await Promise.all([this.waitForNavigation(t),this.#Hn.send("Page.navigateToHistoryEntry",{entryId:i.id})]))[0]}async bringToFront(){await this.#Hn.send("Page.bringToFront")}async setJavaScriptEnabled(e){return await this.#Gn.setJavaScriptEnabled(e)}async setBypassCSP(e){await this.#Hn.send("Page.setBypassCSP",{enabled:e})}async emulateMediaType(e){return await this.#Gn.emulateMediaType(e)}async emulateCPUThrottling(e){return await this.#Gn.emulateCPUThrottling(e)}async emulateMediaFeatures(e){return await this.#Gn.emulateMediaFeatures(e)}async emulateTimezone(e){return await this.#Gn.emulateTimezone(e)}async emulateIdleState(e){return await this.#Gn.emulateIdleState(e)}async emulateVisionDeficiency(e){return await this.#Gn.emulateVisionDeficiency(e)}async setViewport(e){const t=await this.#Gn.emulateViewport(e);this.#Yn=e,t&&await this.reload()}viewport(){return this.#Yn}async evaluateOnNewDocument(e,...t){const r=kt(e,...t),{identifier:i}=await this.#Hn.send("Page.addScriptToEvaluateOnNewDocument",{source:r});return{identifier:i}}async removeScriptToEvaluateOnNewDocument(e){await this.#Hn.send("Page.removeScriptToEvaluateOnNewDocument",{identifier:e})}async setCacheEnabled(e=!0){await this.#Mt.networkManager.setCacheEnabled(e)}async _screenshot(e){const t={stack:[],error:void 0,hasError:!1};try{const{fromSurface:r,omitBackground:i,optimizeForSpeed:n,quality:s,clip:a,type:o,captureBeyondViewport:c}=e,l=this.target()._targetManager()instanceof Pi,d=_n(t,new Je,!0);l||!i||"png"!==o&&"webp"!==o||(await this.#Gn.setTransparentBackgroundColor(),d.defer((async()=>{await this.#Gn.resetDefaultBackgroundColor().catch(pt)})));let u=a;if(u&&!c){u=function(e,t){const r=Math.max(e.x,t.x),i=Math.max(e.y,t.y);return{x:r,y:i,width:Math.max(Math.min(e.x+e.width,t.x+t.width)-r,0),height:Math.max(Math.min(e.y+e.height,t.y+t.height)-i,0)}}(u,await this.mainFrame().isolatedRealm().evaluate((()=>{const{height:e,pageLeft:t,pageTop:r,width:i}=window.visualViewport;return{x:t,y:r,height:e,width:i}})))}const{data:h}=await this.#Hn.send("Page.captureScreenshot",{format:o,...n?{optimizeForSpeed:n}:{},...void 0!==s?{quality:Math.round(s)}:{},...u?{clip:{...u,scale:u.scale??1}}:{},...r?{}:{fromSurface:r},captureBeyondViewport:c});return h}catch(e){t.error=e,t.hasError=!0}finally{const e=Dn(t);e&&await e}}async createPDFStream(e={}){const{landscape:t,displayHeaderFooter:r,headerTemplate:i,footerTemplate:n,printBackground:s,scale:a,width:o,height:c,margin:l,pageRanges:d,preferCSSPageSize:u,omitBackground:h,timeout:p,tagged:f}=this._getPDFOptions(e);h&&await this.#Gn.setTransparentBackgroundColor();const y=this.#Hn.send("Page.printToPDF",{transferMode:"ReturnAsStream",landscape:t,displayHeaderFooter:r,headerTemplate:i,footerTemplate:n,printBackground:s,scale:a,paperWidth:o,paperHeight:c,marginTop:l.top,marginBottom:l.bottom,marginLeft:l.left,marginRight:l.right,pageRanges:d,preferCSSPageSize:u,generateTaggedPDF:f}),m=await ye(pe(y).pipe(Ke(Ft(p))));return h&&await this.#Gn.resetDefaultBackgroundColor(),et(m.stream,"`stream` is missing from `Page.printToPDF"),await It(this.#Hn,m.stream)}async pdf(e={}){const{path:t}=e,r=await this.createPDFStream(e),i=await Et(r,t);return et(i,"Could not create buffer"),i}async close(e={runBeforeUnload:void 0}){const t=this.#Hn.connection();et(t,"Protocol error: Connection closed. Most likely the page has been closed.");!!e.runBeforeUnload?await this.#Hn.send("Page.close"):(await t.send("Target.closeTarget",{targetId:this.#$n._targetId}),await this.#Vn._isClosedDeferred.valueOrThrow())}isClosed(){return this.#xe}get mouse(){return this.#Un}async waitForDevicePrompt(e={}){return await this.mainFrame().waitForDevicePrompt(e)}}const Mn=new Set(["Timestamp","Documents","Frames","JSEventListeners","Nodes","LayoutCount","RecalcStyleCount","LayoutDuration","RecalcStyleDuration","ScriptDuration","TaskDuration","JSHeapUsedSize","JSHeapTotalSize"]);var qn;!function(e){e.SUCCESS="success",e.ABORTED="aborted"}(qn||(qn={}));class An extends Ht{#ks;#Cs;#Ss;#jn;#Ts;_initializedDeferred=jt.create();_isClosedDeferred=jt.create();_targetId;constructor(e,t,r,i,n){super(),this.#Cs=t,this.#jn=i,this.#Ss=e,this.#ks=r,this._targetId=e.targetId,this.#Ts=n,this.#Cs&&this.#Cs instanceof Vt&&this.#Cs._setTarget(this)}_subtype(){return this.#Ss.subtype}_session(){return this.#Cs}_sessionFactory(){if(!this.#Ts)throw new Error("sessionFactory is not initialized");return this.#Ts}createCDPSession(){if(!this.#Ts)throw new Error("sessionFactory is not initialized");return this.#Ts(!1).then((e=>(e._setTarget(this),e)))}url(){return this.#Ss.url}type(){switch(this.#Ss.type){case"page":return Nt.PAGE;case"background_page":return Nt.BACKGROUND_PAGE;case"service_worker":return Nt.SERVICE_WORKER;case"shared_worker":return Nt.SHARED_WORKER;case"browser":return Nt.BROWSER;case"webview":return Nt.WEBVIEW;case"tab":return Nt.TAB;default:return Nt.OTHER}}_targetManager(){if(!this.#jn)throw new Error("targetManager is not initialized");return this.#jn}_getTargetInfo(){return this.#Ss}browser(){if(!this.#ks)throw new Error("browserContext is not initialised");return this.#ks.browser()}browserContext(){if(!this.#ks)throw new Error("browserContext is not initialised");return this.#ks}opener(){const{openerId:e}=this.#Ss;if(e)return this.browser().targets().find((t=>t._targetId===e))}_targetInfoChanged(e){this.#Ss=e,this._checkIfInitialized()}_initialize(){this._initializedDeferred.resolve(qn.SUCCESS)}_isTargetExposed(){return this.type()!==Nt.TAB&&!this._subtype()}_checkIfInitialized(){this._initializedDeferred.resolved()||this._initializedDeferred.resolve(qn.SUCCESS)}}class On extends An{#Es;pagePromise;#_i;constructor(e,t,r,i,n,s,a){super(e,t,r,i,n),this.#_i=s,this.#Es=a??void 0}_initialize(){this._initializedDeferred.valueOrThrow().then((async e=>{if(e===qn.ABORTED)return;const t=this.opener();if(!(t instanceof On))return;if(!t||!t.pagePromise||"page"!==this.type())return!0;const r=await t.pagePromise;if(!r.listenerCount("popup"))return!0;const i=await this.page();return r.emit("popup",i),!0})).catch(pt),this._checkIfInitialized()}async page(){if(!this.pagePromise){const e=this._session();this.pagePromise=(e?Promise.resolve(e):this._sessionFactory()(!1)).then((e=>Pn._create(e,this,this.#_i,this.#Es??null)))}return await this.pagePromise??null}_checkIfInitialized(){this._initializedDeferred.resolved()||""!==this._getTargetInfo().url&&this._initializedDeferred.resolve(qn.SUCCESS)}}class Nn extends On{}class Bn extends An{#Is;async worker(){if(!this.#Is){const e=this._session();this.#Is=(e?Promise.resolve(e):this._sessionFactory()(!1)).then((e=>new Rn(e,this._getTargetInfo().url,(()=>{}),(()=>{}))))}return await this.#Is}}class Ln extends An{}class jn extends Xe{#F;#Bt=new Map;#xs=new Map;#Fs=new Map;#Ht=new Set;#$t;#Kt;#Vt=new WeakMap;#Rs=new WeakMap;#Ut=jt.create();#Wt=new Set;#_s=!0;#Ds=[{}];constructor(e,t,r,i=!0){super(),this.#F=e,this.#$t=r,this.#Kt=t,this.#_s=i,this.#F.on("Target.targetCreated",this.#zt),this.#F.on("Target.targetDestroyed",this.#Gt),this.#F.on("Target.targetInfoChanged",this.#Ps),this.#F.on(Ot.SessionDetached,this.#Qt),this.#Ms(this.#F)}#qs=()=>{if(this.#_s)for(const[e,t]of this.#Bt.entries()){const r=new An(t,void 0,void 0,this,void 0);this.#$t&&!this.#$t(r)||"browser"===t.type||this.#Wt.add(e)}};async initialize(){await this.#F.send("Target.setDiscoverTargets",{discover:!0,filter:this.#Ds}),this.#qs(),await this.#F.send("Target.setAutoAttach",{waitForDebuggerOnStart:!0,flatten:!0,autoAttach:!0,filter:[{type:"page",exclude:!0},...this.#Ds]}),this.#Xt(),await this.#Ut.valueOrThrow()}dispose(){this.#F.off("Target.targetCreated",this.#zt),this.#F.off("Target.targetDestroyed",this.#Gt),this.#F.off("Target.targetInfoChanged",this.#Ps),this.#F.off(Ot.SessionDetached,this.#Qt),this.#As(this.#F)}getAvailableTargets(){return this.#xs}#Ms(e){const t=t=>{this.#Jt(e,t)};et(!this.#Vt.has(e)),this.#Vt.set(e,t),e.on("Target.attachedToTarget",t);const r=t=>this.#ms(e,t);et(!this.#Rs.has(e)),this.#Rs.set(e,r),e.on("Target.detachedFromTarget",r)}#As(e){const t=this.#Vt.get(e);t&&(e.off("Target.attachedToTarget",t),this.#Vt.delete(e)),this.#Rs.has(e)&&(e.off("Target.detachedFromTarget",this.#Rs.get(e)),this.#Rs.delete(e))}#Qt=e=>{this.#As(e)};#zt=async e=>{if(this.#Bt.set(e.targetInfo.targetId,e.targetInfo),this.emit("targetDiscovered",e.targetInfo),"browser"===e.targetInfo.type&&e.targetInfo.attached){if(this.#xs.has(e.targetInfo.targetId))return;const t=this.#Kt(e.targetInfo,void 0);t._initialize(),this.#xs.set(e.targetInfo.targetId,t)}};#Gt=e=>{const t=this.#Bt.get(e.targetId);if(this.#Bt.delete(e.targetId),this.#Xt(e.targetId),"service_worker"===t?.type&&this.#xs.has(e.targetId)){const t=this.#xs.get(e.targetId);t&&(this.emit("targetGone",t),this.#xs.delete(e.targetId))}};#Ps=e=>{if(this.#Bt.set(e.targetInfo.targetId,e.targetInfo),this.#Ht.has(e.targetInfo.targetId)||!this.#xs.has(e.targetInfo.targetId)||!e.targetInfo.attached)return;const t=this.#xs.get(e.targetInfo.targetId);if(!t)return;const r=t.url(),i=t._initializedDeferred.value()===qn.SUCCESS;if(function(e,t){return Boolean(e._subtype())&&!t.subtype}(t,e.targetInfo)){const e=t?._session();et(e,"Target that is being activated is missing a CDPSession."),e.parentSession()?.emit(Ot.Swapped,e)}t._targetInfoChanged(e.targetInfo),i&&r!==t.url()&&this.emit("targetChanged",{target:t,wasInitialized:i,previousURL:r})};#Jt=async(e,t)=>{const r=t.targetInfo,i=this.#F.session(t.sessionId);if(!i)throw new Error(`Session ${t.sessionId} was not created.`);const n=async()=>{await i.send("Runtime.runIfWaitingForDebugger").catch(pt),await e.send("Target.detachFromTarget",{sessionId:i.id()}).catch(pt)};if(!this.#F.isAutoAttached(r.targetId))return;if("service_worker"===r.type){if(this.#Xt(r.targetId),await n(),this.#xs.has(r.targetId))return;const e=this.#Kt(r);return e._initialize(),this.#xs.set(r.targetId,e),void this.emit("targetAvailable",e)}const s=this.#xs.has(r.targetId),a=s?this.#xs.get(r.targetId):this.#Kt(r,i,e instanceof Lt?e:void 0);if(this.#$t&&!this.#$t(a))return this.#Ht.add(r.targetId),this.#Xt(r.targetId),void await n();this.#Ms(i),s?(i._setTarget(a),this.#Fs.set(i.id(),this.#xs.get(r.targetId))):(a._initialize(),this.#xs.set(r.targetId,a),this.#Fs.set(i.id(),a)),e.emit(Ot.Ready,i),this.#Wt.delete(a._targetId),s||this.emit("targetAvailable",a),this.#Xt(),await Promise.all([i.send("Target.setAutoAttach",{waitForDebuggerOnStart:!0,flatten:!0,autoAttach:!0,filter:this.#Ds}),i.send("Runtime.runIfWaitingForDebugger")]).catch(pt)};#Xt(e){void 0!==e&&this.#Wt.delete(e),0===this.#Wt.size&&this.#Ut.resolve()}#ms=(e,t)=>{const r=this.#Fs.get(t.sessionId);this.#Fs.delete(t.sessionId),r&&(this.#xs.delete(r._targetId),this.emit("targetGone",r))}}class Hn extends qt{protocol="cdp";static async _create(e,t,r,i,n,s,a,o,c,l=!0){const d=new Hn(e,t,r,i,n,s,a,o,c,l);return await d._attach(),d}#_i;#Es;#Os;#F;#Ns;#$t;#Bs;#Ls;#js=new Map;#jn;constructor(e,t,r,i,n,s,a,o,c,l=!0){super(),e=e||"chrome",this.#_i=i,this.#Es=n,this.#Os=s,this.#F=t,this.#Ns=a||function(){},this.#$t=o||(()=>!0),this.#Hs(c),this.#jn="firefox"===e?new Pi(t,this.#$s,this.#$t):new jn(t,this.#$s,this.#$t,l),this.#Ls=new $n(this.#F,this);for(const e of r)this.#js.set(e,new $n(this.#F,this,e))}#Ks=()=>{this.emit("disconnected",void 0)};async _attach(){this.#F.on(Ot.Disconnected,this.#Ks),this.#jn.on("targetAvailable",this.#Jt),this.#jn.on("targetGone",this.#ms),this.#jn.on("targetChanged",this.#Vs),this.#jn.on("targetDiscovered",this.#Us),await this.#jn.initialize()}_detach(){this.#F.off(Ot.Disconnected,this.#Ks),this.#jn.off("targetAvailable",this.#Jt),this.#jn.off("targetGone",this.#ms),this.#jn.off("targetChanged",this.#Vs),this.#jn.off("targetDiscovered",this.#Us)}process(){return this.#Os??null}_targetManager(){return this.#jn}#Hs(e){this.#Bs=e||(e=>"page"===e.type()||"background_page"===e.type()||"webview"===e.type())}_getIsPageTargetCallback(){return this.#Bs}async createIncognitoBrowserContext(e={}){const{proxyServer:t,proxyBypassList:r}=e,{browserContextId:i}=await this.#F.send("Target.createBrowserContext",{proxyServer:t,proxyBypassList:r&&r.join(",")}),n=new $n(this.#F,this,i);return this.#js.set(i,n),n}browserContexts(){return[this.#Ls,...Array.from(this.#js.values())]}defaultBrowserContext(){return this.#Ls}async _disposeContext(e){e&&(await this.#F.send("Target.disposeBrowserContext",{browserContextId:e}),this.#js.delete(e))}#$s=(e,t)=>{const{browserContextId:r}=e,i=r&&this.#js.has(r)?this.#js.get(r):this.#Ls;if(!i)throw new Error("Missing browser context");const n=t=>this.#F._createSession(e,t),s=new Ln(e,t,i,this.#jn,n);return e.url?.startsWith("devtools://")?new Nn(e,t,i,this.#jn,n,this.#_i,this.#Es??null):this.#Bs(s)?new On(e,t,i,this.#jn,n,this.#_i,this.#Es??null):"service_worker"===e.type||"shared_worker"===e.type?new Bn(e,t,i,this.#jn,n):s};#Jt=async e=>{e._isTargetExposed()&&await e._initializedDeferred.valueOrThrow()===qn.SUCCESS&&(this.emit("targetcreated",e),e.browserContext().emit("targetcreated",e))};#ms=async e=>{e._initializedDeferred.resolve(qn.ABORTED),e._isClosedDeferred.resolve(),e._isTargetExposed()&&await e._initializedDeferred.valueOrThrow()===qn.SUCCESS&&(this.emit("targetdestroyed",e),e.browserContext().emit("targetdestroyed",e))};#Vs=({target:e})=>{this.emit("targetchanged",e),e.browserContext().emit("targetchanged",e)};#Us=e=>{this.emit("targetdiscovered",e)};wsEndpoint(){return this.#F.url()}async newPage(){return await this.#Ls.newPage()}async _createPageInContext(e){const{targetId:t}=await this.#F.send("Target.createTarget",{url:"about:blank",browserContextId:e||void 0}),r=await this.waitForTarget((e=>e._targetId===t));if(!r)throw new Error(`Missing target for page (id = ${t})`);if(!(await r._initializedDeferred.valueOrThrow()===qn.SUCCESS))throw new Error(`Failed to create target for page (id = ${t})`);const i=await r.page();if(!i)throw new Error(`Failed to create a page for context (id = ${e})`);return i}targets(){return Array.from(this.#jn.getAvailableTargets().values()).filter((e=>e._isTargetExposed()&&e._initializedDeferred.value()===qn.SUCCESS))}target(){const e=this.targets().find((e=>"browser"===e.type()));if(!e)throw new Error("Browser target is not found");return e}async version(){return(await this.#Ws()).product}async userAgent(){return(await this.#Ws()).userAgent}async close(){await this.#Ns.call(null),await this.disconnect()}disconnect(){return this.#jn.dispose(),this.#F.dispose(),this._detach(),Promise.resolve()}get connected(){return!this.#F._closed}#Ws(){return this.#F.send("Browser.getVersion")}}class $n extends At{#F;#zs;#k;constructor(e,t,r){super(),this.#F=e,this.#zs=t,this.#k=r}get id(){return this.#k}targets(){return this.#zs.targets().filter((e=>e.browserContext()===this))}waitForTarget(e,t={}){return this.#zs.waitForTarget((t=>t.browserContext()===this&&e(t)),t)}async pages(){return(await Promise.all(this.targets().filter((e=>"page"===e.type()||"other"===e.type()&&this.#zs._getIsPageTargetCallback()?.(e))).map((e=>e.page())))).filter((e=>!!e))}isIncognito(){return!!this.#k}async overridePermissions(e,t){const r=t.map((e=>{const t=Mt.get(e);if(!t)throw new Error("Unknown permission: "+e);return t}));await this.#F.send("Browser.grantPermissions",{origin:e,browserContextId:this.#k||void 0,permissions:r})}async clearPermissionOverrides(){await this.#F.send("Browser.resetPermissions",{browserContextId:this.#k||void 0})}newPage(){return this.#zs._createPageInContext(this.#k)}browser(){return this.#zs}async close(){et(this.#k,"Non-incognito profiles cannot be closed!"),await this.#zs._disposeContext(this.#k)}}export{Hn as Browser,Ar as Connection,Fi as ElementHandle,rn as Frame,Pn as Page,An as Target};
