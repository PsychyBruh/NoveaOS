import*as e from"../../core/common/common.js";import*as t from"../../core/host/host.js";import*as i from"../../core/i18n/i18n.js";import*as r from"../../ui/legacy/components/source_frame/source_frame.js";import*as o from"../../ui/legacy/legacy.js";import*as s from"../../core/platform/platform.js";import*as n from"../../core/sdk/sdk.js";import*as a from"../../models/logs/logs.js";import*as l from"../../ui/visual_logging/visual_logging.js";import*as d from"../../ui/legacy/components/data_grid/data_grid.js";import*as c from"../mobile_throttling/mobile_throttling.js";import*as h from"../settings/emulation/components/components.js";import*as u from"../../models/bindings/bindings.js";import*as p from"../../models/workspace/workspace.js";import*as g from"./forward/forward.js";import*as m from"../../ui/components/icon_button/icon_button.js";import*as w from"../../ui/legacy/components/perf_ui/perf_ui.js";import*as k from"../../ui/legacy/components/utils/utils.js";import{PanelUtils as b}from"../utils/utils.js";import*as v from"../../ui/components/legacy_wrapper/legacy_wrapper.js";import*as f from"./components/components.js";import*as S from"../../ui/legacy/components/cookie_table/cookie_table.js";import*as C from"../../ui/legacy/components/object_ui/object_ui.js";import*as y from"../../ui/components/data_grid/data_grid.js";import*as T from"../../ui/components/helpers/helpers.js";import*as R from"../../ui/lit-html/lit-html.js";import*as I from"../../models/text_utils/text_utils.js";import*as x from"../../core/root/root.js";import*as q from"../../models/har/har.js";import*as F from"../../models/persistence/persistence.js";import*as L from"../sources/sources.js";import*as P from"../../ui/components/adorners/adorners.js";import*as M from"../../ui/components/render_coordinator/render_coordinator.js";import*as H from"../../ui/legacy/theme_support/theme_support.js";import*as E from"../../models/trace/trace.js";import*as B from"../search/search.js";const U=new CSSStyleSheet;U.replaceSync(".panel.network .toolbar.binary-view-toolbar{border-top:1px solid var(--sys-color-divider);border-bottom:0;padding-left:5px}.binary-view-copied-text{opacity:100%}.binary-view-copied-text.fadeout{opacity:0%;transition:opacity 1s}\n/*# sourceURL=binaryResourceView.css */\n");const A={copiedAsBase:"Copied as `Base64`",hexViewer:"`Hex` Viewer",copiedAsHex:"Copied as `Hex`",copiedAsUtf:"Copied as `UTF-8`",binaryViewType:"Binary view type",copyToClipboard:"Copy to clipboard",copyAsBase:"Copy as `Base64`",copyAsHex:"Copy as `Hex`",copyAsUtf:"Copy as `UTF-8`"},N=i.i18n.registerUIStrings("panels/network/BinaryResourceView.ts",A),V=i.i18n.getLocalizedString.bind(void 0,N);class W extends o.Widget.VBox{binaryResourceViewFactory;toolbar;binaryViewObjects;binaryViewTypeSetting;binaryViewTypeCombobox;copiedText;addFadeoutSettimeoutId;lastView;constructor(t,s,n){super(),this.binaryResourceViewFactory=new r.BinaryResourceViewFactory.BinaryResourceViewFactory(t,s,n),this.toolbar=new o.Toolbar.Toolbar("binary-view-toolbar",this.element),this.binaryViewObjects=[new O("base64",i.i18n.lockedString("Base64"),V(A.copiedAsBase),this.binaryResourceViewFactory.createBase64View.bind(this.binaryResourceViewFactory),this.binaryResourceViewFactory.base64.bind(this.binaryResourceViewFactory)),new O("hex",V(A.hexViewer),V(A.copiedAsHex),this.binaryResourceViewFactory.createHexView.bind(this.binaryResourceViewFactory),this.binaryResourceViewFactory.hex.bind(this.binaryResourceViewFactory)),new O("utf8",i.i18n.lockedString("UTF-8"),V(A.copiedAsUtf),this.binaryResourceViewFactory.createUtf8View.bind(this.binaryResourceViewFactory),this.binaryResourceViewFactory.utf8.bind(this.binaryResourceViewFactory))],this.binaryViewTypeSetting=e.Settings.Settings.instance().createSetting("binaryViewType","hex"),this.binaryViewTypeCombobox=new o.Toolbar.ToolbarComboBox(this.binaryViewTypeChanged.bind(this),V(A.binaryViewType));for(const e of this.binaryViewObjects)this.binaryViewTypeCombobox.addOption(this.binaryViewTypeCombobox.createOption(e.label,e.type));this.toolbar.appendToolbarItem(this.binaryViewTypeCombobox);const a=new o.Toolbar.ToolbarButton(V(A.copyToClipboard),"copy");a.addEventListener(o.Toolbar.ToolbarButton.Events.Click,(e=>{this.copySelectedViewToClipboard()}),this),this.toolbar.appendToolbarItem(a),this.copiedText=new o.Toolbar.ToolbarText,this.copiedText.element.classList.add("binary-view-copied-text"),this.toolbar.element.appendChild(this.copiedText.element),this.addFadeoutSettimeoutId=null,this.lastView=null,this.updateView()}getCurrentViewObject(){const e=this.binaryViewObjects.find((e=>e.type===this.binaryViewTypeSetting.get()));return console.assert(Boolean(e),`No binary view found for binary view type found in setting 'binaryViewType': ${this.binaryViewTypeSetting.get()}`),e||null}async copySelectedViewToClipboard(){const e=this.getCurrentViewObject();e&&(t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText((await e.content()).content),this.copiedText.setText(e.copiedMessage),this.copiedText.element.classList.remove("fadeout"),this.addFadeoutSettimeoutId&&(clearTimeout(this.addFadeoutSettimeoutId),this.addFadeoutSettimeoutId=null),this.addFadeoutSettimeoutId=window.setTimeout(function(){this.copiedText.element.classList.add("fadeout")}.bind(this),2e3))}wasShown(){this.updateView(),this.registerCSSFiles([U])}updateView(){const e=this.getCurrentViewObject();if(!e)return;const t=e.getView();t!==this.lastView&&(this.lastView&&this.lastView.detach(),this.lastView=t,t.show(this.element,this.toolbar.element),this.binaryViewTypeCombobox.selectElement().value=this.binaryViewTypeSetting.get())}binaryViewTypeChanged(){const e=this.binaryViewTypeCombobox.selectedOption();if(!e)return;const t=e.value;this.binaryViewTypeSetting.get()!==t&&(this.binaryViewTypeSetting.set(t),this.updateView())}addCopyToContextMenu(e,i){const r=e.clipboardSection().appendSubMenuItem(i).footerSection();r.appendItem(V(A.copyAsBase),(async()=>{const e=await this.binaryResourceViewFactory.base64();t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e.content)})),r.appendItem(V(A.copyAsHex),(async()=>{const e=await this.binaryResourceViewFactory.hex();t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e.content)})),r.appendItem(V(A.copyAsUtf),(async()=>{const e=await this.binaryResourceViewFactory.utf8();t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e.content)}))}}class O{type;label;copiedMessage;content;createViewFn;view;constructor(e,t,i,r,o){this.type=e,this.label=t,this.copiedMessage=i,this.content=o,this.createViewFn=r,this.view=null}getView(){return this.view||(this.view=this.createViewFn()),this.view}}var D=Object.freeze({__proto__:null,BinaryResourceView:W,BinaryViewObject:O});const G=new CSSStyleSheet;G.replaceSync(".list{border:none!important;border-top:1px solid var(--sys-color-divider)!important}.blocking-disabled{opacity:80%}.editor-container{padding:0 4px}.no-blocked-urls,\n.blocked-urls{overflow-x:hidden;overflow-y:auto}.no-blocked-urls{display:flex;justify-content:center;padding:10px}.no-blocked-urls > span{white-space:pre}.blocked-url{display:flex;flex-direction:row;align-items:center;flex:auto}.blocked-url-count{flex:none;padding-right:9px}.blocked-url-checkbox{margin-left:8px;flex:none}.blocked-url-checkbox:focus{outline:auto 5px -webkit-focus-ring-color}.blocked-url-label{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;flex:auto;padding:0 3px}.blocked-url-edit-row{flex:none;display:flex;flex-direction:row;margin:7px 5px 0;align-items:center}.blocked-url-edit-value{user-select:none;flex:1 1 0}.blocked-url-edit-row input{width:100%;text-align:inherit;height:22px}\n/*# sourceURL=blockedURLsPane.css */\n");const z={enableNetworkRequestBlocking:"Enable network request blocking",addPattern:"Add pattern",addNetworkRequestBlockingPattern:"Add network request blocking pattern",networkRequestsAreNotBlockedS:"Network requests are not blocked. {PH1}",dBlocked:"{PH1} blocked",textPatternToBlockMatching:"Text pattern to block matching requests; use * for wildcard",patternInputCannotBeEmpty:"Pattern input cannot be empty.",patternAlreadyExists:"Pattern already exists.",itemDeleted:"Item successfully deleted"},j=i.i18n.registerUIStrings("panels/network/BlockedURLsPane.ts",z),_=i.i18n.getLocalizedString.bind(void 0,j);class K extends o.Widget.VBox{manager;toolbar;enabledCheckbox;list;editor;blockedCountForUrl;constructor(){super(!0),this.element.setAttribute("jslog",`${l.panel().context("network.blocked-urls")}`),this.manager=n.NetworkManager.MultitargetNetworkManager.instance(),this.manager.addEventListener(n.NetworkManager.MultitargetNetworkManager.Events.BlockedPatternsChanged,this.update,this),this.toolbar=new o.Toolbar.Toolbar("",this.contentElement),this.enabledCheckbox=new o.Toolbar.ToolbarCheckbox(_(z.enableNetworkRequestBlocking),void 0,this.toggleEnabled.bind(this),"network.enable-request-blocking"),this.toolbar.appendToolbarItem(this.enabledCheckbox),this.toolbar.appendSeparator(),this.toolbar.appendToolbarItem(o.Toolbar.Toolbar.createActionButtonForId("network.add-network-request-blocking-pattern")),this.toolbar.appendToolbarItem(o.Toolbar.Toolbar.createActionButtonForId("network.remove-all-network-request-blocking-patterns")),this.list=new o.ListWidget.ListWidget(this),this.list.element.classList.add("blocked-urls"),this.list.setEmptyPlaceholder(this.createEmptyPlaceholder()),this.list.show(this.contentElement),this.editor=null,this.blockedCountForUrl=new Map,n.TargetManager.TargetManager.instance().addModelListener(n.NetworkManager.NetworkManager,n.NetworkManager.Events.RequestFinished,this.onRequestFinished,this,{scoped:!0}),this.update(),a.NetworkLog.NetworkLog.instance().addEventListener(a.NetworkLog.Events.Reset,this.onNetworkLogReset,this)}createEmptyPlaceholder(){const e=this.contentElement.createChild("div","no-blocked-urls"),t=o.UIUtils.createTextButton(_(z.addPattern),this.addPattern.bind(this),"add-button",!0);return t.setAttribute("jslog",`${l.action().track({click:!0}).context("network.add-network-request-blocking-pattern")}`),o.ARIAUtils.setLabel(t,_(z.addNetworkRequestBlockingPattern)),e.appendChild(i.i18n.getFormatLocalizedString(j,z.networkRequestsAreNotBlockedS,{PH1:t})),e}addPattern(){this.manager.setBlockingEnabled(!0),this.list.addNewItem(0,{url:s.DevToolsPath.EmptyUrlString,enabled:!0})}removeAllPatterns(){this.manager.setBlockedPatterns([])}renderItem(e,t){const i=this.blockedRequestsCount(e.url),r=document.createElement("div");r.classList.add("blocked-url");const o=r.createChild("input","blocked-url-checkbox");return o.type="checkbox",o.checked=e.enabled,o.disabled=!t,o.setAttribute("jslog",`${l.toggle().track({change:!0})}`),r.createChild("div","blocked-url-label").textContent=e.url,r.createChild("div","blocked-url-count").textContent=_(z.dBlocked,{PH1:i}),t&&(r.addEventListener("click",(t=>this.togglePattern(e,t))),o.addEventListener("click",(t=>this.togglePattern(e,t)))),r}togglePattern(e,t){t.consume(!0);const i=this.manager.blockedPatterns();i.splice(i.indexOf(e),1,{enabled:!e.enabled,url:e.url}),this.manager.setBlockedPatterns(i)}toggleEnabled(){this.manager.setBlockingEnabled(!this.manager.blockingEnabled()),this.update()}removeItemRequested(e,t){const i=this.manager.blockedPatterns();i.splice(t,1),this.manager.setBlockedPatterns(i),o.ARIAUtils.alert(z.itemDeleted)}beginEdit(e){return this.editor=this.createEditor(),this.editor.control("url").value=e.url,this.editor}commitEdit(e,t,i){const r=t.control("url").value,o=this.manager.blockedPatterns();i?o.push({enabled:!0,url:r}):o.splice(o.indexOf(e),1,{enabled:!0,url:r}),this.manager.setBlockedPatterns(o)}createEditor(){if(this.editor)return this.editor;const e=new o.ListWidget.Editor,t=e.contentElement();t.createChild("div","blocked-url-edit-row").createChild("div").textContent=_(z.textPatternToBlockMatching);const i=t.createChild("div","blocked-url-edit-row"),r=e.createInput("url","text","",((e,t,i)=>{let r,o=!0;return i.value?this.manager.blockedPatterns().find((e=>e.url===i.value))&&(r=_(z.patternAlreadyExists),o=!1):(r=_(z.patternInputCannotBeEmpty),o=!1),{valid:o,errorMessage:r}}));return i.createChild("div","blocked-url-edit-value").appendChild(r),e}update(){const e=this.manager.blockingEnabled();this.list.element.classList.toggle("blocking-disabled",!e&&Boolean(this.manager.blockedPatterns().length)),this.enabledCheckbox.setChecked(e),this.list.clear();for(const t of this.manager.blockedPatterns())this.list.appendItem(t,e)}blockedRequestsCount(e){if(!e)return 0;let t=0;for(const i of this.blockedCountForUrl.keys())this.matches(e,i)&&(t+=this.blockedCountForUrl.get(i));return t}matches(e,t){let i=0;const r=e.split("*");for(let e=0;e<r.length;e++){const o=r[e];if(o.length){if(i=t.indexOf(o,i),-1===i)return!1;i+=o.length}}return!0}onNetworkLogReset(e){this.blockedCountForUrl.clear(),this.update()}onRequestFinished(e){const t=e.data;if(t.wasBlocked()){const e=this.blockedCountForUrl.get(t.url())||0;this.blockedCountForUrl.set(t.url(),e+1),this.update()}}wasShown(){o.Context.Context.instance().setFlavor(K,this),super.wasShown(),this.list.registerCSSFiles([G]),this.registerCSSFiles([G])}willHide(){super.willHide(),o.Context.Context.instance().setFlavor(K,null)}}var $=Object.freeze({__proto__:null,BlockedURLsPane:K,ActionDelegate:class{handleAction(e,t){const i=e.flavor(K);if(null===i)return!1;switch(t){case"network.add-network-request-blocking-pattern":return i.addPattern(),!0;case"network.remove-all-network-request-blocking-patterns":return i.removeAllPatterns(),!0}return!1}}});const X=new CSSStyleSheet;X.replaceSync(".event-source-messages-view .data-grid{flex:auto;border:none}\n/*# sourceURL=eventSourceMessagesView.css */\n");const Y={id:"Id",type:"Type",data:"Data",time:"Time",eventSource:"Event Source",copyMessage:"Copy message"},J=i.i18n.registerUIStrings("panels/network/EventSourceMessagesView.ts",Y),Q=i.i18n.getLocalizedString.bind(void 0,J);class Z extends o.Widget.VBox{request;dataGrid;constructor(e){super(),this.element.classList.add("event-source-messages-view"),this.element.setAttribute("jslog",`${l.pane().context("event-stream")}`),this.request=e;const t=[{id:"id",title:Q(Y.id),sortable:!0,weight:8},{id:"type",title:Q(Y.type),sortable:!0,weight:8},{id:"data",title:Q(Y.data),sortable:!1,weight:88},{id:"time",title:Q(Y.time),sortable:!0,weight:8}];this.dataGrid=new d.SortableDataGrid.SortableDataGrid({displayName:Q(Y.eventSource),columns:t,editCallback:void 0,deleteCallback:void 0,refreshCallback:void 0}),this.dataGrid.setStriped(!0),this.dataGrid.setStickToBottom(!0),this.dataGrid.setRowContextMenuCallback(this.onRowContextMenu.bind(this)),this.dataGrid.markColumnAsSortedBy("time",d.DataGrid.Order.Ascending),this.sortItems(),this.dataGrid.addEventListener(d.DataGrid.Events.SortingChanged,this.sortItems,this),this.dataGrid.setName("EventSourceMessagesView"),this.dataGrid.asWidget().show(this.element)}wasShown(){this.dataGrid.rootNode().removeChildren(),this.registerCSSFiles([X]);const e=this.request.eventSourceMessages();for(let t=0;t<e.length;++t)this.dataGrid.insertChild(new ee(e[t]));this.request.addEventListener(n.NetworkRequest.Events.EventSourceMessageAdded,this.messageAdded,this)}willHide(){this.request.removeEventListener(n.NetworkRequest.Events.EventSourceMessageAdded,this.messageAdded,this)}messageAdded(e){const t=e.data;this.dataGrid.insertChild(new ee(t))}sortItems(){const e=this.dataGrid.sortColumnId();if(!e)return;const t=ie[e];t&&this.dataGrid.sortNodes(t,!this.dataGrid.isSortOrderAscending())}onRowContextMenu(e,i){e.clipboardSection().appendItem(Q(Y.copyMessage),t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText.bind(t.InspectorFrontendHost.InspectorFrontendHostInstance,i.data.data))}}class ee extends d.SortableDataGrid.SortableDataGridNode{message;constructor(e){const t=new Date(1e3*e.time),i=("0"+t.getHours()).substr(-2)+":"+("0"+t.getMinutes()).substr(-2)+":"+("0"+t.getSeconds()).substr(-2)+"."+("00"+t.getMilliseconds()).substr(-3),r=document.createElement("div");o.UIUtils.createTextChild(r,i),o.Tooltip.Tooltip.install(r,t.toLocaleString()),super({id:e.eventId,type:e.eventName,data:e.data,time:r}),this.message=e}}function te(e,t,i){const r=e(t.message),o=e(i.message);return r<o?-1:r>o?1:0}const ie={id:te.bind(null,(e=>e.eventId)),type:te.bind(null,(e=>e.eventName)),time:te.bind(null,(e=>e.time))};var re=Object.freeze({__proto__:null,EventSourceMessagesView:Z,EventSourceMessageNode:ee,EventSourceMessageNodeComparator:te,Comparators:ie});const oe=new CSSStyleSheet;oe.replaceSync('.network-config{padding:12px;display:block}.network-config-group{display:flex;padding-bottom:10px;flex-wrap:wrap;flex:0 0 auto;min-height:30px}.network-config-title{margin-right:16px;width:130px}.network-config-fields{flex:2 0 200px}.panel-section-separator{height:1px;margin-bottom:10px;background:var(--sys-color-divider)}.network-config-disable-cache{line-height:28px;border-top:none;padding-top:0}.network-config-input-validation-error{color:var(--sys-color-error);margin:5px 0}.network-config-input-validation-error:empty{display:none}.network-config-throttling .chrome-select{width:100%;max-width:250px}.network-config-throttling > .network-config-title{line-height:24px}.network-config-ua > .network-config-title{line-height:20px}.network-config-ua span[is="dt-radio"].checked > *{display:none}.network-config-ua input{display:block;width:calc(100% - 20px)}.network-config-ua input[type="text"],\n.network-config-ua .chrome-select{margin-top:8px}.network-config-ua .chrome-select{width:calc(100% - 20px);max-width:250px}.network-config-ua span[is="dt-radio"]{display:block}.network-config-ua-custom{opacity:50%;padding-bottom:8px}.network-config-ua-custom.checked{opacity:100%}.client-hints-form{margin-top:14px;width:min(100%,400px)}.status-text{padding:10px;color:var(--sys-color-tertiary)}\n/*# sourceURL=networkConfigView.css */\n');const se={custom:"Custom...",enterACustomUserAgent:"Enter a custom user agent",customUserAgentFieldIsRequired:"Custom user agent field is required",caching:"Caching",disableCache:"Disable cache",networkThrottling:"Network throttling",userAgent:"User agent",selectAutomatically:"Use browser default",acceptedEncoding:"Accepted `Content-Encoding`s",clientHintsStatusText:"User agent updated.",networkConditionsPanelShown:"Network conditions shown"},ne=i.i18n.registerUIStrings("panels/network/NetworkConfigView.ts",se),ae=i.i18n.getLocalizedString.bind(void 0,ne);let le;class de extends o.Widget.VBox{constructor(){super(!0),this.element.setAttribute("jslog",`${l.panel().context("network-conditions")}`),this.contentElement.classList.add("network-config"),this.createCacheSection(),this.contentElement.createChild("div").classList.add("panel-section-separator"),this.createNetworkThrottlingSection(),this.contentElement.createChild("div").classList.add("panel-section-separator"),this.createUserAgentSection(),this.contentElement.createChild("div").classList.add("panel-section-separator"),this.createAcceptedEncodingSection()}static instance(e={forceNew:null}){const{forceNew:t}=e;return le&&!t||(le=new de),le}static createUserAgentSelectAndInput(t){const i=e.Settings.Settings.instance().createSetting("customUserAgent",""),r=e.Settings.Settings.instance().createSetting("customUserAgentMetadata",null),s=document.createElement("select");s.setAttribute("jslog",`${l.dropDown().track({change:!0}).context(i.name)}`),o.ARIAUtils.setLabel(s,t);const a={title:ae(se.custom),value:"custom"};s.appendChild(new Option(a.title,a.value));for(const e of he){const t=s.createChild("optgroup");t.label=e.title;for(const i of e.values){const e=n.NetworkManager.MultitargetNetworkManager.patchUserAgentWithChromeVersion(i.value);t.appendChild(new Option(i.title,e))}}s.selectedIndex=0;const d=o.UIUtils.createInput("","text");d.setAttribute("jslog",`${l.textField().track({keydown:!0}).context(i.name)}`),d.value=i.get(),o.Tooltip.Tooltip.install(d,i.get()),d.placeholder=ae(se.enterACustomUserAgent),d.required=!0,o.ARIAUtils.setLabel(d,d.placeholder);const c=document.createElement("div");function h(){const e=i.get(),t=s.options;let r=!1;for(let i=0;i<t.length;++i)if(t[i].value===e){s.selectedIndex=i,r=!0;break}r||(s.selectedIndex=0)}return c.classList.add("network-config-input-validation-error"),o.ARIAUtils.markAsAlert(c),d.value||(c.textContent=ae(se.customUserAgentFieldIsRequired)),h(),s.addEventListener("change",(function(){const e=s.options[s.selectedIndex].value;if(e!==a.value){i.set(e),d.value=e,o.Tooltip.Tooltip.install(d,e);const t=ce(e);r.set(t),n.NetworkManager.MultitargetNetworkManager.instance().setCustomUserAgentOverride(e,t)}else r.set(null),d.select();c.textContent="";const t=new CustomEvent("user-agent-change",{detail:{value:e}});s.dispatchEvent(t)}),!1),d.addEventListener("input",(function(){i.get()!==d.value&&(d.value?c.textContent="":c.textContent=ae(se.customUserAgentFieldIsRequired),i.set(d.value),o.Tooltip.Tooltip.install(d,d.value),h())}),!1),{select:s,input:d,error:c}}createSection(e,t){const i=this.contentElement.createChild("section","network-config-group");return t&&i.classList.add(t),i.createChild("div","network-config-title").textContent=e,i.createChild("div","network-config-fields")}createCacheSection(){this.createSection(ae(se.caching),"network-config-disable-cache").appendChild(o.SettingsUI.createSettingCheckbox(ae(se.disableCache),e.Settings.Settings.instance().moduleSetting("cacheDisabled"),!0))}createNetworkThrottlingSection(){const e=ae(se.networkThrottling),t=this.createSection(e,"network-config-throttling").createChild("select","chrome-select");c.ThrottlingManager.throttlingManager().decorateSelectWithNetworkThrottling(t),o.ARIAUtils.setLabel(t,e)}createUserAgentSection(){const t=e.Settings.Settings.instance().createSetting("customUserAgentMetadata",null),i=e.Settings.Settings.instance().createSetting("customUserAgent",""),r=ae(se.userAgent),s=this.createSection(r,"network-config-ua"),a=o.UIUtils.CheckboxLabel.create(ae(se.selectAutomatically),!0,void 0,i.name);s.appendChild(a);const l=a.checkboxElement;i.addChangeListener((()=>{if(l.checked)return;const e=i.get(),t=ce(e);n.NetworkManager.MultitargetNetworkManager.instance().setCustomUserAgentOverride(e,t)}));const d=s.createChild("div","network-config-ua-custom");l.addEventListener("change",k);const c=de.createUserAgentSelectAndInput(r);c.select.classList.add("chrome-select"),d.appendChild(c.select),d.appendChild(c.input),d.appendChild(c.error);const u=d.createChild("div","client-hints-form"),p=new h.UserAgentClientHintsForm.UserAgentClientHintsForm,g=t.get(),m=ce(c.select.value);p.value={showMobileCheckbox:!0,showSubmitButton:!0,metaData:g||m||void 0},u.appendChild(p),c.select.addEventListener("user-agent-change",(e=>{const t=e.detail.value,i=t?ce(t):null;p.value={metaData:i||void 0,showMobileCheckbox:!0,showSubmitButton:!0},w.textContent=""})),p.addEventListener("clienthintschange",(()=>{c.select.value="custom",w.textContent=""})),p.addEventListener("clienthintssubmit",(e=>{const r=e.detail.value,o=i.get();t.set(r),n.NetworkManager.MultitargetNetworkManager.instance().setCustomUserAgentOverride(o,r),w.textContent=ae(se.clientHintsStatusText)}));const w=s.createChild("span","status-text");function k(){const e=!l.checked;d.classList.toggle("checked",e),c.select.disabled=!e,c.input.disabled=!e,c.error.hidden=!e,p.disabled=!e;const t=e?i.get():"",r=e?ce(t):null;n.NetworkManager.MultitargetNetworkManager.instance().setCustomUserAgentOverride(t,r)}w.textContent="",k()}createAcceptedEncodingSection(){const t=e.Settings.Settings.instance().createSetting("useCustomAcceptedEncodings",!1),i=e.Settings.Settings.instance().createSetting("customAcceptedEncodings","gzip,br,deflate"),r=ae(se.acceptedEncoding),s=this.createSection(r,"network-config-accepted-encoding"),a=o.UIUtils.CheckboxLabel.create(ae(se.selectAutomatically),!0,void 0,t.name);s.appendChild(a);const d=a.checkboxElement;function c(){t.get()?n.NetworkManager.MultitargetNetworkManager.instance().setCustomAcceptedEncodingsOverride(""===i.get()?[]:i.get().split(",")):n.NetworkManager.MultitargetNetworkManager.instance().clearCustomAcceptedEncodingsOverride()}i.addChangeListener(c),t.addChangeListener(c);const h=s.createChild("div","network-config-accepted-encoding-custom");h.setAttribute("jslog",`${l.section().context(i.name)}`),d.checked=!t.get(),d.addEventListener("change",g);const u=new Map,p={Deflate:"deflate",Gzip:"gzip",Br:"br",Zstd:"zstd"};for(const e of Object.values(p)){const t=o.UIUtils.CheckboxLabel.create(e,!0,void 0,e);h.appendChild(t),u.set(e,t.checkboxElement)}for(const[e,t]of u)t.checked=i.get().includes(e),t.addEventListener("change",g);function g(){t.set(!d.checked);const e=[];for(const[t,i]of u)i.disabled=d.checked,i.checked&&e.push(t);i.set(e.join(","))}g()}wasShown(){super.wasShown(),this.registerCSSFiles([oe]),o.ARIAUtils.alert(ae(se.networkConditionsPanelShown))}}function ce(e){for(const t of he)for(const i of t.values)if(e===n.NetworkManager.MultitargetNetworkManager.patchUserAgentWithChromeVersion(i.value))return i.metadata?(n.NetworkManager.MultitargetNetworkManager.patchUserAgentMetadataWithChromeVersion(i.metadata),i.metadata):null;return null}const he=[{title:"Android",values:[{title:"Android (4.0.2) Browser — Galaxy Nexus",value:"Mozilla/5.0 (Linux; U; Android 4.0.2; en-us; Galaxy Nexus Build/ICL53F) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"4.0.2",architecture:"",model:"Galaxy Nexus",mobile:!0}},{title:"Android (2.3) Browser — Nexus S",value:"Mozilla/5.0 (Linux; U; Android 2.3.6; en-us; Nexus S Build/GRK39F) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"2.3.6",architecture:"",model:"Nexus S",mobile:!0}}]},{title:"BlackBerry",values:[{title:"BlackBerry — BB10",value:"Mozilla/5.0 (BB10; Touch) AppleWebKit/537.1+ (KHTML, like Gecko) Version/10.0.0.1337 Mobile Safari/537.1+",metadata:null},{title:"BlackBerry — PlayBook 2.1",value:"Mozilla/5.0 (PlayBook; U; RIM Tablet OS 2.1.0; en-US) AppleWebKit/536.2+ (KHTML, like Gecko) Version/7.2.1.0 Safari/536.2+",metadata:null},{title:"BlackBerry — 9900",value:"Mozilla/5.0 (BlackBerry; U; BlackBerry 9900; en-US) AppleWebKit/534.11+ (KHTML, like Gecko) Version/7.0.0.187 Mobile Safari/534.11+",metadata:null}]},{title:"Chrome",values:[{title:"Chrome — Android Mobile",value:"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Mobile Safari/537.36",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"6.0",architecture:"",model:"Nexus 5",mobile:!0}},{title:"Chrome — Android Mobile (high-end)",value:"Mozilla/5.0 (Linux; Android 10; Pixel 4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Mobile Safari/537.36",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"10",architecture:"",model:"Pixel 4",mobile:!0}},{title:"Chrome — Android Tablet",value:"Mozilla/5.0 (Linux; Android 4.3; Nexus 7 Build/JSS15Q) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Safari/537.36",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"4.3",architecture:"",model:"Nexus 7",mobile:!0}},{title:"Chrome — iPhone",value:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/%s Mobile/15E148 Safari/604.1",metadata:null},{title:"Chrome — iPad",value:"Mozilla/5.0 (iPad; CPU OS 13_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/%s Mobile/15E148 Safari/604.1",metadata:null},{title:"Chrome — Chrome OS",value:"Mozilla/5.0 (X11; CrOS x86_64 10066.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Safari/537.36",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Chrome OS",platformVersion:"10066.0.0",architecture:"x86",model:"",mobile:!1}},{title:"Chrome — Mac",value:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Safari/537.36",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"macOS",platformVersion:"10_14_6",architecture:"x86",model:"",mobile:!1}},{title:"Chrome — Windows",value:"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Safari/537.36",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Google Chrome",version:"%s"}],fullVersion:"%s",platform:"Windows",platformVersion:"10.0",architecture:"x86",model:"",mobile:!1}}]},{title:"Firefox",values:[{title:"Firefox — Android Mobile",value:"Mozilla/5.0 (Android 4.4; Mobile; rv:70.0) Gecko/70.0 Firefox/70.0",metadata:null},{title:"Firefox — Android Tablet",value:"Mozilla/5.0 (Android 4.4; Tablet; rv:70.0) Gecko/70.0 Firefox/70.0",metadata:null},{title:"Firefox — iPhone",value:"Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) FxiOS/1.0 Mobile/12F69 Safari/600.1.4",metadata:null},{title:"Firefox — iPad",value:"Mozilla/5.0 (iPad; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) FxiOS/1.0 Mobile/12F69 Safari/600.1.4",metadata:null},{title:"Firefox — Mac",value:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:70.0) Gecko/20100101 Firefox/70.0",metadata:null},{title:"Firefox — Windows",value:"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:70.0) Gecko/20100101 Firefox/70.0",metadata:null}]},{title:"Googlebot",values:[{title:"Googlebot",value:"Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)",metadata:null},{title:"Googlebot Desktop",value:"Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko; compatible; Googlebot/2.1; +http://www.google.com/bot.html) Chrome/%s Safari/537.36",metadata:null},{title:"Googlebot Smartphone",value:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5X Build/MMB29P) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Mobile Safari/537.36 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)",metadata:null}]},{title:"Internet Explorer",values:[{title:"Internet Explorer 11",value:"Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko",metadata:null},{title:"Internet Explorer 10",value:"Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; WOW64; Trident/6.0)",metadata:null},{title:"Internet Explorer 9",value:"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)",metadata:null},{title:"Internet Explorer 8",value:"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)",metadata:null},{title:"Internet Explorer 7",value:"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)",metadata:null}]},{title:"Microsoft Edge",values:[{title:"Microsoft Edge (Chromium) — Windows",value:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/%s Safari/537.36 Edg/%s",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Microsoft Edge",version:"%s"}],fullVersion:"%s",platform:"Windows",platformVersion:"10.0",architecture:"x86",model:"",mobile:!1}},{title:"Microsoft Edge (Chromium) — Mac",value:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Chrome/%s Safari/604.1 Edg/%s",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Microsoft Edge",version:"%s"}],fullVersion:"%s",platform:"macOS",platformVersion:"10_14_6",architecture:"x86",model:"",mobile:!1}},{title:"Microsoft Edge — iPhone",value:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.1.1 EdgiOS/44.5.0.10 Mobile/15E148 Safari/604.1",metadata:null},{title:"Microsoft Edge — iPad",value:"Mozilla/5.0 (iPad; CPU OS 12_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 EdgiOS/44.5.2 Mobile/15E148 Safari/605.1.15",metadata:null},{title:"Microsoft Edge — Android Mobile",value:"Mozilla/5.0 (Linux; Android 8.1.0; Pixel Build/OPM4.171019.021.D1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.109 Mobile Safari/537.36 EdgA/42.0.0.2057",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Microsoft Edge",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"8.1.0",architecture:"",model:"Pixel",mobile:!0}},{title:"Microsoft Edge — Android Tablet",value:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 7 Build/MOB30X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.109 Safari/537.36 EdgA/42.0.0.2057",metadata:{brands:[{brand:"Not A;Brand",version:"99"},{brand:"Chromium",version:"%s"},{brand:"Microsoft Edge",version:"%s"}],fullVersion:"%s",platform:"Android",platformVersion:"6.0.1",architecture:"",model:"Nexus 7",mobile:!0}},{title:"Microsoft Edge (EdgeHTML) — Windows",value:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.19042",metadata:null},{title:"Microsoft Edge (EdgeHTML) — XBox",value:"Mozilla/5.0 (Windows NT 10.0; Win64; x64; Xbox; Xbox One) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.19041",metadata:null}]},{title:"Opera",values:[{title:"Opera — Mac",value:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.97 Safari/537.36 OPR/65.0.3467.48",metadata:null},{title:"Opera — Windows",value:"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.97 Safari/537.36 OPR/65.0.3467.48",metadata:null},{title:"Opera (Presto) — Mac",value:"Opera/9.80 (Macintosh; Intel Mac OS X 10.9.1) Presto/2.12.388 Version/12.16",metadata:null},{title:"Opera (Presto) — Windows",value:"Opera/9.80 (Windows NT 6.1) Presto/2.12.388 Version/12.16",metadata:null},{title:"Opera Mobile — Android Mobile",value:"Opera/12.02 (Android 4.1; Linux; Opera Mobi/ADR-1111101157; U; en-US) Presto/2.9.201 Version/12.02",metadata:null},{title:"Opera Mini — iOS",value:"Opera/9.80 (iPhone; Opera Mini/8.0.0/34.2336; U; en) Presto/2.8.119 Version/11.10",metadata:null}]},{title:"Safari",values:[{title:"Safari — iPad iOS 13.2",value:"Mozilla/5.0 (iPad; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1",metadata:null},{title:"Safari — iPhone iOS 13.2",value:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1",metadata:null},{title:"Safari — Mac",value:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Safari/605.1.15",metadata:null}]},{title:"UC Browser",values:[{title:"UC Browser — Android Mobile",value:"Mozilla/5.0 (Linux; U; Android 8.1.0; en-US; Nexus 6P Build/OPM7.181205.001) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 UCBrowser/12.11.1.1197 Mobile Safari/537.36",metadata:null},{title:"UC Browser — iOS",value:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_1 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/16B92 UCBrowser/12.1.7.1109 Mobile AliApp(TUnionSDK/0.1.20.3)",metadata:null},{title:"UC Browser — Windows Phone",value:"Mozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0; ARM; Touch; NOKIA; Lumia 920) UCBrowser/10.1.0.563 Mobile",metadata:null}]}];var ue=Object.freeze({__proto__:null,NetworkConfigView:de,userAgentGroups:he});const pe={redirect:"Redirect",sPreflight:"{PH1} + Preflight",preflight:"Preflight",selectPreflightRequest:"Select preflight request",failed:"(failed)",data:"(data)",canceled:"(canceled)",other:"other",csp:"csp",origin:"origin",devtools:"devtools",blockeds:"(blocked:{PH1})",blockedTooltip:"This request was blocked due to misconfigured response headers, click to view the headers",corsError:"CORS error",crossoriginResourceSharingErrorS:"Cross-Origin Resource Sharing error: {PH1}",finished:"Finished",pendingq:"(pending)",unknown:"(unknown)",unknownExplanation:"The request status cannot be shown here because the page that issued it unloaded while the request was in flight. You can use chrome://net-export to capture a network log and see all request details.",push:"Push / ",parser:"Parser",script:"Script",preload:"Preload",signedexchange:"signed-exchange",selectTheRequestThatTriggered:"Select the request that triggered this preflight",otherC:"Other",memoryCache:"(memory cache)",servedFromMemoryCacheResource:"Served from memory cache, resource size: {PH1}",serviceWorker:"(`ServiceWorker`)",servedFromServiceWorkerResource:"Served from `ServiceWorker`, resource size: {PH1}",servedFromSignedHttpExchange:"Served from Signed HTTP Exchange, resource size: {PH1}",servedFromWebBundle:"Served from Web Bundle, resource size: {PH1}",prefetchCache:"(prefetch cache)",servedFromPrefetchCacheResource:"Served from prefetch cache, resource size: {PH1}",diskCache:"(disk cache)",servedFromDiskCacheResourceSizeS:"Served from disk cache, resource size: {PH1}",serviceWorkerRouter:"(`ServiceWorker router`)",matchedToServiceWorkerRouter:"Matched to `ServiceWorker router`#{PH1}, resource size: {PH2}",pending:"Pending",level:"level 1",webBundleError:"Web Bundle error",webBundleInnerRequest:"Served from Web Bundle",webBundle:"(Web Bundle)",timeSubtitleTooltipText:"Latency (response received time - start time)",alternativeJobWonWithoutRace:"`Chrome` used a `HTTP/3` connection induced by an '`Alt-Svc`' header without racing against establishing a connection using a different `HTTP` version.",alternativeJobWonRace:"`Chrome` used a `HTTP/3` connection induced by an '`Alt-Svc`' header because it won a race against establishing a connection using a different `HTTP` version.",mainJobWonRace:"`Chrome` used this protocol because it won a race against establishing a `HTTP/3` connection.",mappingMissing:"`Chrome` did not use an alternative `HTTP` version because no alternative protocol information was available when the request was issued, but an '`Alt-Svc`' header was present in the response.",broken:"`Chrome` did not try to establish a `HTTP/3` connection because it was marked as broken.",dnsAlpnH3JobWonWithoutRace:"`Chrome` used a `HTTP/3` connection due to the `DNS record` indicating `HTTP/3` support. There was no race against establishing a connection using a different `HTTP` version.",dnsAlpnH3JobWonRace:"`Chrome` used a `HTTP/3` connection due to the `DNS record` indicating `HTTP/3` support, which won a race against establishing a connection using a different `HTTP` version.",requestContentHeadersOverridden:"Both request content and headers are overridden",requestContentOverridden:"Request content is overridden",requestHeadersOverridden:"Request headers are overridden",initialPriorityToolTip:"{PH1}, Initial priority: {PH2}",thirdPartyPhaseout:"Cookies for this request are blocked due to third-party cookie phaseout. Learn more in the Issues tab."},ge=i.i18n.registerUIStrings("panels/network/NetworkDataGridNode.ts",pe),me=i.i18n.getLocalizedString.bind(void 0,ge);var we;!function(e){e.RequestSelected="RequestSelected",e.RequestActivated="RequestActivated"}(we||(we={}));class ke extends d.SortableDataGrid.SortableDataGridNode{parentViewInternal;isHovered;showingInitiatorChainInternal;requestOrFirstKnownChildRequestInternal;constructor(e){super({}),this.parentViewInternal=e,this.isHovered=!1,this.showingInitiatorChainInternal=!1,this.requestOrFirstKnownChildRequestInternal=null}displayName(){return""}displayType(){return""}createCell(e){const t=this.createTD(e);return this.renderCell(t,e),t}renderCell(e,t){}isFailed(){return!1}backgroundColor(){const e=be,t=document.hasFocus(),i=this.dataGrid&&this.dataGrid.element===document.activeElement,r=this.isFailed();return this.selected&&t&&i&&r?e.FocusSelectedHasError:this.selected&&t&&i?e.FocusSelected:this.selected?e.Selected:this.hovered()?e.Hovered:this.isOnInitiatorPath()?e.InitiatorPath:this.isOnInitiatedPath()?e.InitiatedPath:this.isStriped()?e.Stripe:e.Default}updateBackgroundColor(){const e=this.existingElement();e&&(e.style.backgroundColor=`var(${this.backgroundColor()})`,this.parentViewInternal.stylesChanged())}setStriped(e){super.setStriped(e),this.updateBackgroundColor()}select(e){super.select(e),this.updateBackgroundColor(),this.parentViewInternal.updateNodeSelectedClass(!0)}deselect(e){super.deselect(e),this.updateBackgroundColor(),this.parentViewInternal.updateNodeSelectedClass(!1)}parentView(){return this.parentViewInternal}hovered(){return this.isHovered}showingInitiatorChain(){return this.showingInitiatorChainInternal}nodeSelfHeight(){return this.parentViewInternal.rowHeight()}setHovered(e,t){this.isHovered===e&&this.showingInitiatorChainInternal===t||(this.isHovered!==e&&(this.isHovered=e,this.attached()&&this.element().classList.toggle("hover",e)),this.showingInitiatorChainInternal!==t&&(this.showingInitiatorChainInternal=t,this.showingInitiatorChainChanged()),this.parentViewInternal.stylesChanged(),this.updateBackgroundColor())}showingInitiatorChainChanged(){}isOnInitiatorPath(){return!1}isOnInitiatedPath(){return!1}request(){return null}isNavigationRequest(){return!1}clearFlatNodes(){super.clearFlatNodes(),this.requestOrFirstKnownChildRequestInternal=null}requestOrFirstKnownChildRequest(){if(this.requestOrFirstKnownChildRequestInternal)return this.requestOrFirstKnownChildRequestInternal;let e=this.request();if(e||!this.hasChildren())return this.requestOrFirstKnownChildRequestInternal=e,this.requestOrFirstKnownChildRequestInternal;let t=null;const i=this.flatChildren();for(let r=0;r<i.length;r++)e=i[r].request(),(!t||e&&e.issueTime()<t.issueTime())&&(t=e);return this.requestOrFirstKnownChildRequestInternal=t,this.requestOrFirstKnownChildRequestInternal}}const be={Default:"--color-grid-default",Stripe:"--color-grid-stripe",Navigation:"--network-grid-navigation-color",Hovered:"--color-grid-hovered",InitiatorPath:"--network-grid-initiator-path-color",InitiatedPath:"--network-grid-initiated-path-color",Selected:"--color-grid-selected",FocusSelected:"--color-grid-focus-selected",FocusSelectedHasError:"--network-grid-focus-selected-color-has-error",FromFrame:"--network-grid-from-frame-color"};class ve extends ke{nameCell;initiatorCell;requestInternal;isNavigationRequestInternal;selectable;isOnInitiatorPathInternal;isOnInitiatedPathInternal;linkifiedInitiatorAnchor;constructor(e,t){super(e),this.nameCell=null,this.initiatorCell=null,this.requestInternal=t,this.isNavigationRequestInternal=!1,this.selectable=!0,this.isOnInitiatorPathInternal=!1,this.isOnInitiatedPathInternal=!1}static NameComparator(e,t){const i=e.displayName().toLowerCase(),r=t.displayName().toLowerCase();if(i===r){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();return i&&r?i.identityCompare(r):i?-1:1}return i<r?-1:1}static RemoteAddressComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;const o=i.remoteAddress(),s=r.remoteAddress();return o>s?1:s>o?-1:i.identityCompare(r)}static SizeComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();return i&&r?r.cached()&&!i.cached()?1:i.cached()&&!r.cached()?-1:i.transferSize-r.transferSize||i.resourceSize-r.resourceSize||i.identityCompare(r):i?1:-1}static TypeComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;const o=e.displayType(),s=t.displayType();return o>s?1:s>o?-1:i.identityCompare(r)}static InitiatorComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;const o=e instanceof ve&&e.initiatorCell,s=t instanceof ve&&t.initiatorCell;if(!o||!s)return o?1:-1;const n=e,a=t,l=n.linkifiedInitiatorAnchor?n.linkifiedInitiatorAnchor.textContent||"":n.initiatorCell.title,d=a.linkifiedInitiatorAnchor?a.linkifiedInitiatorAnchor.textContent||"":a.initiatorCell.title;return l.localeCompare(d)}static InitiatorAddressSpaceComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;const o=i.clientSecurityState(),s=r.clientSecurityState();return o&&s?o.initiatorIPAddressSpace.localeCompare(s.initiatorIPAddressSpace):o?1:-1}static RemoteAddressSpaceComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();return i&&r?i.remoteAddressSpace().localeCompare(r.remoteAddressSpace()):i?1:-1}static RequestCookiesCountComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;return i.includedRequestCookies().length-r.includedRequestCookies().length||i.identityCompare(r)}static ResponseCookiesCountComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;return(i.responseCookies?i.responseCookies.length:0)-(r.responseCookies?r.responseCookies.length:0)||i.identityCompare(r)}static PriorityComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;const o=i.priority();let s=o?w.NetworkPriorities.networkPriorityWeight(o):0;s=s||0;const n=r.priority();let a=n?w.NetworkPriorities.networkPriorityWeight(n):0;return a=a||0,s-a||i.identityCompare(r)}static RequestPropertyComparator(e,t,i){const r=t.requestOrFirstKnownChildRequest(),o=i.requestOrFirstKnownChildRequest();if(!r||!o)return r?1:-1;const s=r[e],n=o[e];return s===n?r.identityCompare(o):s>n?1:-1}static RequestURLComparator(e,t){const i=e.requestOrFirstKnownChildRequest(),r=t.requestOrFirstKnownChildRequest();if(!i||!r)return i?1:-1;const o=i.url(),s=r.url();return o===s?i.identityCompare(r):o>s?1:-1}static ResponseHeaderStringComparator(e,t,i){const r=t.requestOrFirstKnownChildRequest(),o=i.requestOrFirstKnownChildRequest();if(!r||!o)return r?1:-1;const s=String(r.responseHeaderValue(e)||""),n=String(o.responseHeaderValue(e)||"");return s.localeCompare(n)||r.identityCompare(o)}static ResponseHeaderNumberComparator(e,t,i){const r=t.requestOrFirstKnownChildRequest(),o=i.requestOrFirstKnownChildRequest();if(!r||!o)return r?1:-1;const s=r.responseHeaderValue(e),n=void 0!==s?parseFloat(s):-1/0,a=o.responseHeaderValue(e),l=void 0!==a?parseFloat(a):-1/0;return n===l?r.identityCompare(o):n>l?1:-1}static ResponseHeaderDateComparator(e,t,i){const r=t.requestOrFirstKnownChildRequest(),o=i.requestOrFirstKnownChildRequest();if(!r||!o)return r?1:-1;const s=r.responseHeaderValue(e),n=o.responseHeaderValue(e),a=s?new Date(s).getTime():-1/0,l=n?new Date(n).getTime():-1/0;return a===l?r.identityCompare(o):a>l?1:-1}showingInitiatorChainChanged(){const e=this.showingInitiatorChain(),t=a.NetworkLog.NetworkLog.instance().initiatorGraphForRequest(this.requestInternal);for(const i of t.initiators){if(i===this.requestInternal)continue;const t=this.parentView().nodeForRequest(i);t&&t.setIsOnInitiatorPath(e)}for(const i of t.initiated.keys()){if(i===this.requestInternal)continue;const t=this.parentView().nodeForRequest(i);t&&t.setIsOnInitiatedPath(e)}}setIsOnInitiatorPath(e){this.isOnInitiatorPathInternal!==e&&this.attached()&&(this.isOnInitiatorPathInternal=e,this.updateBackgroundColor())}isOnInitiatorPath(){return this.isOnInitiatorPathInternal}setIsOnInitiatedPath(e){this.isOnInitiatedPathInternal!==e&&this.attached()&&(this.isOnInitiatedPathInternal=e,this.updateBackgroundColor())}isOnInitiatedPath(){return this.isOnInitiatedPathInternal}displayType(){const t=this.requestInternal.mimeType||this.requestInternal.requestContentType()||"",i=this.requestInternal.resourceType();let r=i.name();return i!==e.ResourceType.resourceTypes.Other&&i!==e.ResourceType.resourceTypes.Image||(r=t.replace(/^(application|image)\//,"")),this.requestInternal.isRedirect()&&(r+=" / "+me(pe.redirect)),r}displayName(){return this.requestInternal.name()}request(){return this.requestInternal}isNavigationRequest(){const e=n.PageLoad.PageLoad.forRequest(this.requestInternal);return!!e&&e.mainRequest===this.requestInternal}nodeSelfHeight(){return this.parentView().rowHeight()}createCells(e){this.nameCell=null,this.initiatorCell=null,e.classList.toggle("network-error-row",this.isFailed()),e.classList.toggle("network-navigation-row",this.isNavigationRequestInternal),super.createCells(e),this.updateBackgroundColor()}setTextAndTitle(e,t,i){o.UIUtils.createTextChild(e,t),o.Tooltip.Tooltip.install(e,i||t)}setTextAndTitleAsLink(e,t,i,r){const s=document.createElement("span");s.classList.add("devtools-link"),s.textContent=t,s.addEventListener("click",r),e.appendChild(s),o.Tooltip.Tooltip.install(e,i)}renderCell(e,t){const i=e;switch(t){case"name":this.renderPrimaryCell(i,t);break;case"path":this.renderPrimaryCell(i,t,this.requestInternal.pathname);break;case"url":this.renderPrimaryCell(i,t,this.requestInternal.url());break;case"method":{const e=this.requestInternal.preflightRequest();e?(this.setTextAndTitle(i,`${this.requestInternal.requestMethod} + `,me(pe.sPreflight,{PH1:this.requestInternal.requestMethod})),i.appendChild(k.Linkifier.Linkifier.linkifyRevealable(e,me(pe.preflight),void 0,me(pe.selectPreflightRequest)))):this.setTextAndTitle(i,this.requestInternal.requestMethod);break}case"status":this.renderStatusCell(i);break;case"protocol":this.renderProtocolCell(i);break;case"scheme":this.setTextAndTitle(i,this.requestInternal.scheme);break;case"domain":this.setTextAndTitle(i,this.requestInternal.domain);break;case"remoteaddress":this.setTextAndTitle(i,this.requestInternal.remoteAddress());break;case"remoteaddress-space":this.renderAddressSpaceCell(i,this.requestInternal.remoteAddressSpace());break;case"cookies":this.setTextAndTitle(i,this.arrayLength(this.requestInternal.includedRequestCookies()));break;case"setcookies":this.setTextAndTitle(i,this.arrayLength(this.requestInternal.nonBlockedResponseCookies()));break;case"priority":{const e=this.requestInternal.priority(),t=this.requestInternal.initialPriority();e&&t?this.setTextAndTitle(i,w.NetworkPriorities.uiLabelForNetworkPriority(e),me(pe.initialPriorityToolTip,{PH1:w.NetworkPriorities.uiLabelForNetworkPriority(e),PH2:w.NetworkPriorities.uiLabelForNetworkPriority(t)})):this.setTextAndTitle(i,e?w.NetworkPriorities.uiLabelForNetworkPriority(e):""),this.appendSubtitle(i,t?w.NetworkPriorities.uiLabelForNetworkPriority(t):"");break}case"connectionid":this.setTextAndTitle(i,"0"===this.requestInternal.connectionId?"":this.requestInternal.connectionId);break;case"type":this.setTextAndTitle(i,this.displayType());break;case"initiator":this.renderInitiatorCell(i);break;case"initiator-address-space":{const e=this.requestInternal.clientSecurityState();this.renderAddressSpaceCell(i,e?e.initiatorIPAddressSpace:"Unknown");break}case"size":this.renderSizeCell(i);break;case"time":this.renderTimeCell(i);break;case"timeline":this.setTextAndTitle(i,"");break;case"has-overrides":this.setTextAndTitle(i,this.requestInternal.overrideTypes.join(", "));break;default:this.setTextAndTitle(i,this.requestInternal.responseHeaderValue(t)||"")}}arrayLength(e){return e?String(e.length):""}select(e){super.select(e),this.parentView().dispatchEventToListeners(we.RequestSelected,this.requestInternal)}highlightMatchedSubstring(e){if(!e||!this.nameCell||null===this.nameCell.textContent)return[];this.element();const t=[],i=this.nameCell.textContent.match(e);return i&&o.UIUtils.highlightSearchResult(this.nameCell,i.index||0,i[0].length,t),t}openInNewTab(){t.InspectorFrontendHost.InspectorFrontendHostInstance.openInNewTab(this.requestInternal.url())}isFailed(){if(this.requestInternal.failed&&!this.requestInternal.statusCode)return!0;if(this.requestInternal.statusCode>=400)return!0;const e=this.requestInternal.signedExchangeInfo();return!(null===e||!Boolean(e.errors))||(!(!this.requestInternal.webBundleInfo()?.errorMessage&&!this.requestInternal.webBundleInnerRequestInfo()?.errorMessage)||!!this.requestInternal.corsErrorStatus())}renderPrimaryCell(e,t,i){if(0===(0|this.dataGrid?.indexOfVisibleColumn(t))){const t=this.leftPadding?this.leftPadding+"px":"";e.style.setProperty("padding-left",t),e.tabIndex=-1,this.nameCell=e,e.addEventListener("dblclick",this.openInNewTab.bind(this),!1),e.addEventListener("mousedown",(()=>{this.select(),this.parentView().dispatchEventToListeners(we.RequestActivated,{showPanel:!0})})),e.addEventListener("focus",(()=>this.parentView().resetFocus()));const i=this.getIcon(this.requestInternal);e.appendChild(i)}if("name"===t){const t=this.requestInternal.webBundleInnerRequestInfo();if(t){const i={iconName:"bundle",color:"var(--icon-info)"},r=this.createIconElement(i,me(pe.webBundleInnerRequest));r.classList.add("icon");const o=n.NetworkManager.NetworkManager.forRequest(this.requestInternal);t.bundleRequestId&&o?e.appendChild(k.Linkifier.Linkifier.linkifyRevealable(new g.NetworkRequestId.NetworkRequestId(t.bundleRequestId,o),r)):e.appendChild(r)}const i=s.StringUtilities.trimMiddle(this.requestInternal.name(),100),r=n.NetworkManager.NetworkManager.forRequest(this.requestInternal);o.UIUtils.createTextChild(e,r?r.target().decorateLabel(i):i),this.appendSubtitle(e,this.requestInternal.path()),this.requestInternal.url().startsWith("data")||o.Tooltip.Tooltip.install(e,this.requestInternal.url())}else i&&o.UIUtils.createTextChild(e,i)}createIconElement(e,t){const i=document.createElement("div");return i.title=t,i.style.setProperty("-webkit-mask",`url('${new URL(`../../Images/${e.iconName}.svg`,import.meta.url).toString()}')  no-repeat center /99%`),i.style.setProperty("background-color",e.color),i}getIcon(t){let i,r=t.resourceType();if(this.isFailed()){const e={iconName:"cross-circle-filled",color:"var(--icon-error)"};return i=this.createIconElement(e,r.title()),i.classList.add("icon"),i}if(t.hasThirdPartyCookiePhaseoutIssue()){const e={iconName:"warning-filled",color:"var(--icon-warning)"};return i=this.createIconElement(e,me(pe.thirdPartyPhaseout)),i.classList.add("icon"),i}const o=t.hasOverriddenHeaders(),s=t.hasOverriddenContent;if(o||s){const e={iconName:"document",color:"var(--icon-default)"};let t;t=me(o&&s?pe.requestContentHeadersOverridden:s?pe.requestContentOverridden:pe.requestHeadersOverridden);const r=this.createIconElement(e,t);return r.classList.add("icon"),i=document.createElement("div"),i.classList.add("network-override-marker"),i.appendChild(r),i}const n=e.ResourceType.ResourceType.fromMimeType(t.mimeType);if(n!==r&&n!==e.ResourceType.resourceTypes.Other&&(r===e.ResourceType.resourceTypes.Fetch||n===e.ResourceType.resourceTypes.Image||r===e.ResourceType.resourceTypes.Other&&n===e.ResourceType.resourceTypes.Script)&&(r=n),r===e.ResourceType.resourceTypes.Image){const e=document.createElement("img");return e.classList.add("image-network-icon-preview"),e.alt=t.resourceType().title(),t.populateImageSource(e),i=document.createElement("div"),i.classList.add("image","icon"),i.appendChild(e),i}if(r!==e.ResourceType.resourceTypes.Manifest&&"application/json"===e.ResourceType.ResourceType.simplifyContentType(t.mimeType)){const e={iconName:"file-json",color:"var(--icon-file-script)"};return i=this.createIconElement(e,t.resourceType().title()),i.classList.add("icon"),i}const a=b.iconDataForResourceType(r);return i=this.createIconElement(a,t.resourceType().title()),i.classList.add("icon"),i}renderStatusCell(e){e.classList.toggle("network-dim-cell",!this.isFailed()&&(this.requestInternal.cached()||!this.requestInternal.statusCode));const t=this.requestInternal.corsErrorStatus(),r=this.requestInternal.webBundleInfo()?.errorMessage||this.requestInternal.webBundleInnerRequestInfo()?.errorMessage;if(r)this.setTextAndTitle(e,me(pe.webBundleError),r);else if(!this.requestInternal.failed||this.requestInternal.canceled||this.requestInternal.wasBlocked()||t)if(this.requestInternal.statusCode&&this.requestInternal.statusCode>=400){const t=this.requestInternal.getInferredStatusText();o.UIUtils.createTextChild(e,String(this.requestInternal.statusCode)),this.appendSubtitle(e,t),o.Tooltip.Tooltip.install(e,this.requestInternal.statusCode+" "+t)}else if(!this.requestInternal.statusCode&&this.requestInternal.parsedURL.isDataURL())this.setTextAndTitle(e,me(pe.data));else if(!this.requestInternal.statusCode&&this.requestInternal.canceled)this.setTextAndTitle(e,me(pe.canceled));else if(this.requestInternal.wasBlocked()){let t=me(pe.other),r=!1;switch(this.requestInternal.blockedReason()){case"other":t=me(pe.other);break;case"csp":t=me(pe.csp);break;case"mixed-content":t=i.i18n.lockedString("mixed-content");break;case"origin":t=me(pe.origin);break;case"inspector":t=me(pe.devtools);break;case"subresource-filter":t=i.i18n.lockedString("subresource-filter");break;case"content-type":t=i.i18n.lockedString("content-type");break;case"coep-frame-resource-needs-coep-header":r=!0,t=i.i18n.lockedString("CoepFrameResourceNeedsCoepHeader");break;case"coop-sandboxed-iframe-cannot-navigate-to-coop-page":r=!0,t=i.i18n.lockedString("CoopSandboxedIframeCannotNavigateToCoopPage");break;case"corp-not-same-origin":r=!0,t=i.i18n.lockedString("NotSameOrigin");break;case"corp-not-same-site":r=!0,t=i.i18n.lockedString("NotSameSite");break;case"corp-not-same-origin-after-defaulted-to-same-origin-by-coep":r=!0,t=i.i18n.lockedString("NotSameOriginAfterDefaultedToSameOriginByCoep")}r?this.setTextAndTitleAsLink(e,me(pe.blockeds,{PH1:t}),me(pe.blockedTooltip),(()=>{this.parentView().dispatchEventToListeners(we.RequestActivated,{showPanel:!0,tab:g.UIRequestLocation.UIRequestTabs.HeadersComponent})})):this.setTextAndTitle(e,me(pe.blockeds,{PH1:t}))}else if(t)this.setTextAndTitle(e,me(pe.corsError),me(pe.crossoriginResourceSharingErrorS,{PH1:t.corsError}));else if(this.requestInternal.statusCode){o.UIUtils.createTextChild(e,String(this.requestInternal.statusCode));const t=this.requestInternal.getInferredStatusText();this.appendSubtitle(e,t),o.Tooltip.Tooltip.install(e,this.requestInternal.statusCode+" "+t)}else this.requestInternal.finished?this.setTextAndTitle(e,me(pe.finished)):this.requestInternal.preserved?this.setTextAndTitle(e,me(pe.unknown),me(pe.unknownExplanation)):this.setTextAndTitle(e,me(pe.pendingq));else{const t=me(pe.failed);this.requestInternal.localizedFailDescription?(o.UIUtils.createTextChild(e,t),this.appendSubtitle(e,this.requestInternal.localizedFailDescription,!0),o.Tooltip.Tooltip.install(e,t+" "+this.requestInternal.localizedFailDescription)):this.setTextAndTitle(e,t)}}renderProtocolCell(e){switch(o.UIUtils.createTextChild(e,this.requestInternal.protocol),this.requestInternal.alternateProtocolUsage){case"alternativeJobWonWithoutRace":o.Tooltip.Tooltip.install(e,pe.alternativeJobWonWithoutRace);break;case"alternativeJobWonRace":o.Tooltip.Tooltip.install(e,pe.alternativeJobWonRace);break;case"mainJobWonRace":o.Tooltip.Tooltip.install(e,pe.mainJobWonRace);break;case"mappingMissing":o.Tooltip.Tooltip.install(e,pe.mappingMissing);break;case"broken":o.Tooltip.Tooltip.install(e,pe.broken);break;case"dnsAlpnH3JobWonWithoutRace":o.Tooltip.Tooltip.install(e,pe.dnsAlpnH3JobWonWithoutRace);break;case"dnsAlpnH3JobWonRace":o.Tooltip.Tooltip.install(e,pe.dnsAlpnH3JobWonRace);break;default:o.Tooltip.Tooltip.install(e,this.requestInternal.protocol)}}#e(){if(this.requestInternal.resourceType().isStyleSheet())return t.UserMetrics.Action.StyleSheetInitiatorLinkClicked}renderInitiatorCell(e){this.initiatorCell=e;const t=this.requestInternal,i=a.NetworkLog.NetworkLog.instance().initiatorInfoForRequest(t),r=t.timing;switch(r&&r.pushStart&&e.appendChild(document.createTextNode(me(pe.push))),i.type){case n.NetworkRequest.InitiatorType.Parser:{const t=p.Workspace.WorkspaceImpl.instance().uiSourceCodeForURL(i.url),r=t?.displayName(),o=void 0!==r&&void 0!==i.lineNumber?`${r}:${i.lineNumber}`:void 0;e.appendChild(k.Linkifier.Linkifier.linkifyURL(i.url,{text:o,lineNumber:i.lineNumber,columnNumber:i.columnNumber,userMetric:this.#e()})),this.appendSubtitle(e,me(pe.parser));break}case n.NetworkRequest.InitiatorType.Redirect:{o.Tooltip.Tooltip.install(e,i.url);const r=t.redirectSource();console.assert(null!==r),this.parentView().nodeForRequest(r)?e.appendChild(k.Linkifier.Linkifier.linkifyRevealable(r,u.ResourceUtils.displayNameForURL(r.url()))):e.appendChild(k.Linkifier.Linkifier.linkifyURL(r.url())),this.appendSubtitle(e,me(pe.redirect));break}case n.NetworkRequest.InitiatorType.Script:{const r=n.NetworkManager.NetworkManager.forRequest(t)?.target()||null,s=this.parentView().linkifier();i.stack?this.linkifiedInitiatorAnchor=s.linkifyStackTraceTopFrame(r,i.stack):this.linkifiedInitiatorAnchor=s.linkifyScriptLocation(r,i.scriptId,i.url,i.lineNumber,{columnNumber:i.columnNumber,inlineFrameIndex:0}),o.Tooltip.Tooltip.install(this.linkifiedInitiatorAnchor,""),e.appendChild(this.linkifiedInitiatorAnchor),this.appendSubtitle(e,me(pe.script)),e.classList.add("network-script-initiated");break}case n.NetworkRequest.InitiatorType.Preload:o.Tooltip.Tooltip.install(e,me(pe.preload)),e.classList.add("network-dim-cell"),e.appendChild(document.createTextNode(me(pe.preload)));break;case n.NetworkRequest.InitiatorType.SignedExchange:e.appendChild(k.Linkifier.Linkifier.linkifyURL(i.url)),this.appendSubtitle(e,me(pe.signedexchange));break;case n.NetworkRequest.InitiatorType.Preflight:if(e.appendChild(document.createTextNode(me(pe.preflight))),i.initiatorRequest){const t=m.Icon.create("arrow-up-down-circle"),r=k.Linkifier.Linkifier.linkifyRevealable(i.initiatorRequest,t,void 0,me(pe.selectTheRequestThatTriggered),"trailing-link-icon");o.ARIAUtils.setLabel(r,me(pe.selectTheRequestThatTriggered)),e.appendChild(r)}break;default:o.Tooltip.Tooltip.install(e,me(pe.otherC)),e.classList.add("network-dim-cell"),e.appendChild(document.createTextNode(me(pe.otherC)))}}renderAddressSpaceCell(e,t){"Unknown"!==t&&o.UIUtils.createTextChild(e,t)}renderSizeCell(e){const t=s.NumberUtilities.bytesToString(this.requestInternal.resourceSize);if(this.requestInternal.cachedInMemory())o.UIUtils.createTextChild(e,me(pe.memoryCache)),o.Tooltip.Tooltip.install(e,me(pe.servedFromMemoryCacheResource,{PH1:t})),e.classList.add("network-dim-cell");else if(this.requestInternal.serviceWorkerRouterInfo){const i=this.requestInternal.serviceWorkerRouterInfo.ruleIdMatched;o.UIUtils.createTextChild(e,me(pe.serviceWorkerRouter)),o.Tooltip.Tooltip.install(e,me(pe.matchedToServiceWorkerRouter,{PH1:i,PH2:t})),e.classList.add("network-dim-cell")}else if(this.requestInternal.fetchedViaServiceWorker)o.UIUtils.createTextChild(e,me(pe.serviceWorker)),o.Tooltip.Tooltip.install(e,me(pe.servedFromServiceWorkerResource,{PH1:t})),e.classList.add("network-dim-cell");else if(this.requestInternal.redirectSourceSignedExchangeInfoHasNoErrors())o.UIUtils.createTextChild(e,i.i18n.lockedString("(signed-exchange)")),o.Tooltip.Tooltip.install(e,me(pe.servedFromSignedHttpExchange,{PH1:t})),e.classList.add("network-dim-cell");else if(this.requestInternal.webBundleInnerRequestInfo())o.UIUtils.createTextChild(e,me(pe.webBundle)),o.Tooltip.Tooltip.install(e,me(pe.servedFromWebBundle,{PH1:t})),e.classList.add("network-dim-cell");else if(this.requestInternal.fromPrefetchCache())o.UIUtils.createTextChild(e,me(pe.prefetchCache)),o.Tooltip.Tooltip.install(e,me(pe.servedFromPrefetchCacheResource,{PH1:t})),e.classList.add("network-dim-cell");else if(this.requestInternal.cached())o.UIUtils.createTextChild(e,me(pe.diskCache)),o.Tooltip.Tooltip.install(e,me(pe.servedFromDiskCacheResourceSizeS,{PH1:t})),e.classList.add("network-dim-cell");else{const i=s.NumberUtilities.bytesToString(this.requestInternal.transferSize);o.UIUtils.createTextChild(e,i),o.Tooltip.Tooltip.install(e,`${i} transferred over network, resource size: ${t}`)}this.appendSubtitle(e,t)}renderTimeCell(e){this.requestInternal.duration>0?(this.setTextAndTitle(e,i.TimeUtilities.secondsToString(this.requestInternal.duration)),this.appendSubtitle(e,i.TimeUtilities.secondsToString(this.requestInternal.latency),!1,me(pe.timeSubtitleTooltipText))):this.requestInternal.preserved?this.setTextAndTitle(e,me(pe.unknown),me(pe.unknownExplanation)):(e.classList.add("network-dim-cell"),this.setTextAndTitle(e,me(pe.pending)))}appendSubtitle(e,t,i=!1,r=""){const s=document.createElement("div");s.classList.add("network-cell-subtitle"),i&&s.classList.add("always-visible"),s.textContent=t,r&&o.Tooltip.Tooltip.install(s,r),e.appendChild(s)}}class fe extends ke{createCells(e){super.createCells(e);const t=this.dataGrid.visibleColumnsArray[0],i=`${t.title}`,r=me(pe.level);this.nodeAccessibleText=`${r} ${i}: ${this.cellAccessibleTextMap.get(t.id)}`}renderCell(e,t){if(0===this.dataGrid.indexOfVisibleColumn(t)){const i=e,r=this.leftPadding?this.leftPadding+"px":"";i.style.setProperty("padding-left",r),i.classList.add("disclosure"),this.setCellAccessibleName(i.textContent||"",i,t)}}select(e){super.select(e);const t=this.traverseNextNode(!1,void 0,!0),i=t?.request();i&&this.parentView().dispatchEventToListeners(we.RequestSelected,i)}}var Se=Object.freeze({__proto__:null,get Events(){return we},NetworkNode:ke,_backgroundColors:be,NetworkRequestNode:ve,NetworkGroupNode:fe});const Ce=new CSSStyleSheet;Ce.replaceSync(".request-cookies-view{overflow:auto;padding:12px;height:100%;background-color:var(--sys-color-cdt-base-container)}.request-cookies-view .request-cookies-title{font-size:12px;font-weight:bold;margin-right:30px;color:var(--sys-color-on-surface)}.request-cookies-view .cookie-line{margin-top:6px;display:flex}.request-cookies-view .cookies-panel-item{margin-top:6px;margin-bottom:16px;flex:none}@media (forced-colors: active){td.flagged-cookie-attribute-cell .cookie-warning-icon{forced-color-adjust:none;filter:grayscale()}}\n/*# sourceURL=requestCookiesView.css */\n");const ye={thisRequestHasNoCookies:"This request has no cookies.",requestCookies:"Request Cookies",cookiesThatWereSentToTheServerIn:"Cookies that were sent to the server in the 'cookie' header of the request",showFilteredOutRequestCookies:"show filtered out request cookies",noRequestCookiesWereSent:"No request cookies were sent.",responseCookies:"Response Cookies",cookiesThatWereReceivedFromThe:"Cookies that were received from the server in the '`set-cookie`' header of the response",malformedResponseCookies:"Malformed Response Cookies",cookiesThatWereReceivedFromTheServer:"Cookies that were received from the server in the '`set-cookie`' header of the response but were malformed",siteHasCookieInOtherPartition:"This site has cookies in another partition, that were not sent with this request. {PH1}",learnMore:"Learn more"},Te=i.i18n.registerUIStrings("panels/network/RequestCookiesView.ts",ye),Re=i.i18n.getLocalizedString.bind(void 0,Te);class Ie extends o.Widget.Widget{request;showFilteredOutCookiesSetting;emptyWidget;requestCookiesTitle;requestCookiesEmpty;requestCookiesTable;responseCookiesTitle;responseCookiesTable;siteHasCookieInOtherPartition;malformedResponseCookiesTitle;malformedResponseCookiesList;constructor(t){super(),this.element.classList.add("request-cookies-view"),this.element.setAttribute("jslog",`${l.pane().context("cookies")}`),this.request=t,this.showFilteredOutCookiesSetting=e.Settings.Settings.instance().createSetting("show-filtered-out-request-cookies",!1),this.emptyWidget=new o.EmptyWidget.EmptyWidget(Re(ye.thisRequestHasNoCookies)),this.emptyWidget.show(this.element),this.requestCookiesTitle=this.element.createChild("div");const r=this.requestCookiesTitle.createChild("span","request-cookies-title");r.textContent=Re(ye.requestCookies),o.Tooltip.Tooltip.install(r,Re(ye.cookiesThatWereSentToTheServerIn));const s=o.SettingsUI.createSettingCheckbox(Re(ye.showFilteredOutRequestCookies),this.showFilteredOutCookiesSetting,!0);s.checkboxElement.addEventListener("change",(()=>{this.refreshRequestCookiesView()})),this.requestCookiesTitle.appendChild(s),this.requestCookiesEmpty=this.element.createChild("div","cookies-panel-item"),this.requestCookiesEmpty.textContent=Re(ye.noRequestCookiesWereSent),this.requestCookiesTable=new S.CookiesTable.CookiesTable(!0),this.requestCookiesTable.contentElement.classList.add("cookie-table","cookies-panel-item"),this.requestCookiesTable.show(this.element),this.siteHasCookieInOtherPartition=this.element.createChild("div","cookies-panel-item site-has-cookies-in-other-partition"),this.siteHasCookieInOtherPartition.appendChild(i.i18n.getFormatLocalizedString(Te,ye.siteHasCookieInOtherPartition,{PH1:o.XLink.XLink.create("https://developer.chrome.com/en/docs/privacy-sandbox/chips/",Re(ye.learnMore),void 0,void 0,"learn-more")})),this.responseCookiesTitle=this.element.createChild("div","request-cookies-title"),this.responseCookiesTitle.textContent=Re(ye.responseCookies),this.responseCookiesTitle.title=Re(ye.cookiesThatWereReceivedFromThe),this.responseCookiesTable=new S.CookiesTable.CookiesTable(!0),this.responseCookiesTable.contentElement.classList.add("cookie-table","cookies-panel-item"),this.responseCookiesTable.show(this.element),this.malformedResponseCookiesTitle=this.element.createChild("div","request-cookies-title"),this.malformedResponseCookiesTitle.textContent=Re(ye.malformedResponseCookies),o.Tooltip.Tooltip.install(this.malformedResponseCookiesTitle,Re(ye.cookiesThatWereReceivedFromTheServer)),this.malformedResponseCookiesList=this.element.createChild("div")}getRequestCookies(){const e=new Map,t=this.request.includedRequestCookies().slice();if(this.showFilteredOutCookiesSetting.get())for(const i of this.request.blockedRequestCookies())e.set(i.cookie,i.blockedReasons.map((e=>({attribute:n.NetworkRequest.cookieBlockedReasonToAttribute(e),uiString:n.NetworkRequest.cookieBlockedReasonToUiString(e)})))),t.push(i.cookie);return{requestCookies:t,requestCookieToBlockedReasons:e}}getResponseCookies(){let e=[];const t=new Map,i=[];if(this.request.responseCookies.length){e=this.request.nonBlockedResponseCookies();for(const r of this.request.blockedResponseCookies()){const o=n.CookieParser.CookieParser.parseSetCookie(r.cookieLine);if(o&&!o.length||r.blockedReasons.includes("SyntaxError")||r.blockedReasons.includes("NameValuePairExceedsMaxSize")){i.push(r);continue}let s=r.cookie;!s&&o&&(s=o[0]),s&&(t.set(s,r.blockedReasons.map((e=>({attribute:n.NetworkRequest.setCookieBlockedReasonToAttribute(e),uiString:n.NetworkRequest.setCookieBlockedReasonToUiString(e)})))),e.push(s))}}return{responseCookies:e,responseCookieToBlockedReasons:t,malformedResponseCookies:i}}refreshRequestCookiesView(){if(!this.isShowing())return;this.request.hasRequestCookies()||this.request.responseCookies.length?this.emptyWidget.hideWidget():this.emptyWidget.showWidget();const{requestCookies:e,requestCookieToBlockedReasons:t}=this.getRequestCookies(),{responseCookies:i,responseCookieToBlockedReasons:r,malformedResponseCookies:s}=this.getResponseCookies();if(e.length?(this.requestCookiesTitle.classList.remove("hidden"),this.requestCookiesEmpty.classList.add("hidden"),this.requestCookiesTable.showWidget(),this.requestCookiesTable.setCookies(e,t)):this.request.blockedRequestCookies().length?(this.requestCookiesTitle.classList.remove("hidden"),this.requestCookiesEmpty.classList.remove("hidden"),this.requestCookiesTable.hideWidget()):(this.requestCookiesTitle.classList.add("hidden"),this.requestCookiesEmpty.classList.add("hidden"),this.requestCookiesTable.hideWidget()),i.length?(this.responseCookiesTitle.classList.remove("hidden"),this.responseCookiesTable.showWidget(),this.responseCookiesTable.setCookies(i,r)):(this.responseCookiesTitle.classList.add("hidden"),this.responseCookiesTable.hideWidget()),s.length){this.malformedResponseCookiesTitle.classList.remove("hidden"),this.malformedResponseCookiesList.classList.remove("hidden"),this.malformedResponseCookiesList.removeChildren();for(const e of s){const t=this.malformedResponseCookiesList.createChild("span","cookie-line source-code"),i=new m.Icon.Icon;i.data={iconName:"cross-circle-filled",color:"var(--icon-error)",width:"14px",height:"14px"},i.classList.add("cookie-warning-icon"),t.appendChild(i),o.UIUtils.createTextChild(t,e.cookieLine),e.blockedReasons.includes("NameValuePairExceedsMaxSize")?t.title=n.NetworkRequest.setCookieBlockedReasonToUiString("NameValuePairExceedsMaxSize"):t.title=n.NetworkRequest.setCookieBlockedReasonToUiString("SyntaxError")}}else this.malformedResponseCookiesTitle.classList.add("hidden"),this.malformedResponseCookiesList.classList.add("hidden");this.request.siteHasCookieInOtherPartition()?this.siteHasCookieInOtherPartition.classList.remove("hidden"):this.siteHasCookieInOtherPartition.classList.add("hidden")}wasShown(){super.wasShown(),this.registerCSSFiles([Ce]),this.request.addEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.refreshRequestCookiesView,this),this.request.addEventListener(n.NetworkRequest.Events.ResponseHeadersChanged,this.refreshRequestCookiesView,this),this.refreshRequestCookiesView()}willHide(){this.request.removeEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.refreshRequestCookiesView,this),this.request.removeEventListener(n.NetworkRequest.Events.ResponseHeadersChanged,this.refreshRequestCookiesView,this)}}var xe=Object.freeze({__proto__:null,RequestCookiesView:Ie});const qe=new CSSStyleSheet;qe.replaceSync(".request-initiator-view{display:block;margin:6px}\n/*# sourceURL=requestInitiatorView.css */\n");const Fe=new CSSStyleSheet;Fe.replaceSync(".request-initiator-view-tree .fill{right:-6px}.request-initiator-view-section-title{font-weight:bold;padding:4px}.request-initiator-view-section-title:focus-visible{background-color:var(--sys-color-state-focus-highlight)}@media (forced-colors: active){.request-initiator-view-section-title:focus-visible{forced-color-adjust:none;background-color:Highlight;color:HighlightText}}\n/*# sourceURL=requestInitiatorViewTree.css */\n");const Le={thisRequestHasNoInitiatorData:"This request has no initiator data.",requestCallStack:"Request call stack",requestInitiatorChain:"Request initiator chain"},Pe=i.i18n.registerUIStrings("panels/network/RequestInitiatorView.ts",Le),Me=i.i18n.getLocalizedString.bind(void 0,Pe);class He extends o.Widget.VBox{linkifier;request;emptyWidget;hasShown;constructor(e){super(),this.element.classList.add("request-initiator-view"),this.element.setAttribute("jslog",`${l.pane().context("initiator")}`),this.linkifier=new k.Linkifier.Linkifier,this.request=e,this.emptyWidget=new o.EmptyWidget.EmptyWidget(Me(Le.thisRequestHasNoInitiatorData)),this.emptyWidget.show(this.element),this.hasShown=!1}static createStackTracePreview(e,t,i){const r=e.initiator();if(!r||!r.stack)return null;const o=n.NetworkManager.NetworkManager.forRequest(e),s=o?o.target():null;return k.JSPresentationUtils.buildStackTracePreviewContents(s,t,{stackTrace:r.stack,tabStops:i})}createTree(){const e=new o.TreeOutline.TreeOutlineInShadow;return e.registerCSSFiles([Fe]),e.contentElement.classList.add("request-initiator-view-tree"),e.contentElement.setAttribute("jslog",`${l.tree().context("initiator-tree")}`),e}buildRequestChainTree(e,t,i){const r=new o.TreeOutline.TreeElement(t);i.appendChild(r),r.titleElement instanceof HTMLElement&&r.titleElement.classList.add("request-initiator-view-section-title");const s=e.initiators;let n=r;for(const e of Array.from(s).reverse()){const t=new o.TreeOutline.TreeElement(e.url());n.appendChild(t),n.expand(),n=t}r.expand(),n.select();const a=n.titleElement;a instanceof HTMLElement&&(a.style.fontWeight="bold");const l=e.initiated;return this.depthFirstSearchTreeBuilder(l,n,this.request),r}depthFirstSearchTreeBuilder(e,t,i){const r=new Set;r.add(this.request);for(const s of e.keys())if(e.get(s)===i){const i=new o.TreeOutline.TreeElement(s.url());t.appendChild(i),t.expand(),r.has(s)||(r.add(s),this.depthFirstSearchTreeBuilder(e,i,s))}}buildStackTraceSection(e,t,i){const r=new o.TreeOutline.TreeElement(t);i.appendChild(r),r.titleElement instanceof HTMLElement&&r.titleElement.classList.add("request-initiator-view-section-title");const s=new o.TreeOutline.TreeElement(e,!1);s.selectable=!1,r.appendChild(s),r.expand()}wasShown(){if(this.hasShown)return;this.registerCSSFiles([qe]);let e=!1;const t=this.createTree(),i=He.createStackTracePreview(this.request,this.linkifier,!0);i&&(e=!0,this.buildStackTraceSection(i.element,Me(Le.requestCallStack),t));const r=a.NetworkLog.NetworkLog.instance().initiatorGraphForRequest(this.request);(r.initiators.size>1||r.initiated.size>1)&&(e=!0,this.buildRequestChainTree(r,Me(Le.requestInitiatorChain),t));const o=t.firstChild();o&&o.select(!0),e&&(this.element.appendChild(t.element),this.emptyWidget.hideWidget()),this.hasShown=!0}}var Ee=Object.freeze({__proto__:null,RequestInitiatorView:He});const Be=new CSSStyleSheet;Be.replaceSync('.object-properties-section-dimmed{opacity:60%}.object-properties-section{padding:0;color:var(--sys-color-on-surface);display:flex;flex-direction:column}.object-properties-section li{user-select:text}.object-properties-section li::before{top:-1px;margin-right:2px}.object-properties-section li.editing-sub-part{padding:3px 12px 8px 6px;margin:-1px -6px -8px;text-overflow:clip}.object-properties-section li.editing{margin-left:10px;text-overflow:clip}.tree-outline ol.title-less-mode{padding-left:0}.object-properties-section .own-property{font-weight:bold}.object-properties-section .synthetic-property{color:var(--sys-color-token-subtle)}.object-properties-section .private-property-hash{color:var(--sys-color-on-surface)}.object-properties-section-root-element{display:flex;flex-direction:row}.object-properties-section .editable-div{overflow:hidden}.object-properties-section [data-webidl="true"] > .name-and-value > .adorner{flex-shrink:0;width:16px;height:16px;margin-right:2px}.object-properties-section [data-webidl="true"] > .name-and-value > .name{font-weight:bold}.name-and-value{overflow:hidden;line-height:16px;display:flex;white-space:nowrap}.name-and-value .separator{white-space:pre;flex-shrink:0}.editing-sub-part .name-and-value{overflow:visible;display:inline-flex}.property-prompt{margin-left:4px}.tree-outline.hide-selection-when-blurred .selected:focus-visible{background:none}.tree-outline.hide-selection-when-blurred .selected:focus-visible ::slotted(*),\n.tree-outline.hide-selection-when-blurred .selected:focus-visible .tree-element-title,\n.tree-outline.hide-selection-when-blurred .selected:focus-visible .name-and-value,\n.tree-outline.hide-selection-when-blurred .selected:focus-visible .gray-info-message{background:var(--sys-color-state-focus-highlight);border-radius:2px}@media (forced-colors: active){.object-properties-section-dimmed{opacity:100%}.tree-outline.hide-selection-when-blurred .selected:focus-visible{background:Highlight}.tree-outline li:hover .tree-element-title,\n  .tree-outline li.selected .tree-element-title{color:ButtonText}.tree-outline.hide-selection-when-blurred .selected:focus-visible .tree-element-title,\n  .tree-outline.hide-selection-when-blurred .selected:focus-visible .name-and-value{background:transparent;box-shadow:none}.tree-outline.hide-selection-when-blurred .selected:focus-visible span,\n  .tree-outline.hide-selection-when-blurred .selected:focus-visible .gray-info-message{color:HighlightText}.tree-outline-disclosure:hover li.parent::before{background-color:ButtonText}}\n/*# sourceURL=objectPropertiesSection.css */\n');const Ue=new CSSStyleSheet;Ue.replaceSync(".value.object-value-node:hover{background-color:var(--item-hover-color)}.object-value-function-prefix,\n.object-value-boolean{color:var(--sys-color-token-attribute-value)}.object-value-function{font-style:italic}.object-value-function.linkified:hover{--override-linkified-hover-background:rgb(0 0 0/10%);background-color:var(--override-linkified-hover-background);cursor:pointer}.-theme-with-dark-background .object-value-function.linkified:hover,\n:host-context(.-theme-with-dark-background) .object-value-function.linkified:hover{--override-linkified-hover-background:rgb(230 230 230/10%)}.object-value-number{color:var(--sys-color-token-attribute-value)}.object-value-bigint{color:var(--sys-color-token-comment)}.object-value-string,\n.object-value-regexp,\n.object-value-symbol{white-space:pre;unicode-bidi:-webkit-isolate;color:var(--sys-color-token-property-special)}.object-value-node{position:relative;vertical-align:baseline;color:var(--sys-color-token-variable);white-space:nowrap}.object-value-null,\n.object-value-undefined{color:var(--sys-color-state-disabled)}.object-value-unavailable{color:var(--sys-color-token-tag)}.object-value-calculate-value-button:hover{text-decoration:underline}.object-properties-section-custom-section{display:inline-flex;flex-direction:column}.-theme-with-dark-background .object-value-number,\n:host-context(.-theme-with-dark-background) .object-value-number,\n.-theme-with-dark-background .object-value-boolean,\n:host-context(.-theme-with-dark-background) .object-value-boolean{--override-primitive-dark-mode-color:hsl(252deg 100% 75%);color:var(--override-primitive-dark-mode-color)}.object-properties-section .object-description{color:var(--sys-color-token-subtle)}.value .object-properties-preview{white-space:nowrap}.name{color:var(--sys-color-token-tag);flex-shrink:0}.object-properties-preview .name{color:var(--sys-color-token-subtle)}@media (forced-colors: active){.object-value-calculate-value-button:hover{forced-color-adjust:none;color:Highlight}}\n/*# sourceURL=objectValue.css */\n");const Ae=new CSSStyleSheet;Ae.replaceSync(".tree-outline{padding-left:0}.tree-outline > ol{padding-bottom:5px;border-bottom:solid 1px var(--sys-color-divider)}.tree-outline > .parent{user-select:none;font-weight:bold;color:var(--sys-color-on-surface);margin-top:-1px;display:flex;align-items:center;height:26px}.tree-outline li{padding-left:5px;line-height:20px}.tree-outline li:not(.parent){margin-left:10px;display:block}.tree-outline li:not(.parent)::before{display:none}.tree-outline li.expanded .payload-count{display:none}.tree-outline li .payload-toggle{display:none}.tree-outline li.expanded .payload-toggle{display:inline;margin-left:30px;font-weight:normal;color:var(--sys-color-on-surface);background:none;border:none}.tree-outline li.expanded .payload-toggle:focus-visible{border:2px solid var(--sys-color-state-focus-ring);border-radius:5px}.tree-outline li .header-toggle:hover{color:var(--sys-color-token-subtle)}.tree-outline .payload-name{color:var(--sys-color-token-subtle);display:inline-flex;margin-right:0.25em;font-weight:bold;vertical-align:top;white-space:pre-wrap}.tree-outline .payload-separator{user-select:none}.tree-outline .payload-value{display:inline;margin-right:1em;white-space:pre-wrap;word-break:break-all;margin-top:1px}.tree-outline .empty-request-payload{color:var(--sys-color-state-disabled)}.request-payload-show-more-button{border:none;border-radius:3px;display:inline-block;font-size:12px;font-family:sans-serif;margin:0 4px;padding:2px 4px}@media (forced-colors: active){:host-context(.request-payload-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected:focus{background:Highlight}:host-context(.request-payload-tree) ol.tree-outline:not(.hide-selection-when-blurred) li::before{background-color:ButtonText}:host-context(.request-payload-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected.parent::before{background-color:HighlightText}:host-context(.request-payload-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected *,\n  :host-context(.request-payload-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected.parent,\n  :host-context(.request-payload-tree) ol.tree-outline:not(.hide-selection-when-blurred) li.selected.parent span{color:HighlightText}}.payload-decode-error{color:var(--sys-color-error)}\n/*# sourceURL=requestPayloadTree.css */\n");const Ne=new CSSStyleSheet;Ne.replaceSync(".request-payload-view{user-select:text;overflow:auto}.request-payload-tree{flex-grow:1;overflow-y:auto;margin:0}\n/*# sourceURL=requestPayloadView.css */\n");const Ve={copyValue:"Copy value",requestPayload:"Request Payload",unableToDecodeValue:"(unable to decode value)",queryStringParameters:"Query String Parameters",formData:"Form Data",showMore:"Show more",viewParsed:"View parsed",empty:"(empty)",viewSource:"View source",viewUrlEncoded:"View URL-encoded",viewDecoded:"View decoded",viewUrlEncodedL:"view URL-encoded",viewDecodedL:"view decoded",viewParsedL:"view parsed",viewSourceL:"view source"},We=i.i18n.registerUIStrings("panels/network/RequestPayloadView.ts",Ve),Oe=i.i18n.getLocalizedString.bind(void 0,We);class De extends o.Widget.VBox{request;decodeRequestParameters;queryStringCategory;formDataCategory;requestPayloadCategory;constructor(e){super(),this.element.classList.add("request-payload-view"),this.element.setAttribute("jslog",`${l.pane().context("payload")}`),this.request=e,this.decodeRequestParameters=!0;const t=e.requestContentType();t&&(this.decodeRequestParameters=Boolean(t.match(/^application\/x-www-form-urlencoded\s*(;.*)?$/i)));const i=new o.TreeOutline.TreeOutlineInShadow;i.registerCSSFiles([Ue,Be,Ae]),i.element.classList.add("request-payload-tree"),i.makeDense(),this.element.appendChild(i.element),this.queryStringCategory=new ze(i,"queryString","","query-string"),this.formDataCategory=new ze(i,"formData","","form-data"),this.requestPayloadCategory=new ze(i,"requestPayload",Oe(Ve.requestPayload),"request-payload")}wasShown(){this.registerCSSFiles([Ne]),this.request.addEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.refreshFormData,this),this.refreshQueryString(),this.refreshFormData()}willHide(){this.request.removeEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.refreshFormData,this)}addEntryContextMenuHandler(e,i){e.listItemElement.addEventListener("contextmenu",(e=>{e.consume(!0);const r=new o.ContextMenu.ContextMenu(e),s=decodeURIComponent(i);r.clipboardSection().appendItem(Oe(Ve.copyValue),(()=>{t.userMetrics.actionTaken(t.UserMetrics.Action.NetworkPanelCopyValue),t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(s)})),r.show()}))}static formatParameter(e,t,i){let r=!1;if(i&&(e=e.replace(/\+/g," ")).indexOf("%")>=0)try{e=decodeURIComponent(e)}catch(e){r=!0}const o=document.createElement("div");return t&&(o.className=t),""===e&&o.classList.add("empty-value"),r?o.createChild("span","payload-decode-error").textContent=Oe(Ve.unableToDecodeValue):o.textContent=e,o}refreshQueryString(){const e=this.request.queryString(),t=this.request.queryParameters;this.queryStringCategory.hidden=!t,t&&this.refreshParams(Oe(Ve.queryStringParameters),t,e,this.queryStringCategory)}async refreshFormData(){const e=await this.request.requestFormData();if(!e)return this.formDataCategory.hidden=!0,void(this.requestPayloadCategory.hidden=!0);const t=await this.request.formParameters();if(t)this.formDataCategory.hidden=!1,this.requestPayloadCategory.hidden=!0,this.refreshParams(Oe(Ve.formData),t,e,this.formDataCategory);else{this.requestPayloadCategory.hidden=!1,this.formDataCategory.hidden=!0;try{const t=JSON.parse(e);this.refreshRequestJSONPayload(t,e)}catch(t){this.populateTreeElementWithSourceText(this.requestPayloadCategory,e)}}}populateTreeElementWithSourceText(e,t){const i=(t||"").trim(),r=i.length>3e3,s=document.createElement("span");s.classList.add("payload-value"),s.classList.add("source-code"),s.textContent=r?i.substr(0,3e3):i;const n=new o.TreeOutline.TreeElement(s);if(e.removeChildren(),e.appendChild(n),!r)return;const a=document.createElement("button");function d(){a.remove(),s.textContent=i,n.listItemElement.removeEventListener("contextmenu",c)}function c(e){const t=new o.ContextMenu.ContextMenu(e);t.newSection().appendItem(Oe(Ve.showMore),d),t.show()}a.classList.add("request-payload-show-more-button"),a.textContent=Oe(Ve.showMore),a.setAttribute("jslog",`${l.action().track({click:!0}).context("show-more")}`),a.addEventListener("click",d),n.listItemElement.addEventListener("contextmenu",c),s.appendChild(a)}refreshParams(e,t,i,r){r.removeChildren(),r.listItemElement.removeChildren(),r.listItemElement.createChild("div","selection fill"),o.UIUtils.createTextChild(r.listItemElement,e);const s=document.createElement("span");s.classList.add("payload-count");const n=t?t.length:0;s.textContent=` (${n})`,r.listItemElement.appendChild(s);Ge.has(r)?this.appendParamsSource(e,t,i,r):this.appendParamsParsed(e,t,i,r)}appendParamsSource(e,t,i,r){this.populateTreeElementWithSourceText(r,i);const s=r.listItemElement,n=function(o){s.removeEventListener("contextmenu",a),Ge.delete(r),this.refreshParams(e,t,i,r),o.consume()},a=e=>{if(!r.expanded)return;const t=new o.ContextMenu.ContextMenu(e);t.newSection().appendItem(Oe(Ve.viewParsed),n.bind(this,e)),t.show()},l=this.createViewSourceToggle(!0,n.bind(this));s.appendChild(l),s.addEventListener("contextmenu",a)}appendParamsParsed(e,t,i,r){for(const e of t||[]){const t=document.createDocumentFragment();if(""!==e.name){const i=De.formatParameter(e.name+": ","payload-name",this.decodeRequestParameters),r=De.formatParameter(e.value,"payload-value source-code",this.decodeRequestParameters);t.appendChild(i),t.createChild("span","payload-separator"),t.appendChild(r)}else t.appendChild(De.formatParameter(Oe(Ve.empty),"empty-request-payload",this.decodeRequestParameters));const i=new o.TreeOutline.TreeElement(t);this.addEntryContextMenuHandler(i,e.value),r.appendChild(i)}const s=r.listItemElement,n=function(o){s.removeEventListener("contextmenu",d),Ge.add(r),this.refreshParams(e,t,i,r),o.consume()},a=function(e){s.removeEventListener("contextmenu",d),this.toggleURLDecoding(e)},d=e=>{if(!r.expanded)return;const t=new o.ContextMenu.ContextMenu(e),i=t.newSection();i.appendItem(Oe(Ve.viewSource),n.bind(this,e));const s=this.decodeRequestParameters?Oe(Ve.viewUrlEncoded):Oe(Ve.viewDecoded);i.appendItem(s,a.bind(this,e)),t.show()},c=this.createViewSourceToggle(!1,n.bind(this));s.appendChild(c);const h=this.decodeRequestParameters?Oe(Ve.viewUrlEncodedL):Oe(Ve.viewDecodedL),u=this.createToggleButton(h);u.setAttribute("jslog",`${l.toggle().track({click:!0}).context("decode-encode")}`),u.addEventListener("click",a.bind(this),!1),s.appendChild(u),s.addEventListener("contextmenu",d)}refreshRequestJSONPayload(e,t){const i=this.requestPayloadCategory;i.removeChildren();const r=i.listItemElement;r.removeChildren(),r.createChild("div","selection fill"),o.UIUtils.createTextChild(r,this.requestPayloadCategory.title.toString()),Ge.has(i)?this.appendJSONPayloadSource(i,e,t):this.appendJSONPayloadParsed(i,e,t)}appendJSONPayloadSource(e,t,i){const r=e.listItemElement;this.populateTreeElementWithSourceText(e,i);const s=function(o){r.removeEventListener("contextmenu",a),Ge.delete(e),this.refreshRequestJSONPayload(t,i),o.consume()},n=this.createViewSourceToggle(!0,s.bind(this));r.appendChild(n);const a=t=>{if(!e.expanded)return;const i=new o.ContextMenu.ContextMenu(t);i.newSection().appendItem(Oe(Ve.viewParsed),s.bind(this,t)),i.show()};r.addEventListener("contextmenu",a)}appendJSONPayloadParsed(e,t,i){const r=n.RemoteObject.RemoteObject.fromLocalObject(t),s=new C.ObjectPropertiesSection.RootElement(r);s.title=r.description,s.expand(),s.editable=!1,e.childrenListElement.classList.add("source-code","object-properties-section"),e.appendChild(s);const a=e.listItemElement,l=function(r){a.removeEventListener("contextmenu",d),Ge.add(e),this.refreshRequestJSONPayload(t,i),r.consume()},d=t=>{if(!e.expanded)return;const i=new o.ContextMenu.ContextMenu(t);i.newSection().appendItem(Oe(Ve.viewSource),l.bind(this,t)),i.show()},c=this.createViewSourceToggle(!1,l.bind(this));a.appendChild(c),a.addEventListener("contextmenu",d)}createViewSourceToggle(e,t){const i=Oe(e?Ve.viewParsedL:Ve.viewSourceL),r=this.createToggleButton(i);return r.setAttribute("jslog",`${l.toggle().track({click:!0}).context("source-parse")}`),r.addEventListener("click",t,!1),r}toggleURLDecoding(e){this.decodeRequestParameters=!this.decodeRequestParameters,this.refreshQueryString(),this.refreshFormData(),e.consume()}createToggleButton(e){const t=document.createElement("button");return t.classList.add("payload-toggle"),t.tabIndex=0,t.textContent=e,t}}const Ge=new WeakSet;class ze extends o.TreeOutline.TreeElement{toggleOnClick;expandedSetting;expanded;constructor(t,i,r,o){super(r||"",!0),this.toggleOnClick=!0,this.hidden=!0,this.expandedSetting=e.Settings.Settings.instance().createSetting("request-info-"+i+"-category-expanded",!0),this.expanded=this.expandedSetting.get(),o&&this.listItemElement.setAttribute("jslog",`${l.section().context(o)}`),t.appendChild(this)}createLeaf(){const e=new o.TreeOutline.TreeElement;return this.appendChild(e),e}onexpand(){this.expandedSetting.set(!0)}oncollapse(){this.expandedSetting.set(!1)}}var je=Object.freeze({__proto__:null,RequestPayloadView:De,Category:ze});const _e=new CSSStyleSheet;_e.replaceSync(":host{--icon-padding:4px}.header{display:flex;font-weight:bold;padding:calc(2 * var(--icon-padding)) var(--icon-padding);line-height:20px}.icon{margin:0 var(--icon-padding)}\n/*# sourceURL=WebBundleInfoView.css */\n");const{render:Ke,html:$e}=R,Xe={bundledResource:"Bundled resource"},Ye=i.i18n.registerUIStrings("panels/network/components/WebBundleInfoView.ts",Xe),Je=i.i18n.getLocalizedString.bind(void 0,Ye);class Qe extends v.LegacyWrapper.WrappableComponent{static litTagName=R.literal`devtools-web-bundle-info`;#t=this.attachShadow({mode:"open"});#i;#r;constructor(e){super();const t=e.webBundleInfo();if(!t)throw new Error("Trying to render a Web Bundle info without providing data");this.#i=t,this.#r=e.parsedURL.lastPathComponent,this.setAttribute("jslog",`${l.pane().context("webbundle")}`)}connectedCallback(){this.#t.adoptedStyleSheets=[_e]}async render(){const t=this.#i.resourceUrls?.map((t=>{const i=e.ResourceType.ResourceType.mimeFromURL(t)||null,r=e.ResourceType.ResourceType.fromMimeTypeOverride(i)||e.ResourceType.ResourceType.fromMimeType(i),o=b.iconDataForResourceType(r);return{cells:[{columnId:"url",value:null,renderer:()=>$e`
                <div style="display: flex;">
                  <${m.Icon.Icon.litTagName} class="icon"
                    .data=${{...o,width:"20px"}}>
                  </${m.Icon.Icon.litTagName}>
                  <span>${t}</span>
                </div>`}]}}));Ke($e`
      <div class="header">
        <${m.Icon.Icon.litTagName} class="icon"
          .data=${{color:"var(--icon-default)",iconName:"bundle",width:"20px"}}>
        </${m.Icon.Icon.litTagName}>
        <span>${this.#r}</span>
        <x-link href="https://web.dev/web-bundles/#explaining-web-bundles"
          jslog=${l.link().track({click:!0}).context("webbundle-explainer")}>
          <${m.Icon.Icon.litTagName} class="icon"
            .data=${{color:"var(--icon-default)",iconName:"help",width:"16px"}}>
          </${m.Icon.Icon.litTagName}>
        </x-link>
      </div>
      <div>
        <${y.DataGrid.DataGrid.litTagName}
          .data=${{columns:[{id:"url",title:Je(Xe.bundledResource),widthWeighting:1,visible:!0,hideable:!1}],rows:t,activeSort:null}}>
        </${y.DataGrid.DataGrid.litTagName}>
      </div>`,this.#t,{host:this})}}T.CustomElements.defineComponent("devtools-web-bundle-info",Qe);const Ze=new CSSStyleSheet;Ze.replaceSync(".html-preview-frame{box-shadow:var(--drop-shadow);background:var(--ref-palette-neutral100);flex-grow:1;margin:20px}\n/*# sourceURL=requestHTMLView.css */\n");class et extends o.Widget.VBox{dataURL;constructor(e){super(!0),this.dataURL=encodeURI(e).replace(/#/g,"%23"),this.contentElement.classList.add("html","request-view")}wasShown(){this.createIFrame(),this.registerCSSFiles([Ze])}willHide(){this.contentElement.removeChildren()}createIFrame(){this.contentElement.removeChildren();const e=document.createElement("iframe");e.className="html-preview-frame",e.setAttribute("sandbox",""),e.setAttribute("csp","default-src 'none';img-src data:;style-src 'unsafe-inline'"),e.setAttribute("src",this.dataURL),e.tabIndex=-1,o.ARIAUtils.markAsPresentation(e),this.contentElement.appendChild(e)}}var tt=Object.freeze({__proto__:null,RequestHTMLView:et});const it={thisRequestHasNoResponseData:"This request has no response data available.",failedToLoadResponseData:"Failed to load response data"},rt=i.i18n.registerUIStrings("panels/network/RequestResponseView.ts",it),ot=i.i18n.getLocalizedString.bind(void 0,rt);class st extends o.Widget.VBox{request;contentViewPromise;constructor(e){super(),this.element.classList.add("request-view"),this.element.setAttribute("jslog",`${l.pane().context("response")}`),this.request=e,this.contentViewPromise=null}static hasTextContent(t,i){const r=t.mimeType||"";let o=e.ResourceType.ResourceType.fromMimeType(r);return o===e.ResourceType.resourceTypes.Other&&(o=t.contentType()),o===e.ResourceType.resourceTypes.Image?r.startsWith("image/svg"):!!o.isTextType()||!i.error&&(o===e.ResourceType.resourceTypes.Other&&(Boolean(i.content)&&!i.encoded))}static async sourceViewForRequest(i){let o=nt.get(i);if(void 0!==o)return o;const s=n.ContentData.ContentData.asLegacyContentData(await i.contentData());if(!st.hasTextContent(i,s))return nt.delete(i),null;let a;a="application/json"===e.ResourceType.ResourceType.simplifyContentType(i.mimeType)?i.mimeType:i.resourceType().canonicalMimeType()||i.mimeType;const l=e.ResourceType.ResourceType.mediaTypeForMetrics(a,i.resourceType().isFromSourceMap(),I.TextUtils.isMinified(s.content??""));return t.userMetrics.networkPanelResponsePreviewOpened(l),o=r.ResourceSourceFrame.ResourceSourceFrame.createSearchableView(i,a),nt.set(i,o),o}wasShown(){this.doShowPreview()}doShowPreview(){return this.contentViewPromise||(this.contentViewPromise=this.showPreview()),this.contentViewPromise}async showPreview(){const e=await this.createPreview();return e.show(this.element),e}async createPreview(){const e=n.ContentData.ContentData.asLegacyContentData(await this.request.contentData()),t=await st.sourceViewForRequest(this.request);return e.content&&t||e.error?e.content&&t?t:e.error?new o.EmptyWidget.EmptyWidget(ot(it.failedToLoadResponseData)+": "+e.error):204===this.request.statusCode?new o.EmptyWidget.EmptyWidget(ot(it.thisRequestHasNoResponseData)):new o.EmptyWidget.EmptyWidget(ot(it.failedToLoadResponseData)):new o.EmptyWidget.EmptyWidget(ot(it.thisRequestHasNoResponseData))}async revealPosition(e){const t=await this.doShowPreview();t instanceof r.ResourceSourceFrame.SearchableContainer&&t.revealPosition(e)}}const nt=new WeakMap;var at=Object.freeze({__proto__:null,RequestResponseView:st});const lt=new CSSStyleSheet;lt.replaceSync(".tree-outline{padding-left:0}.tree-outline > ol{padding-bottom:5px;border-bottom:solid 1px var(--sys-color-divider)}.tree-outline > .parent{user-select:none;font-weight:bold;color:var(--sys-color-on-surface);margin-top:-1px;display:flex;align-items:center;height:26px}.tree-outline li{padding-left:5px;line-height:20px}.tree-outline li:not(.parent){display:block;margin-left:10px}.tree-outline li:not(.parent)::before{display:none}.tree-outline .header-name{color:var(--sys-color-token-subtle);display:inline-block;margin-right:0.25em;font-weight:bold;vertical-align:top;white-space:pre-wrap}.tree-outline .header-separator{user-select:none}.tree-outline .header-value{display:inline;margin-right:1em;white-space:pre-wrap;word-break:break-all;margin-top:1px}.tree-outline .header-toggle{display:inline;margin-left:30px;font-weight:normal;color:var(--sys-color-state-disabled)}.tree-outline .header-toggle:hover{color:var(--sys-color-state-hover-on-subtle)}.tree-outline .error-log{color:var(--sys-color-error);display:inline-block;margin-right:0.25em;margin-left:0.25em;font-weight:bold;vertical-align:top;white-space:pre-wrap}.tree-outline .hex-data{display:block;word-break:break-word;margin-left:20px}.tree-outline .error-field{color:var(--sys-color-error)}.prompt-icon{margin-top:2px}\n/*# sourceURL=signedExchangeInfoTree.css */\n");const dt=new CSSStyleSheet;dt.replaceSync(".signed-exchange-info-view{user-select:text;overflow:auto}.signed-exchange-info-tree{flex-grow:1;overflow-y:auto;margin:0}\n/*# sourceURL=signedExchangeInfoView.css */\n");const ct={errors:"Errors",signedHttpExchange:"Signed HTTP exchange",learnmore:"Learn more",requestUrl:"Request URL",responseCode:"Response code",headerIntegrityHash:"Header integrity hash",responseHeaders:"Response headers",signature:"Signature",label:"Label",certificateUrl:"Certificate URL",viewCertificate:"View certificate",integrity:"Integrity",certificateSha:"Certificate SHA256",validityUrl:"Validity URL",date:"Date",expires:"Expires",certificate:"Certificate",subject:"Subject",validFrom:"Valid from",validUntil:"Valid until",issuer:"Issuer"},ht=i.i18n.registerUIStrings("panels/network/SignedExchangeInfoView.ts",ct),ut=i.i18n.getLocalizedString.bind(void 0,ht);class pt extends o.Widget.VBox{responseHeadersItem;constructor(e){super(),console.assert(null!==e.signedExchangeInfo());const i=e.signedExchangeInfo();this.element.classList.add("signed-exchange-info-view");const r=new o.TreeOutline.TreeOutlineInShadow;r.registerCSSFiles([lt]),r.element.classList.add("signed-exchange-info-tree"),r.setFocusable(!1),r.makeDense(),r.expandTreeElementsWhenArrowing=!0,this.element.appendChild(r.element);const s=new Map;if(i.errors&&i.errors.length){const e=new gt(r,ut(ct.errors));for(const t of i.errors){const i=document.createDocumentFragment(),r=new m.Icon.Icon;if(r.data={iconName:"cross-circle-filled",color:"var(--icon-error)",width:"14px",height:"14px"},r.classList.add("prompt-icon"),i.appendChild(r),i.createChild("div","error-log").textContent=t.message,e.createLeaf(i),t.errorField){let e=s.get(t.signatureIndex);e||(e=new Set,s.set(t.signatureIndex,e)),e.add(t.errorField)}}}const n=document.createDocumentFragment();n.createChild("div","header-name").textContent=ut(ct.signedHttpExchange);const a=o.XLink.XLink.create("https://github.com/WICG/webpackage",ut(ct.learnmore),"header-toggle",void 0,"learn-more");n.appendChild(a);const l=new gt(r,n);if(i.header){const n=i.header,a=e.redirectDestination(),d=this.formatHeader(ut(ct.requestUrl),n.requestUrl);if(a){const e=k.Linkifier.Linkifier.linkifyRevealable(a,"View request");e.classList.add("header-toggle"),d.appendChild(e)}l.createLeaf(d),l.createLeaf(this.formatHeader(ut(ct.responseCode),String(n.responseCode))),l.createLeaf(this.formatHeader(ut(ct.headerIntegrityHash),n.headerIntegrity)),this.responseHeadersItem=l.createLeaf(this.formatHeader(ut(ct.responseHeaders),""));const c=n.responseHeaders;for(const e in c){const t=new o.TreeOutline.TreeElement(this.formatHeader(e,c[e]));t.selectable=!1,this.responseHeadersItem.appendChild(t)}this.responseHeadersItem.expand();for(let e=0;e<n.signatures.length;++e){const i=s.get(e)||new Set,o=n.signatures[e],a=new gt(r,ut(ct.signature));if(a.createLeaf(this.formatHeader(ut(ct.label),o.label)),a.createLeaf(this.formatHeaderForHexData(ut(ct.signature),o.signature,i.has("signatureSig"))),o.certUrl){const e=this.formatHeader(ut(ct.certificateUrl),o.certUrl,i.has("signatureCertUrl"));if(o.certificates){const i=e.createChild("span","devtools-link header-toggle");i.textContent=ut(ct.viewCertificate),i.addEventListener("click",t.InspectorFrontendHost.InspectorFrontendHostInstance.showCertificateViewer.bind(null,o.certificates),!1)}a.createLeaf(e)}a.createLeaf(this.formatHeader(ut(ct.integrity),o.integrity,i.has("signatureIntegrity"))),o.certSha256&&a.createLeaf(this.formatHeaderForHexData(ut(ct.certificateSha),o.certSha256,i.has("signatureCertSha256"))),a.createLeaf(this.formatHeader(ut(ct.validityUrl),o.validityUrl,i.has("signatureValidityUrl"))),a.createLeaf().title=this.formatHeader(ut(ct.date),new Date(1e3*o.date).toUTCString(),i.has("signatureTimestamps")),a.createLeaf().title=this.formatHeader(ut(ct.expires),new Date(1e3*o.expires).toUTCString(),i.has("signatureTimestamps"))}}if(i.securityDetails){const e=i.securityDetails,t=new gt(r,ut(ct.certificate));t.createLeaf(this.formatHeader(ut(ct.subject),e.subjectName)),t.createLeaf(this.formatHeader(ut(ct.validFrom),new Date(1e3*e.validFrom).toUTCString())),t.createLeaf(this.formatHeader(ut(ct.validUntil),new Date(1e3*e.validTo).toUTCString())),t.createLeaf(this.formatHeader(ut(ct.issuer),e.issuer))}}formatHeader(e,t,i){const r=document.createDocumentFragment(),o=r.createChild("div","header-name");o.textContent=e+": ",r.createChild("span","header-separator");const s=r.createChild("div","header-value source-code");return s.textContent=t,i&&(o.classList.add("error-field"),s.classList.add("error-field")),r}formatHeaderForHexData(e,t,i){const r=document.createDocumentFragment(),o=r.createChild("div","header-name");o.textContent=e+": ",r.createChild("span","header-separator");const s=r.createChild("div","header-value source-code hex-data");return s.textContent=t.replace(/(.{2})/g,"$1 "),i&&(o.classList.add("error-field"),s.classList.add("error-field")),r}wasShown(){super.wasShown(),this.registerCSSFiles([dt])}}class gt extends o.TreeOutline.TreeElement{toggleOnClick;expanded;constructor(e,t){super(t,!0),this.selectable=!1,this.toggleOnClick=!0,this.expanded=!0,e.appendChild(this)}createLeaf(e){const t=new o.TreeOutline.TreeElement(e);return t.selectable=!1,this.appendChild(t),t}}var mt=Object.freeze({__proto__:null,SignedExchangeInfoView:pt,Category:gt});const wt={failedToLoadResponseData:"Failed to load response data",previewNotAvailable:"Preview not available"},kt=i.i18n.registerUIStrings("panels/network/RequestPreviewView.ts",wt),bt=i.i18n.getLocalizedString.bind(void 0,kt);class vt extends st{constructor(e){super(e),this.element.setAttribute("jslog",`${l.pane().context("preview")}`)}async showPreview(){const e=await super.showPreview();if(!(e instanceof o.View.SimpleView))return e;const t=new o.Toolbar.Toolbar("network-item-preview-toolbar",this.element);return e.toolbarItems().then((e=>{e.map((e=>t.appendToolbarItem(e)))})),e}async htmlPreview(){const e=await this.request.contentData();if(n.ContentData.ContentData.isError(e))return new o.EmptyWidget.EmptyWidget(bt(wt.failedToLoadResponseData)+": "+e.error);if(!new Set(["text/html","text/plain","application/xhtml+xml"]).has(this.request.mimeType))return null;const t=await r.JSONView.JSONView.createView(e.text);if(t)return t;const i=e.asDataUrl();return i?new et(i):null}async createPreview(){if(this.request.signedExchangeInfo())return new pt(this.request);if(this.request.webBundleInfo())return v.LegacyWrapper.legacyWrapper(o.Widget.VBox,new Qe(this.request));const e=await this.htmlPreview();if(e)return e;const t=await r.PreviewFactory.PreviewFactory.createPreview(this.request,this.request.mimeType);return t||new o.EmptyWidget.EmptyWidget(bt(wt.previewNotAvailable))}}var ft=Object.freeze({__proto__:null,RequestPreviewView:vt});const St={sLatencySDownloadSTotal:"{PH1} latency, {PH2} download ({PH3} total)",sLatency:"{PH1} latency",sDownload:"{PH1} download",sFromServiceworker:"{PH1} (from `ServiceWorker`)",sFromCache:"{PH1} (from cache)"},Ct=i.i18n.registerUIStrings("panels/network/NetworkTimeCalculator.ts",St),yt=i.i18n.getLocalizedString.bind(void 0,Ct);class Tt{minimum;maximum;constructor(e,t){this.minimum=e,this.maximum=t}equals(e){return this.minimum===e.minimum&&this.maximum===e.maximum}}class Rt extends e.ObjectWrapper.ObjectWrapper{startAtZero;minimumBoundaryInternal;maximumBoundaryInternal;boundryChangedEventThrottler;window;workingArea;constructor(t){super(),this.startAtZero=t,this.minimumBoundaryInternal=-1,this.maximumBoundaryInternal=-1,this.boundryChangedEventThrottler=new e.Throttler.Throttler(0),this.window=null}setWindow(e){this.window=e,this.boundaryChanged()}setInitialUserFriendlyBoundaries(){this.minimumBoundaryInternal=0,this.maximumBoundaryInternal=1}computePosition(e){return(e-this.minimumBoundary())/this.boundarySpan()*(this.workingArea||0)}formatValue(e,t){return i.TimeUtilities.secondsToString(e,Boolean(t))}minimumBoundary(){return this.window?this.window.minimum:this.minimumBoundaryInternal}zeroTime(){return this.minimumBoundaryInternal}maximumBoundary(){return this.window?this.window.maximum:this.maximumBoundaryInternal}boundary(){return new Tt(this.minimumBoundary(),this.maximumBoundary())}boundarySpan(){return this.maximumBoundary()-this.minimumBoundary()}reset(){this.minimumBoundaryInternal=-1,this.maximumBoundaryInternal=-1,this.boundaryChanged()}value(){return 0}setDisplayWidth(e){this.workingArea=e}computeBarGraphPercentages(e){let t,i,r;return t=-1!==e.startTime?(e.startTime-this.minimumBoundary())/this.boundarySpan()*100:0,i=-1!==e.responseReceivedTime?(e.responseReceivedTime-this.minimumBoundary())/this.boundarySpan()*100:this.startAtZero?t:100,r=-1!==e.endTime?(e.endTime-this.minimumBoundary())/this.boundarySpan()*100:this.startAtZero?i:100,this.startAtZero&&(r-=t,i-=t,t=0),{start:t,middle:i,end:r}}computePercentageFromEventTime(e){return-1===e||this.startAtZero?0:(e-this.minimumBoundary())/this.boundarySpan()*100}percentageToTime(e){return e*this.boundarySpan()/100+this.minimumBoundary()}boundaryChanged(){this.boundryChangedEventThrottler.schedule((async()=>{this.dispatchEventToListeners(xt.BoundariesChanged)}))}updateBoundariesForEventTime(e){-1===e||this.startAtZero||(void 0===this.maximumBoundaryInternal||e>this.maximumBoundaryInternal)&&(this.maximumBoundaryInternal=e,this.boundaryChanged())}computeBarGraphLabels(e){let t="";-1!==e.responseReceivedTime&&-1!==e.endTime&&(t=i.TimeUtilities.secondsToString(e.endTime-e.responseReceivedTime));const r=e.latency>0,o=r?i.TimeUtilities.secondsToString(e.latency):t;if(e.timing)return{left:o,right:t,tooltip:void 0};let s;if(r&&t){const r=i.TimeUtilities.secondsToString(e.duration);s=yt(St.sLatencySDownloadSTotal,{PH1:o,PH2:t,PH3:r})}else r?s=yt(St.sLatency,{PH1:o}):t&&(s=yt(St.sDownload,{PH1:t}));return e.fetchedViaServiceWorker?s=yt(St.sFromServiceworker,{PH1:String(s)}):e.cached()&&(s=yt(St.sFromCache,{PH1:String(s)})),{left:o,right:t,tooltip:s}}updateBoundaries(e){const t=this.lowerBound(e),i=this.upperBound(e);let r=!1;(-1!==t||this.startAtZero)&&(r=this.extendBoundariesToIncludeTimestamp(this.startAtZero?0:t)),-1!==i&&(r=this.extendBoundariesToIncludeTimestamp(i)||r),r&&this.boundaryChanged()}extendBoundariesToIncludeTimestamp(e){const t=this.minimumBoundaryInternal,i=this.maximumBoundaryInternal,r=It;return-1===this.minimumBoundaryInternal||-1===this.maximumBoundaryInternal?(this.minimumBoundaryInternal=e,this.maximumBoundaryInternal=e+r):(this.minimumBoundaryInternal=Math.min(e,this.minimumBoundaryInternal),this.maximumBoundaryInternal=Math.max(e,this.minimumBoundaryInternal+r,this.maximumBoundaryInternal)),t!==this.minimumBoundaryInternal||i!==this.maximumBoundaryInternal}lowerBound(e){return 0}upperBound(e){return 0}}const It=.1;var xt;!function(e){e.BoundariesChanged="BoundariesChanged"}(xt||(xt={}));class qt extends Rt{constructor(){super(!1)}formatValue(e,t){return i.TimeUtilities.secondsToString(e-this.zeroTime(),Boolean(t))}lowerBound(e){return e.issueTime()}upperBound(e){return e.endTime}}class Ft extends Rt{constructor(){super(!0)}formatValue(e,t){return i.TimeUtilities.secondsToString(e,Boolean(t))}upperBound(e){return e.duration}}var Lt=Object.freeze({__proto__:null,NetworkTimeBoundary:Tt,NetworkTimeCalculator:Rt,_minimumSpread:It,get Events(){return xt},NetworkTransferTimeCalculator:qt,NetworkTransferDurationCalculator:Ft});const Pt=new CSSStyleSheet;Pt.replaceSync('.network-timing-table{width:380px;border-spacing:0;padding-left:10px;padding-right:10px;line-height:initial;table-layout:fixed}.network-timing-start{border-top:5px solid transparent}.network-timing-start th span.network-timing-hidden-header{height:1px;width:1px;position:absolute;overflow:hidden}.network-timing-table-header td,\n.network-timing-footer td{border-top:10px solid transparent}.network-timing-table-header td{color:var(--sys-color-token-subtle)}.network-timing-table td{padding:4px 0}.network-timing-table-header td:last-child{text-align:right}.network-timing-footer td:last-child{font-weight:bold;text-align:right}table.network-timing-table > tr:not(.network-timing-table-header):not(.network-timing-footer) > td:first-child{padding-left:12px}.network-timing-table col.labels{width:156px}.network-timing-table col.duration{width:80px}.network-timing-table td.caution{font-weight:bold;color:var(--issue-color-yellow);padding:2px 0}.network-timing-table hr.break{background-color:var(--sys-color-divider);border:none;height:1px}.network-timing-row{position:relative;height:15px}.network-timing-bar{position:absolute;min-width:1px;top:0;bottom:0}.network-timing-bar-title{color:var(--sys-color-on-surface);white-space:nowrap;text-align:right}.network-timing-bar.queueing,\n.network-timing-bar.total{border:1px solid var(--sys-color-token-subtle)}.network-timing-bar.blocking,\n.-theme-preserve{background-color:var(--network-overview-blocking)}.network-timing-bar.proxy,\n.-theme-preserve{background-color:var(--override-network-overview-proxy)}.network-timing-bar.dns,\n.-theme-preserve{background-color:var(--sys-color-cyan)}.network-timing-bar.connecting,\n.network-timing-bar.serviceworker,\n.network-timing-bar.serviceworker-preparation,\n.-theme-preserve{background-color:var(--network-overview-service-worker)}.network-timing-bar.ssl,\n.-theme-preserve{background-color:var(--network-overview-ssl)}.network-timing-bar.serviceworker-respondwith,\n.-theme-preserve{background-color:var(--network-overview-service-worker-respond-with)}.network-fetch-timing-bar-clickable::before{user-select:none;-webkit-mask-image:var(--image-file-triangle-right);float:left;width:14px;height:14px;margin-right:2px;content:"";position:relative;background-color:var(--icon-default);transition:transform 200ms}.network-fetch-timing-bar-clickable{position:relative;left:-12px}.network-fetch-timing-bar-clickable:focus-visible{background-color:var(--sys-color-state-focus-highlight)}.network-fetch-timing-bar-clickable[aria-checked="true"]::before{transform:rotate(90deg)}.network-fetch-timing-bar-details-collapsed{display:none}.network-fetch-timing-bar-details-expanded{display:block}.network-fetch-timing-bar-details{padding-left:11px;width:fit-content}.network-fetch-details-treeitem{width:max-content}.network-timing-bar.sending,\n.-theme-preserve{background-color:var(--override-network-overview-sending)}.network-timing-bar.waiting,\n.-theme-preserve{background-color:var(--network-overview-waiting)}.network-timing-bar.receiving,\n.network-timing-bar.receiving-push,\n.-theme-preserve{background-color:var(--network-overview-receiving)}.network-timing-bar.push,\n.-theme-preserve{background-color:var(--network-overview-push)}.server-timing-row:nth-child(even){background:var(--sys-color-surface1)}.network-timing-bar.server-timing,\n.-theme-preserve{background-color:var(--sys-color-neutral-container)}.network-timing-table td.network-timing-metric{white-space:nowrap;max-width:150px;overflow-x:hidden;text-overflow:ellipsis}.network-timing-bar.proxy,\n.network-timing-bar.dns,\n.network-timing-bar.ssl,\n.network-timing-bar.connecting,\n.network-timing-bar.blocking{height:10px;margin:auto}@media (forced-colors: active){.network-timing-bar.blocking,\n  .network-timing-bar.proxy,\n  .network-timing-bar.dns,\n  .network-timing-bar.connecting,\n  .network-timing-bar.serviceworker,\n  .network-timing-bar.serviceworker-preparation,\n  .network-timing-bar.ssl,\n  .network-timing-bar.sending,\n  .network-timing-bar.waiting,\n  .network-timing-bar.receiving,\n  .network-timing-bar.receiving-push,\n  .network-timing-bar.push,\n  .network-timing-bar.server-timing,\n  .-theme-preserve{forced-color-adjust:none}.network-timing-table-header td,\n  .network-timing-footer td{forced-color-adjust:none;color:ButtonText}}\n/*# sourceURL=networkTimingTable.css */\n');const Mt={receivingPush:"Receiving `Push`",queueing:"Queueing",stalled:"Stalled",initialConnection:"Initial connection",dnsLookup:"DNS Lookup",proxyNegotiation:"Proxy negotiation",readingPush:"Reading `Push`",contentDownload:"Content Download",requestSent:"Request sent",requestToServiceworker:"Request to `ServiceWorker`",startup:"Startup",respondwith:"respondWith",ssl:"SSL",total:"Total",waitingTtfb:"Waiting for server response",label:"Label",waterfall:"Waterfall",duration:"Duration",queuedAtS:"Queued at {PH1}",startedAtS:"Started at {PH1}",serverPush:"Server Push",resourceScheduling:"Resource Scheduling",connectionStart:"Connection Start",requestresponse:"Request/Response",cautionRequestIsNotFinishedYet:"CAUTION: request is not finished yet!",explanation:"Explanation",serverTiming:"Server Timing",time:"TIME",theServerTimingApi:"the Server Timing API",duringDevelopmentYouCanUseSToAdd:"During development, you can use {PH1} to add insights into the server-side timing of this request.",durationC:"DURATION",originalRequest:"Original Request",responseReceived:"Response Received",unknown:"Unknown",sourceOfResponseS:"Source of response: {PH1}",cacheStorageCacheNameS:"Cache storage cache name: {PH1}",cacheStorageCacheNameUnknown:"Cache storage cache name: Unknown",retrievalTimeS:"Retrieval Time: {PH1}",serviceworkerCacheStorage:"`ServiceWorker` cache storage",fromHttpCache:"From HTTP cache",networkFetch:"Network fetch",fallbackCode:"Fallback code"},Ht=i.i18n.registerUIStrings("panels/network/RequestTimingView.ts",Mt),Et=i.i18n.getLocalizedString.bind(void 0,Ht);class Bt extends o.Widget.VBox{request;calculator;lastMinimumBoundary;tableElement;constructor(e,t){super(),this.element.classList.add("resource-timing-view"),this.request=e,this.calculator=t,this.lastMinimumBoundary=-1}static timeRangeTitle(e){switch(e){case Ut.Push:return Et(Mt.receivingPush);case Ut.Queueing:return Et(Mt.queueing);case Ut.Blocking:return Et(Mt.stalled);case Ut.Connecting:return Et(Mt.initialConnection);case Ut.DNS:return Et(Mt.dnsLookup);case Ut.Proxy:return Et(Mt.proxyNegotiation);case Ut.ReceivingPush:return Et(Mt.readingPush);case Ut.Receiving:return Et(Mt.contentDownload);case Ut.Sending:return Et(Mt.requestSent);case Ut.ServiceWorker:return Et(Mt.requestToServiceworker);case Ut.ServiceWorkerPreparation:return Et(Mt.startup);case Ut.ServiceWorkerRespondWith:return Et(Mt.respondwith);case Ut.SSL:return Et(Mt.ssl);case Ut.Total:return Et(Mt.total);case Ut.Waiting:return Et(Mt.waitingTtfb);default:return e}}static calculateRequestTimeRanges(e,t){const i=[];function r(e,t,r){t<Number.MAX_VALUE&&t<=r&&i.push({name:e,start:t,end:r})}function o(e){for(let t=0;t<e.length;++t)if(e[t]>0)return e[t]}function s(e,t,i){t>=0&&i>=0&&r(e,l+t/1e3,l+i/1e3)}const n=e.timing;if(!n){const t=-1!==e.issueTime()?e.issueTime():-1!==e.startTime?e.startTime:0,o=-1!==e.issueTime()&&-1!==e.startTime&&e.issueTime()!==e.startTime,s=-1===e.responseReceivedTime?o?e.startTime:Number.MAX_VALUE:e.responseReceivedTime,n=-1===e.endTime?Number.MAX_VALUE:e.endTime;r(Ut.Total,t,n),r(Ut.Blocking,t,s);return r(-1===e.responseReceivedTime?Ut.Connecting:Ut.Receiving,s,n),i}const a=e.issueTime(),l=n.requestTime,d=o([e.endTime,e.responseReceivedTime])||l;if(r(Ut.Total,a<l?a:l,d),n.pushStart){const e=n.pushEnd||d;e>t&&r(Ut.Push,Math.max(n.pushStart,t),e)}a<l&&r(Ut.Queueing,a,l);const c=1e3*(e.responseReceivedTime-l);if(e.fetchedViaServiceWorker)s(Ut.Blocking,0,n.workerStart),s(Ut.ServiceWorkerPreparation,n.workerStart,n.workerReady),s(Ut.ServiceWorkerRespondWith,n.workerFetchStart,n.workerRespondWithSettled),s(Ut.ServiceWorker,n.workerReady,n.sendEnd),s(Ut.Waiting,n.sendEnd,c);else if(!n.pushStart){const e=o([n.dnsStart,n.connectStart,n.sendStart,c])||0;s(Ut.Blocking,0,e),s(Ut.Proxy,n.proxyStart,n.proxyEnd),s(Ut.DNS,n.dnsStart,n.dnsEnd),s(Ut.Connecting,n.connectStart,n.connectEnd),s(Ut.SSL,n.sslStart,n.sslEnd),s(Ut.Sending,n.sendStart,n.sendEnd),s(Ut.Waiting,Math.max(n.sendEnd,n.connectEnd,n.dnsEnd,n.proxyEnd,e),c)}return-1!==e.endTime&&r(n.pushStart?Ut.ReceivingPush:Ut.Receiving,e.responseReceivedTime,d),i}static createTimingTable(t,r){const s=document.createElement("table");s.classList.add("network-timing-table"),s.setAttribute("jslog",`${l.pane().context("timing")}`);const n=s.createChild("colgroup");n.createChild("col","labels"),n.createChild("col","bars"),n.createChild("col","duration");const a=Bt.calculateRequestTimeRanges(t,r.minimumBoundary()),d=a.map((e=>e.start)).reduce(((e,t)=>Math.min(e,t))),c=a.map((e=>e.end)).reduce(((e,t)=>Math.max(e,t))),h=100/(c-d);let u,p,g,m,w=0;const k=s.createChild("thead","network-timing-start"),b=k.createChild("tr"),v=b.createChild("th");v.createChild("span","network-timing-hidden-header").textContent=Et(Mt.label),v.scope="col";const f=b.createChild("th");f.createChild("span","network-timing-hidden-header").textContent=Et(Mt.waterfall),f.scope="col";const S=b.createChild("th");S.createChild("span","network-timing-hidden-header").textContent=Et(Mt.duration),S.scope="col";const C=k.createChild("tr").createChild("td"),y=k.createChild("tr").createChild("td");let T;C.colSpan=y.colSpan=3,o.UIUtils.createTextChild(C,Et(Mt.queuedAtS,{PH1:r.formatValue(t.issueTime(),2)})),o.UIUtils.createTextChild(y,Et(Mt.startedAtS,{PH1:r.formatValue(t.startTime,2)}));for(let e=0;e<a.length;++e){const t=a[e],n=t.name;if(n===Ut.Total){w=t.end-t.start;continue}n===Ut.Push?H(Et(Mt.serverPush)):n===Ut.Queueing?m||(m=H(Et(Mt.resourceScheduling))):Nt.has(n)?u||(u=H(Et(Mt.connectionStart))):At.has(n)?p||(p=H("Service Worker")):g||(g=H(Et(Mt.requestresponse)));const l=h*(t.start-d);T=h*(c-t.end);const k=t.end-t.start,b=s.createChild("tr"),v=b.createChild("td");o.UIUtils.createTextChild(v,Bt.timeRangeTitle(n));const f=b.createChild("td").createChild("div","network-timing-row"),S=f.createChild("span","network-timing-bar "+n);S.style.left=l+"%",S.style.right=T+"%",S.textContent="​",o.ARIAUtils.setLabel(f,Et(Mt.startedAtS,{PH1:r.formatValue(t.start,2)}));b.createChild("td").createChild("div","network-timing-bar-title").textContent=i.TimeUtilities.secondsToString(k,!0),"serviceworker-respondwith"===t.name&&(v.classList.add("network-fetch-timing-bar-clickable"),s.createChild("tr","network-fetch-timing-bar-details"),v.setAttribute("tabindex","0"),v.setAttribute("role","switch"),o.ARIAUtils.setChecked(v,!1))}if(!t.finished&&!t.preserved){const e=s.createChild("tr").createChild("td","caution");e.colSpan=3,o.UIUtils.createTextChild(e,Et(Mt.cautionRequestIsNotFinishedYet))}const R=s.createChild("tr","network-timing-footer"),I=R.createChild("td");I.colSpan=1;const x=o.XLink.XLink.create("https://developer.chrome.com/docs/devtools/network/reference/#timing-explanation",Et(Mt.explanation),void 0,void 0,"explanation");I.appendChild(x),R.createChild("td"),o.UIUtils.createTextChild(R.createChild("td"),i.TimeUtilities.secondsToString(w,!0));const q=t.serverTimings,F=void 0===T?100:T,L=s.createChild("tr","network-timing-table-header").createChild("td");L.colSpan=3,L.createChild("hr","break");const P=s.createChild("tr","network-timing-table-header");if(o.UIUtils.createTextChild(P.createChild("td"),Et(Mt.serverTiming)),P.createChild("td"),o.UIUtils.createTextChild(P.createChild("td"),Et(Mt.time)),!q){const e=s.createChild("tr").createChild("td");e.colSpan=3;const t=o.XLink.XLink.create("https://web.dev/custom-metrics/#server-timing-api",Et(Mt.theServerTimingApi),void 0,void 0,"server-timing-api");return e.appendChild(i.i18n.getFormatLocalizedString(Ht,Mt.duringDevelopmentYouCanUseSToAdd,{PH1:t})),s}return q.filter((e=>"total"!==e.metric.toLowerCase())).forEach((e=>M(e,F))),q.filter((e=>"total"===e.metric.toLowerCase())).forEach((e=>M(e,F))),s;function M(t,r){const n=new e.Color.Generator({min:0,max:360,count:36},{min:50,max:80,count:void 0},80),a="total"===t.metric.toLowerCase(),l=s.createChild("tr",a?"network-timing-footer":"server-timing-row"),u=l.createChild("td","network-timing-metric"),p=t.description||t.metric;o.UIUtils.createTextChild(u,p),o.Tooltip.Tooltip.install(u,p);const g=l.createChild("td").createChild("div","network-timing-row");if(null===t.value)return;const m=h*(c-d-t.value/1e3);if(m>=0){const e=g.createChild("span","network-timing-bar server-timing");e.style.left=m+"%",e.style.right=r+"%",e.textContent="​",a||(e.style.backgroundColor=n.colorForID(t.metric))}l.createChild("td").createChild("div","network-timing-bar-title").textContent=i.TimeUtilities.millisToString(t.value,!0)}function H(e){const t=s.createChild("tr","network-timing-table-header"),i=t.createChild("td");return o.UIUtils.createTextChild(i,e),o.ARIAUtils.markAsHeading(i,2),o.UIUtils.createTextChild(t.createChild("td"),""),o.UIUtils.createTextChild(t.createChild("td"),Et(Mt.durationC)),t}}constructFetchDetailsView(){if(!this.tableElement)return;const e=this.tableElement.ownerDocument,t=e.querySelector(".network-fetch-timing-bar-details");if(!t)return;t.classList.add("network-fetch-timing-bar-details-collapsed"),self.onInvokeElement(this.tableElement,this.onToggleFetchDetails.bind(this,t));const i=new o.TreeOutline.TreeOutlineInShadow;t.appendChild(i.element);const r=a.NetworkLog.NetworkLog.instance().originalRequestForURL(this.request.url());if(r){const e=n.RemoteObject.RemoteObject.fromLocalObject(r),t=new C.ObjectPropertiesSection.RootElement(e);t.title=Et(Mt.originalRequest),i.appendChild(t)}const s=a.NetworkLog.NetworkLog.instance().originalResponseForURL(this.request.url());if(s){const e=n.RemoteObject.RemoteObject.fromLocalObject(s),t=new C.ObjectPropertiesSection.RootElement(e);t.title=Et(Mt.responseReceived),i.appendChild(t)}const l=e.createElement("div");l.classList.add("network-fetch-details-treeitem");let d=Et(Mt.unknown);const c=this.request.serviceWorkerResponseSource();c&&(d=this.getLocalizedResponseSourceForCode(c)),l.textContent=Et(Mt.sourceOfResponseS,{PH1:d});const h=new o.TreeOutline.TreeElement(l);i.appendChild(h);const u=e.createElement("div");u.classList.add("network-fetch-details-treeitem");const p=this.request.getResponseCacheStorageCacheName();u.textContent=p?Et(Mt.cacheStorageCacheNameS,{PH1:p}):Et(Mt.cacheStorageCacheNameUnknown);const g=new o.TreeOutline.TreeElement(u);i.appendChild(g);const m=this.request.getResponseRetrievalTime();if(m){const t=e.createElement("div");t.classList.add("network-fetch-details-treeitem"),t.textContent=Et(Mt.retrievalTimeS,{PH1:m.toString()});const r=new o.TreeOutline.TreeElement(t);i.appendChild(r)}}getLocalizedResponseSourceForCode(e){switch(e){case"cache-storage":return Et(Mt.serviceworkerCacheStorage);case"http-cache":return Et(Mt.fromHttpCache);case"network":return Et(Mt.networkFetch);default:return Et(Mt.fallbackCode)}}onToggleFetchDetails(e,i){if(!i.target)return;const r=i.target;if(r.classList.contains("network-fetch-timing-bar-clickable")){e.classList.contains("network-fetch-timing-bar-details-collapsed")&&t.userMetrics.actionTaken(t.UserMetrics.Action.NetworkPanelServiceWorkerRespondWith);const i="true"===r.getAttribute("aria-checked");r.setAttribute("aria-checked",String(!i)),e.classList.toggle("network-fetch-timing-bar-details-collapsed"),e.classList.toggle("network-fetch-timing-bar-details-expanded")}}wasShown(){this.request.addEventListener(n.NetworkRequest.Events.TimingChanged,this.refresh,this),this.request.addEventListener(n.NetworkRequest.Events.FinishedLoading,this.refresh,this),this.calculator.addEventListener(xt.BoundariesChanged,this.boundaryChanged,this),this.registerCSSFiles([Pt]),this.refresh()}willHide(){this.request.removeEventListener(n.NetworkRequest.Events.TimingChanged,this.refresh,this),this.request.removeEventListener(n.NetworkRequest.Events.FinishedLoading,this.refresh,this),this.calculator.removeEventListener(xt.BoundariesChanged,this.boundaryChanged,this)}refresh(){this.tableElement&&this.tableElement.remove(),this.tableElement=Bt.createTimingTable(this.request,this.calculator),this.tableElement.classList.add("resource-timing-table"),this.element.appendChild(this.tableElement),this.request.fetchedViaServiceWorker&&this.constructFetchDetailsView()}boundaryChanged(){const e=this.calculator.minimumBoundary();e!==this.lastMinimumBoundary&&(this.lastMinimumBoundary=e,this.refresh())}}var Ut;!function(e){e.Push="push",e.Queueing="queueing",e.Blocking="blocking",e.Connecting="connecting",e.DNS="dns",e.Proxy="proxy",e.Receiving="receiving",e.ReceivingPush="receiving-push",e.Sending="sending",e.ServiceWorker="serviceworker",e.ServiceWorkerPreparation="serviceworker-preparation",e.ServiceWorkerRespondWith="serviceworker-respondwith",e.SSL="ssl",e.Total="total",e.Waiting="waiting"}(Ut||(Ut={}));const At=new Set([Ut.ServiceWorker,Ut.ServiceWorkerPreparation,Ut.ServiceWorkerRespondWith]),Nt=new Set([Ut.Queueing,Ut.Blocking,Ut.Connecting,Ut.DNS,Ut.Proxy,Ut.SSL]);var Vt=Object.freeze({__proto__:null,RequestTimingView:Bt,get RequestTimeRangeNames(){return Ut},ServiceWorkerRangeNames:At,ConnectionSetupRangeNames:Nt});const Wt=new CSSStyleSheet;Wt.replaceSync('.websocket-frame-view{user-select:text}.websocket-frame-view .data-grid{flex:auto;border:none}.websocket-frame-view .data-grid .data{background-image:none}.websocket-frame-view-td{border-bottom:1px solid var(--sys-color-divider)}.websocket-frame-view .data-grid td,\n.websocket-frame-view .data-grid th{border-left-color:1px solid var(--sys-color-divider)}.websocket-frame-view-row-send td:first-child::before{content:"\\2B06";color:var(--sys-color-tertiary);padding-right:4px}.websocket-frame-view-row-receive td:first-child::before{content:"\\2B07";color:var(--sys-color-error);padding-right:4px}.websocket-frame-view-row-send{background-color:color-mix(in sRGB,var(--sys-color-tertiary-container),transparent 50%)}.websocket-frame-view-row-error{background-color:var(--sys-color-surface-error);color:var(--sys-color-on-surface-error)}.websocket-frame-view .toolbar{border-bottom:1px solid var(--sys-color-divider)}\n/*# sourceURL=webSocketFrameView.css */\n');const Ot={data:"Data",length:"Length",time:"Time",webSocketFrame:"Web Socket Frame",clearAll:"Clear All",filter:"Filter",selectMessageToBrowseItsContent:"Select message to browse its content.",copyMessageD:"Copy message...",copyMessage:"Copy message",clearAllL:"Clear all",sOpcodeSMask:"{PH1} (Opcode {PH2}, mask)",sOpcodeS:"{PH1} (Opcode {PH2})",continuationFrame:"Continuation Frame",textMessage:"Text Message",binaryMessage:"Binary Message",connectionCloseMessage:"Connection Close Message",pingMessage:"Ping Message",pongMessage:"Pong Message",all:"All",send:"Send",receive:"Receive",na:"N/A",enterRegex:"Enter regex, for example: (web)?socket"},Dt=i.i18n.registerUIStrings("panels/network/ResourceWebSocketFrameView.ts",Ot),Gt=i.i18n.getLocalizedString.bind(void 0,Dt),zt=i.i18n.getLazilyComputedLocalizedString.bind(void 0,Dt);class jt extends o.Widget.VBox{request;splitWidget;dataGrid;timeComparator;mainToolbar;clearAllButton;filterTypeCombobox;filterType;filterTextInput;filterRegex;frameEmptyWidget;selectedNode;currentSelectedNode;messageFilterSetting=e.Settings.Settings.instance().createSetting("networkWebSocketMessageFilter","");constructor(e){super(),this.element.classList.add("websocket-frame-view"),this.element.setAttribute("jslog",`${l.pane().context("web-socket-messages")}`),this.request=e,this.splitWidget=new o.SplitWidget.SplitWidget(!1,!0,"resourceWebSocketFrameSplitViewState"),this.splitWidget.show(this.element);const i=[{id:"data",title:Gt(Ot.data),sortable:!1,weight:88},{id:"length",title:Gt(Ot.length),sortable:!1,align:d.DataGrid.Align.Right,weight:5},{id:"time",title:Gt(Ot.time),sortable:!0,weight:7}];this.dataGrid=new d.SortableDataGrid.SortableDataGrid({displayName:Gt(Ot.webSocketFrame),columns:i,editCallback:void 0,deleteCallback:void 0,refreshCallback:void 0}),this.dataGrid.setRowContextMenuCallback(function(e,i){const r=i,o=r.binaryView();o?o.addCopyToContextMenu(e,Gt(Ot.copyMessageD)):e.clipboardSection().appendItem(Gt(Ot.copyMessage),t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText.bind(t.InspectorFrontendHost.InspectorFrontendHostInstance,r.data.data));e.footerSection().appendItem(Gt(Ot.clearAllL),this.clearFrames.bind(this))}.bind(this)),this.dataGrid.setStickToBottom(!0),this.dataGrid.setCellClass("websocket-frame-view-td"),this.timeComparator=Yt,this.dataGrid.sortNodes(this.timeComparator,!1),this.dataGrid.markColumnAsSortedBy("time",d.DataGrid.Order.Ascending),this.dataGrid.addEventListener(d.DataGrid.Events.SortingChanged,this.sortItems,this),this.dataGrid.setName("ResourceWebSocketFrameView"),this.dataGrid.addEventListener(d.DataGrid.Events.SelectedNode,(e=>{this.onFrameSelected(e)}),this),this.dataGrid.addEventListener(d.DataGrid.Events.DeselectedNode,this.onFrameDeselected,this),this.mainToolbar=new o.Toolbar.Toolbar(""),this.clearAllButton=new o.Toolbar.ToolbarButton(Gt(Ot.clearAll),"clear"),this.clearAllButton.addEventListener(o.Toolbar.ToolbarButton.Events.Click,this.clearFrames,this),this.mainToolbar.appendToolbarItem(this.clearAllButton),this.filterTypeCombobox=new o.Toolbar.ToolbarComboBox(this.updateFilterSetting.bind(this),Gt(Ot.filter));for(const e of $t){const t=this.filterTypeCombobox.createOption(e.label(),e.name);this.filterTypeCombobox.addOption(t)}this.mainToolbar.appendToolbarItem(this.filterTypeCombobox),this.filterType=null;const r=Gt(Ot.enterRegex);this.filterTextInput=new o.Toolbar.ToolbarInput(r,"",.4),this.filterTextInput.addEventListener(o.Toolbar.ToolbarInput.Event.TextChanged,this.updateFilterSetting,this);const s=this.messageFilterSetting.get();s&&this.filterTextInput.setValue(s),this.filterRegex=null,this.mainToolbar.appendToolbarItem(this.filterTextInput);const n=new o.Widget.VBox;n.element.appendChild(this.mainToolbar.element),this.dataGrid.asWidget().show(n.element),n.setMinimumSize(0,72),this.splitWidget.setMainWidget(n),this.frameEmptyWidget=new o.EmptyWidget.EmptyWidget(Gt(Ot.selectMessageToBrowseItsContent)),this.splitWidget.setSidebarWidget(this.frameEmptyWidget),this.selectedNode=null,s&&this.applyFilter(s)}static opCodeDescription(e,t){const i=Kt[e]||(()=>"");return Gt(t?Ot.sOpcodeSMask:Ot.sOpcodeS,{PH1:i(),PH2:e})}wasShown(){this.refresh(),this.registerCSSFiles([Wt]),this.request.addEventListener(n.NetworkRequest.Events.WebsocketFrameAdded,this.frameAdded,this)}willHide(){this.request.removeEventListener(n.NetworkRequest.Events.WebsocketFrameAdded,this.frameAdded,this)}frameAdded(e){const t=e.data;this.frameFilter(t)&&this.dataGrid.insertChild(new Xt(this.request.url(),t))}frameFilter(e){return(!this.filterType||e.type===this.filterType)&&(!this.filterRegex||this.filterRegex.test(e.text))}clearFrames(){Jt.set(this.request,this.request.frames().length),this.refresh()}updateFilterSetting(){const e=this.filterTextInput.value();this.messageFilterSetting.set(e),this.applyFilter(e)}applyFilter(e){const t=this.filterTypeCombobox.selectedOption().value;this.filterRegex=e?new RegExp(s.StringUtilities.escapeForRegExp(e),"i"):null,this.filterType="all"===t?null:t,this.refresh()}async onFrameSelected(t){this.currentSelectedNode=t.data;const i=this.currentSelectedNode.dataText(),o=this.currentSelectedNode.binaryView();if(o)return void this.splitWidget.setSidebarWidget(o);const s=await r.JSONView.JSONView.createView(i);s?this.splitWidget.setSidebarWidget(s):this.splitWidget.setSidebarWidget(new r.ResourceSourceFrame.ResourceSourceFrame(I.StaticContentProvider.StaticContentProvider.fromString(this.request.url(),e.ResourceType.resourceTypes.WebSocket,i),""))}onFrameDeselected(){this.currentSelectedNode=null,this.splitWidget.setSidebarWidget(this.frameEmptyWidget)}refresh(){this.dataGrid.rootNode().removeChildren();const e=this.request.url();let t=this.request.frames();const i=Jt.get(this.request)||0;t=t.slice(i),t=t.filter(this.frameFilter.bind(this)),t.forEach((t=>this.dataGrid.insertChild(new Xt(e,t))))}sortItems(){this.dataGrid.sortNodes(this.timeComparator,!this.dataGrid.isSortOrderAscending())}}var _t;!function(e){e[e.ContinuationFrame=0]="ContinuationFrame",e[e.TextFrame=1]="TextFrame",e[e.BinaryFrame=2]="BinaryFrame",e[e.ConnectionCloseFrame=8]="ConnectionCloseFrame",e[e.PingFrame=9]="PingFrame",e[e.PongFrame=10]="PongFrame"}(_t||(_t={}));const Kt=function(){const e=_t,t=[];return t[e.ContinuationFrame]=zt(Ot.continuationFrame),t[e.TextFrame]=zt(Ot.textMessage),t[e.BinaryFrame]=zt(Ot.binaryMessage),t[e.ConnectionCloseFrame]=zt(Ot.connectionCloseMessage),t[e.PingFrame]=zt(Ot.pingMessage),t[e.PongFrame]=zt(Ot.pongMessage),t}(),$t=[{name:"all",label:zt(Ot.all),title:void 0},{name:"send",label:zt(Ot.send),title:void 0},{name:"receive",label:zt(Ot.receive),title:void 0}];class Xt extends d.SortableDataGrid.SortableDataGridNode{url;frame;isTextFrame;dataTextInternal;binaryViewInternal;constructor(e,t){let i=String(t.text.length);const r=new Date(1e3*t.time),a=("0"+r.getHours()).substr(-2)+":"+("0"+r.getMinutes()).substr(-2)+":"+("0"+r.getSeconds()).substr(-2)+"."+("00"+r.getMilliseconds()).substr(-3),l=document.createElement("div");o.UIUtils.createTextChild(l,a),o.Tooltip.Tooltip.install(l,r.toLocaleString());let d=t.text,c=jt.opCodeDescription(t.opCode,t.mask);const h=t.opCode===_t.TextFrame;t.type===n.NetworkRequest.WebSocketFrameType.Error?(c=d,i=Gt(Ot.na)):h?c=d:t.opCode===_t.BinaryFrame?(i=s.NumberUtilities.bytesToString(s.StringUtilities.base64ToSize(t.text)),c=Kt[t.opCode]()):d=c,super({data:c,length:i,time:l}),this.url=e,this.frame=t,this.isTextFrame=h,this.dataTextInternal=d,this.binaryViewInternal=null}createCells(e){e.classList.toggle("websocket-frame-view-row-error",this.frame.type===n.NetworkRequest.WebSocketFrameType.Error),e.classList.toggle("websocket-frame-view-row-send",this.frame.type===n.NetworkRequest.WebSocketFrameType.Send),e.classList.toggle("websocket-frame-view-row-receive",this.frame.type===n.NetworkRequest.WebSocketFrameType.Receive),super.createCells(e)}nodeSelfHeight(){return 21}dataText(){return this.dataTextInternal}opCode(){return this.frame.opCode}binaryView(){return this.isTextFrame||this.frame.type===n.NetworkRequest.WebSocketFrameType.Error?null:(this.binaryViewInternal||this.dataTextInternal.length>0&&(this.binaryViewInternal=new W(this.dataTextInternal,s.DevToolsPath.EmptyUrlString,e.ResourceType.resourceTypes.WebSocket)),this.binaryViewInternal)}}function Yt(e,t){return e.frame.time-t.frame.time}const Jt=new WeakMap;var Qt=Object.freeze({__proto__:null,ResourceWebSocketFrameView:jt,get OpCodes(){return _t},opCodeDescriptions:Kt,_filterTypes:$t,ResourceWebSocketFrameNode:Xt,ResourceWebSocketFrameNodeTimeComparator:Yt});const Zt={headers:"Headers",payload:"Payload",messages:"Messages",websocketMessages:"WebSocket messages",eventstream:"EventStream",preview:"Preview",responsePreview:"Response preview",signedexchangeError:"SignedExchange error",response:"Response",rawResponseData:"Raw response data",initiator:"Initiator",requestInitiatorCallStack:"Request initiator call stack",timing:"Timing",requestAndResponseTimeline:"Request and response timeline",thirdPartyPhaseout:"Cookies blocked due to third-party cookie phaseout.",trustTokens:"Private state tokens",trustTokenOperationDetails:"Private State Token operation details",cookies:"Cookies",requestAndResponseCookies:"Request and response cookies",containsOverriddenHeaders:"This response contains headers which are overridden by DevTools",responseIsOverridden:"This response is overridden by DevTools"},ei=i.i18n.registerUIStrings("panels/network/NetworkItemView.ts",Zt),ti=i.i18n.getLocalizedString.bind(void 0,ei);class ii extends o.TabbedPane.TabbedPane{requestInternal;resourceViewTabSetting;headersViewComponent;payloadView;responseView;cookiesView;initialTab;constructor(t,i,r){super(),this.requestInternal=t,this.element.classList.add("network-item-view");const s=g.UIRequestLocation.UIRequestTabs.HeadersComponent;if(this.resourceViewTabSetting=e.Settings.Settings.instance().createSetting("resourceViewTab",g.UIRequestLocation.UIRequestTabs.HeadersComponent),this.headersViewComponent=new f.RequestHeadersView.RequestHeadersView(t),this.appendTab(s,ti(Zt.headers),v.LegacyWrapper.legacyWrapper(o.Widget.VBox,this.headersViewComponent),ti(Zt.headers)),this.requestInternal.hasOverriddenHeaders()){const e=new m.Icon.Icon;e.data={iconName:"small-status-dot",color:"var(--sys-color-purple-bright)",width:"16px",height:"16px"},e.title=ti(Zt.containsOverriddenHeaders),this.setTabIcon(g.UIRequestLocation.UIRequestTabs.HeadersComponent,e)}if(this.payloadView=null,this.maybeAppendPayloadPanel(),this.addEventListener(o.TabbedPane.Events.TabSelected,this.tabSelected,this),t.resourceType()===e.ResourceType.resourceTypes.WebSocket){const e=new jt(t);this.appendTab(g.UIRequestLocation.UIRequestTabs.WsFrames,ti(Zt.messages),e,ti(Zt.websocketMessages))}else if("text/event-stream"===t.mimeType)this.appendTab(g.UIRequestLocation.UIRequestTabs.EventSource,ti(Zt.eventstream),new Z(t));else{this.responseView=new st(t);const e=new vt(t);this.appendTab(g.UIRequestLocation.UIRequestTabs.Preview,ti(Zt.preview),e,ti(Zt.responsePreview));const i=t.signedExchangeInfo();if(i&&i.errors&&i.errors.length){const e=new m.Icon.Icon;e.data={iconName:"cross-circle-filled",color:"var(--icon-error)",width:"14px",height:"14px"},o.Tooltip.Tooltip.install(e,ti(Zt.signedexchangeError)),this.setTabIcon(g.UIRequestLocation.UIRequestTabs.Preview,e)}if(this.appendTab(g.UIRequestLocation.UIRequestTabs.Response,ti(Zt.response),this.responseView,ti(Zt.rawResponseData)),this.requestInternal.hasOverriddenContent){const e=new m.Icon.Icon;e.title=ti(Zt.responseIsOverridden),e.data={iconName:"small-status-dot",color:"var(--sys-color-purple-bright)",width:"16px",height:"16px"},this.setTabIcon(g.UIRequestLocation.UIRequestTabs.Response,e)}}this.appendTab(g.UIRequestLocation.UIRequestTabs.Initiator,ti(Zt.initiator),new He(t),ti(Zt.requestInitiatorCallStack)),this.appendTab(g.UIRequestLocation.UIRequestTabs.Timing,ti(Zt.timing),new Bt(t,i),ti(Zt.requestAndResponseTimeline)),t.trustTokenParams()&&this.appendTab(g.UIRequestLocation.UIRequestTabs.TrustTokens,ti(Zt.trustTokens),v.LegacyWrapper.legacyWrapper(o.Widget.VBox,new f.RequestTrustTokensView.RequestTrustTokensView(t)),ti(Zt.trustTokenOperationDetails)),this.cookiesView=null,this.initialTab=r||this.resourceViewTabSetting.get(),this.setAutoSelectFirstItemOnShow(!1)}wasShown(){super.wasShown(),this.requestInternal.addEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.requestHeadersChanged,this),this.requestInternal.addEventListener(n.NetworkRequest.Events.ResponseHeadersChanged,this.maybeAppendCookiesPanel,this),this.requestInternal.addEventListener(n.NetworkRequest.Events.TrustTokenResultAdded,this.maybeShowErrorIconInTrustTokenTabHeader,this),this.maybeAppendCookiesPanel(),this.maybeShowErrorIconInTrustTokenTabHeader(),this.initialTab&&(this.selectTabInternal(this.initialTab),this.initialTab=void 0)}willHide(){this.requestInternal.removeEventListener(n.NetworkRequest.Events.RequestHeadersChanged,this.requestHeadersChanged,this),this.requestInternal.removeEventListener(n.NetworkRequest.Events.ResponseHeadersChanged,this.maybeAppendCookiesPanel,this),this.requestInternal.removeEventListener(n.NetworkRequest.Events.TrustTokenResultAdded,this.maybeShowErrorIconInTrustTokenTabHeader,this)}async requestHeadersChanged(){this.maybeAppendCookiesPanel(),this.maybeAppendPayloadPanel()}maybeAppendCookiesPanel(){const e=this.requestInternal.hasRequestCookies()||this.requestInternal.responseCookies.length>0;if(console.assert(e||!this.cookiesView,"Cookies were introduced in headers and then removed!"),e&&!this.cookiesView&&(this.cookiesView=new Ie(this.requestInternal),this.appendTab(g.UIRequestLocation.UIRequestTabs.Cookies,ti(Zt.cookies),this.cookiesView,ti(Zt.requestAndResponseCookies))),this.requestInternal.hasThirdPartyCookiePhaseoutIssue()){const e=new m.Icon.Icon;e.data={iconName:"warning-filled",color:"var(--icon-warning)",width:"14px",height:"14px"},e.title=ti(Zt.thirdPartyPhaseout),this.setTabIcon(g.UIRequestLocation.UIRequestTabs.Cookies,e)}}async maybeAppendPayloadPanel(){this.hasTab("payload")||(this.requestInternal.queryParameters||await this.requestInternal.requestFormData())&&(this.payloadView=new De(this.requestInternal),this.appendTab(g.UIRequestLocation.UIRequestTabs.Payload,ti(Zt.payload),this.payloadView,ti(Zt.payload),void 0,void 0,void 0,1))}maybeShowErrorIconInTrustTokenTabHeader(){const e=this.requestInternal.trustTokenOperationDoneEvent();if(e&&!f.RequestTrustTokensView.statusConsideredSuccess(e.status)){const e=new m.Icon.Icon;e.data={iconName:"cross-circle-filled",color:"var(--icon-error)",width:"14px",height:"14px"},this.setTabIcon(g.UIRequestLocation.UIRequestTabs.TrustTokens,e)}}selectTabInternal(e){this.selectTab(e)||window.setTimeout((()=>{this.selectTab(e)||this.selectTab("headers")}),0)}tabSelected(e){e.data.isUserGesture&&this.resourceViewTabSetting.set(e.data.tabId)}request(){return this.requestInternal}async revealResponseBody(e){this.selectTabInternal(g.UIRequestLocation.UIRequestTabs.Response),await(this.responseView?.revealPosition(e))}revealHeader(e,t){this.selectTabInternal(g.UIRequestLocation.UIRequestTabs.HeadersComponent),this.headersViewComponent.revealHeader(e,t)}getHeadersViewComponent(){return this.headersViewComponent}}var ri=Object.freeze({__proto__:null,NetworkItemView:ii});class oi{parentView;activeGroups;constructor(e){this.parentView=e,this.activeGroups=new Map}groupNodeForRequest(e){const t=n.ResourceTreeModel.ResourceTreeModel.frameForRequest(e);if(!t||t.isOutermostFrame())return null;let i=this.activeGroups.get(t);return i||(i=new si(this.parentView,t),this.activeGroups.set(t,i),i)}reset(){this.activeGroups.clear()}}class si extends fe{frame;constructor(e,t){super(e),this.frame=t}displayName(){return new e.ParsedURL.ParsedURL(this.frame.url).domain()||this.frame.name||"<iframe>"}renderCell(e,t){super.renderCell(e,t);if(0===this.dataGrid.indexOfVisibleColumn(t)){const i=this.displayName();e.appendChild(m.Icon.create("frame","network-frame-group-icon")),o.UIUtils.createTextChild(e,i),o.Tooltip.Tooltip.install(e,i),this.setCellAccessibleName(e.textContent||"",e,t)}}}var ni=Object.freeze({__proto__:null,NetworkFrameGrouper:oi,FrameGroupNode:si});const ai=new CSSStyleSheet;ai.replaceSync('.network-log-grid.data-grid{border:none!important;flex:auto}.network-log-grid.data-grid.no-selection:focus-visible{border:none!important}#network-container{overflow:hidden}#network-container.grid-focused.no-node-selected:focus-within{border:1px solid var(--sys-color-state-focus-ring)}.network-summary-bar{flex:0 0 27px;line-height:27px;padding-left:5px;background-color:var(--sys-color-cdt-base-container);border-top:1px solid var(--sys-color-divider);white-space:nowrap;text-overflow:ellipsis;overflow:hidden;user-select:text}.panel.network .toolbar.network-summary-bar{border-bottom:0}.network-summary-bar span[is="dt-icon-label"]{margin-right:6px}.network-summary-bar > *{flex:none}.network-log-grid.data-grid tbody{background:transparent}.network-log-grid.data-grid td{height:41px;border-left:1px solid var(--sys-color-divider);vertical-align:middle}.network-log-grid.data-grid .corner{display:none}.network-log-grid.data-grid.small td{height:21px}.network-log-grid.data-grid th{border-bottom:none}.network-waterfall-header,\n.network-log-grid.data-grid thead th{border-bottom:1px solid var(--sys-color-divider);border-left:1px solid var(--sys-color-divider)}.network-waterfall-header,\n.network-log-grid.data-grid thead{height:31px;background-color:var(--sys-color-surface1)}.network-waterfall-header.small,\n.network-log-grid.data-grid.small thead{height:27px}.network-log-grid.data-grid select{appearance:none;border:none;width:100%;color:inherit}.network-log-grid.data-grid .waterfall-column{padding:1px 0}.network-log-grid.data-grid .waterfall-column .sort-order-icon-container{right:15px;pointer-events:none}.network-log-grid.data-grid th.sortable:active{background-image:none!important}.network-cell-subtitle{font-weight:normal;color:var(--sys-color-token-subtle)}.network-badge{margin-right:4px}.status-column .devtools-link{color:inherit}.initiator-column .devtools-link{color:inherit}.network-error-row,\n.network-error-row .network-cell-subtitle{color:var(--sys-color-error)!important}.network-log-grid.data-grid tr.selected.network-error-row,\n.network-log-grid.data-grid tr.selected.network-error-row .network-cell-subtitle,\n.network-log-grid.data-grid tr.selected.network-error-row .network-dim-cell,\n.network-log-grid.data-grid:focus-within tr.selected.network-error-row .devtools-link,\n.network-log-grid.data-grid:focus-within tr.selected.network-error-row,\n.network-log-grid.data-grid:focus-within tr.selected.network-error-row .network-cell-subtitle,\n.network-log-grid.data-grid:focus-within tr.selected.network-error-row .network-dim-cell{color:var(--sys-color-error)}.network-log-grid.data-grid tr.selected,\n.network-log-grid.data-grid tr.selected .network-cell-subtitle,\n.network-log-grid.data-grid tr.selected .network-dim-cell{color:inherit}.network-log-grid.data-grid:focus tr.selected,\n.network-log-grid.data-grid:focus tr.selected .network-cell-subtitle,\n.network-log-grid.data-grid:focus tr.selected .network-dim-cell{color:var(--sys-color-on-tonal-container)}.network-header-subtitle{color:var(--sys-color-token-subtle)}.network-log-grid.data-grid.small .network-cell-subtitle,\n.network-log-grid.data-grid.small .network-header-subtitle{display:none}.network-log-grid.data-grid.small .network-cell-subtitle.always-visible{display:inline;margin-left:4px}.network-log-grid tr.highlighted-row{animation:network-row-highlight-fadeout 2s 0s}@keyframes network-row-highlight-fadeout{from{background-color:var(--sys-color-yellow-container)}to{background-color:transparent}}.network-log-grid.data-grid .icon.image{position:relative}.network-log-grid.data-grid .icon{float:left;width:32px;height:32px;margin-top:1px;margin-right:3px}.network-log-grid.data-grid:focus-within .network-error-row.selected div.icon:not(.image){filter:none}.network-log-grid.data-grid .network-error-row.data-grid-data-grid-node img.icon,\n.network-log-grid.data-grid .network-error-row.data-grid-data-grid-node.selected img.icon{filter:brightness(0) saturate(100%) invert(35%) sepia(76%) saturate(1413%) hue-rotate(338deg) brightness(92%) contrast(103%)}.data-grid-data-grid-node devtools-icon[name="arrow-up-down-circle"],\n.network-log-grid.data-grid.small .icon{width:16px;height:16px}.image-network-icon-preview{bottom:0;left:0;margin:auto;overflow:hidden;right:0;top:0}.network-log-grid.data-grid .image-network-icon-preview{position:absolute;max-width:18px;max-height:21px;min-width:1px;min-height:1px}.network-log-grid.data-grid.small .image-network-icon-preview{left:2px;right:2px;max-width:10px;max-height:12px}.network-log-grid.data-grid .trailing-link-icon{padding-left:0.5ex}.network-dim-cell{color:var(--sys-color-token-subtle)}.network-frame-divider{width:2px;background-color:var(--network-frame-divider-color);z-index:10;visibility:hidden}#network-container:not(.brief-mode) .data-container{overflow:hidden}.network-log-grid.data-grid .resources-dividers{z-index:0}.network-log-grid.data-grid .resources-dividers-label-bar{background-color:transparent;border:none;height:30px;pointer-events:none}.network-log-grid.data-grid span.separator-in-cell{user-select:none;min-width:1ex;display:inline-block}.network-status-pane{color:var(--sys-color-token-subtle);background-color:var(--sys-color-cdt-base-container);z-index:500;display:flex;justify-content:center;align-items:center;text-align:center;padding:0 20px;overflow:auto}.network-status-pane > .recording-hint{font-size:14px;text-align:center;line-height:28px}.network-waterfall-header{position:absolute;border-left:0;width:100%;display:table;z-index:200;& > div.hover-layer{display:none;background-color:var(--sys-color-state-hover-on-subtle);position:absolute;top:0;left:0;width:100%;height:100%}&:hover > div.hover-layer{display:block}}.network-waterfall-header div{display:table-cell;line-height:14px;margin:auto 0;vertical-align:middle;text-align:left;font-weight:normal;padding:0 4px}.network-waterfall-header .sort-order-icon-container{position:absolute;top:1px;right:0;bottom:1px;display:flex;align-items:center}.network-waterfall-header .sort-order-icon{align-items:center;margin-right:4px;margin-bottom:-2px}.network-frame-group-icon{display:inline-block;margin:-7px 1px}.network-frame-group-badge{margin-right:4px}.network-override-marker{position:relative;float:left}.network-override-marker::before{background-color:var(--sys-color-purple-bright);content:url("Images/empty.svg");width:6px;height:6px;border-radius:50%;outline:1px solid var(--icon-gap-toolbar);left:8px;position:absolute;top:10px;z-index:1}@media (forced-colors: active){.network-status-pane > .recording-hint{color:canvastext}.initiator-column .devtools-link{color:linktext}.network-log-grid.data-grid tbody tr.revealed.selected,\n  .network-log-grid.data-grid:focus-within tbody tr.revealed.selected,\n  .network-log-grid.data-grid:focus-within tr.selected .network-dim-cell,\n  .network-log-grid.data-grid tr.selected .network-dim-cell,\n  .network-log-grid.data-grid:focus-within tr.selected .initiator-column .devtools-link,\n  .network-log-grid.data-grid tr.selected .initiator-column .devtools-link,\n  .network-waterfall-header:hover *{color:HighlightText}.network-log-grid{--color-grid-default:canvas;--color-grid-stripe:canvas;--color-grid-hovered:Highlight;--color-grid-selected:ButtonText;--color-grid-focus-selected:Highlight}#network-container.no-node-selected:focus-within,\n  .network-status-pane{forced-color-adjust:none;border-color:Highlight;background-color:canvas!important}.network-waterfall-header:hover{forced-color-adjust:none;background-color:Highlight!important;& > div.hover-layer{display:none}}.network-waterfall-header.small,\n  .network-log-grid.data-grid.small thead .network-waterfall-header,\n  .network-log-grid.data-grid thead{background-color:canvas}.network-waterfall-header .sort-order-icon-container devtools-icon{background-color:inherit}.network-waterfall-header:hover .sort-order-icon-container devtools-icon{color:HighlightText}}\n/*# sourceURL=networkLogView.css */\n');const li=new CSSStyleSheet;li.replaceSync(".custom-headers-list{height:272px;width:250px}.custom-headers-wrapper{margin:10px}.header{padding:0 0 6px;font-size:18px;font-weight:normal;flex:none}.custom-headers-header{padding:2px}.custom-headers-list-item{padding-left:5px}.editor-container{padding:5px 0 0 5px}.add-button{width:150px;margin:auto;margin-top:5px}\n/*# sourceURL=networkManageCustomHeadersView.css */\n");const di={manageHeaderColumns:"Manage Header Columns",noCustomHeaders:"No custom headers",addCustomHeader:"Add custom header…",headerName:"Header Name"},ci=i.i18n.registerUIStrings("panels/network/NetworkManageCustomHeadersView.ts",di),hi=i.i18n.getLocalizedString.bind(void 0,ci);class ui extends o.Widget.VBox{list;columnConfigs;addHeaderColumnCallback;changeHeaderColumnCallback;removeHeaderColumnCallback;editor;constructor(e,t,i,r){super(!0),this.contentElement.classList.add("custom-headers-wrapper"),this.contentElement.createChild("div","header").textContent=hi(di.manageHeaderColumns),this.list=new o.ListWidget.ListWidget(this),this.list.element.classList.add("custom-headers-list");const s=document.createElement("div");s.classList.add("custom-headers-list-list-empty"),s.textContent=hi(di.noCustomHeaders),this.list.setEmptyPlaceholder(s),this.list.show(this.contentElement),this.contentElement.appendChild(o.UIUtils.createTextButton(hi(di.addCustomHeader),this.addButtonClicked.bind(this),"add-button")),this.columnConfigs=new Map,e.forEach((e=>this.columnConfigs.set(e.title.toLowerCase(),e))),this.addHeaderColumnCallback=t,this.changeHeaderColumnCallback=i,this.removeHeaderColumnCallback=r,this.contentElement.tabIndex=0}wasShown(){this.headersUpdated(),this.list.registerCSSFiles([li]),this.registerCSSFiles([li])}headersUpdated(){this.list.clear(),this.columnConfigs.forEach((e=>this.list.appendItem({header:e.title},e.editable)))}addButtonClicked(){this.list.addNewItem(this.columnConfigs.size,{header:""})}renderItem(e,t){const i=document.createElement("div");i.classList.add("custom-headers-list-item");const r=i.createChild("div","custom-header-name");return r.textContent=e.header,o.Tooltip.Tooltip.install(r,e.header),i}removeItemRequested(e,t){this.removeHeaderColumnCallback(e.header),this.columnConfigs.delete(e.header.toLowerCase()),this.headersUpdated()}commitEdit(e,t,i){const r=t.control("header").value.trim();let o;o=i?this.addHeaderColumnCallback(r):this.changeHeaderColumnCallback(e.header,r),o&&!i&&this.columnConfigs.delete(e.header.toLowerCase()),o&&this.columnConfigs.set(r.toLowerCase(),{title:r,editable:!0}),this.headersUpdated()}beginEdit(e){const t=this.createEditor();return t.control("header").value=e.header,t}createEditor(){if(this.editor)return this.editor;const e=new o.ListWidget.Editor;this.editor=e;const t=e.contentElement();t.createChild("div","custom-headers-edit-row").createChild("div","custom-headers-header").textContent=hi(di.headerName);return t.createChild("div","custom-headers-edit-row").createChild("div","custom-headers-header").appendChild(e.createInput("header","text","x-custom-header",function(t,i,r){let o=!0;const s=e.control("header").value.trim().toLowerCase();this.columnConfigs.has(s)&&t.header!==s&&(o=!1);return{valid:o,errorMessage:void 0}}.bind(this))),e}}var pi=Object.freeze({__proto__:null,NetworkManageCustomHeadersView:ui});const gi=new CSSStyleSheet;gi.replaceSync(".network-waterfall-v-scroll{position:absolute;top:0;right:0;bottom:0;overflow-x:hidden;margin-top:31px;z-index:200}.-theme-with-dark-background .network-waterfall-v-scroll{background:rgb(0 0 0/1%)}.network-waterfall-v-scroll.small{margin-top:27px}.network-waterfall-v-scroll-content{width:15px;pointer-events:none}\n/*# sourceURL=networkWaterfallColumn.css */\n");const mi=M.RenderCoordinator.RenderCoordinator.instance();class wi extends w.TimelineOverviewPane.TimelineOverviewBase{selectedFilmStripTime;numBands;highlightedRequest;loadEvents;domContentLoadedEvents;nextBand;bandMap;requestsList;requestsSet;span;lastBoundary;constructor(){super(),this.selectedFilmStripTime=-1,this.element.classList.add("network-overview"),this.numBands=1,this.highlightedRequest=null,n.TargetManager.TargetManager.instance().addModelListener(n.ResourceTreeModel.ResourceTreeModel,n.ResourceTreeModel.Events.Load,this.loadEventFired,this,{scoped:!0}),n.TargetManager.TargetManager.instance().addModelListener(n.ResourceTreeModel.ResourceTreeModel,n.ResourceTreeModel.Events.DOMContentLoaded,this.domContentLoadedEventFired,this,{scoped:!0}),this.reset()}setHighlightedRequest(e){this.highlightedRequest=e,this.scheduleUpdate()}selectFilmStripFrame(e){this.selectedFilmStripTime=e,this.scheduleUpdate()}clearFilmStripFrame(){this.selectedFilmStripTime=-1,this.scheduleUpdate()}loadEventFired(e){const t=e.data.loadTime;t&&this.loadEvents.push(1e3*t),this.scheduleUpdate()}domContentLoadedEventFired(e){const{data:t}=e;t&&this.domContentLoadedEvents.push(1e3*t),this.scheduleUpdate()}bandId(e){if(!e||"0"===e)return-1;if(this.bandMap.has(e))return this.bandMap.get(e);const t=this.nextBand++;return this.bandMap.set(e,t),t}updateRequest(e){this.requestsSet.has(e)||(this.requestsSet.add(e),this.requestsList.push(e)),this.scheduleUpdate()}wasShown(){this.onResize()}calculator(){return super.calculator()}onResize(){const e=this.element.offsetWidth,t=this.element.offsetHeight;this.calculator().setDisplayWidth(e),this.resetCanvas();const i=(t-vi-1)/bi-1|0;this.numBands=i>0?i:1,this.scheduleUpdate()}reset(){this.span=1,this.lastBoundary=null,this.nextBand=0,this.bandMap=new Map,this.requestsList=[],this.requestsSet=new Set,this.loadEvents=[],this.domContentLoadedEvents=[],this.resetCanvas()}scheduleUpdate(){this.isShowing()&&mi.write("NetworkOverview.render",this.update.bind(this))}update(){const e=this.calculator(),t=new Tt(e.minimumBoundary(),e.maximumBoundary());if(!this.lastBoundary||!t.equals(this.lastBoundary)){const t=e.boundarySpan();for(;this.span<t;)this.span*=1.25;e.setBounds(e.minimumBoundary(),E.Types.Timing.MilliSeconds(e.minimumBoundary()+this.span)),this.lastBoundary=new Tt(e.minimumBoundary(),e.maximumBoundary())}const i=this.context(),r=new Map,o=vi;function s(t){const s=r.get(t);if(!s)return;const n=s.length;i.beginPath(),i.strokeStyle=H.ThemeSupport.instance().getComputedValue("--color-background-opacity-80"),i.lineWidth=Si,i.fillStyle=H.ThemeSupport.instance().getComputedValue(ki[t]);for(let t=0;t<n;){const r=s[t++]*bi+o,n=s[t++];let a=s[t++];a===Number.MAX_VALUE&&(a=e.maximumBoundary());const l=e.computePosition(E.Types.Timing.MilliSeconds(n)),d=e.computePosition(E.Types.Timing.MilliSeconds(a))+1;i.fillRect(l,r,Math.max(d-l,fi),bi),i.strokeRect(l,r,Math.max(d-l,fi),bi)}}function n(e,t,i,o){let s=r.get(e);s||(s=[],r.set(e,s)),s.push(t,i,o)}const a=this.requestsList,l=a.length;for(let e=0;e<l;++e){const t=a[e],i=this.bandId(t.connectionId),r=-1===i?0:i%this.numBands+1,o=Bt.calculateRequestTimeRanges(t,this.calculator().minimumBoundary());for(let e=0;e<o.length;++e){const t=o[e].name;-1===i&&t!==Ut.Total||n(t,r,1e3*o[e].start,1e3*o[e].end)}}if(i.clearRect(0,0,this.width(),this.height()),i.save(),i.scale(window.devicePixelRatio,window.devicePixelRatio),i.lineWidth=2,s(Ut.Total),s(Ut.Blocking),s(Ut.Connecting),s(Ut.ServiceWorker),s(Ut.ServiceWorkerPreparation),s(Ut.ServiceWorkerRespondWith),s(Ut.Push),s(Ut.Proxy),s(Ut.DNS),s(Ut.SSL),s(Ut.Sending),s(Ut.Waiting),s(Ut.Receiving),this.highlightedRequest){const t=5,r=2,s=this.highlightedRequest,n=this.bandId(s.connectionId),a=(-1===n?0:n%this.numBands+1)*bi+o,l=Bt.calculateRequestTimeRanges(s,this.calculator().minimumBoundary());i.fillStyle=H.ThemeSupport.instance().getComputedValue("--sys-color-tonal-container");const d=E.Types.Timing.MilliSeconds(1e3*l[0].start),c=E.Types.Timing.MilliSeconds(1e3*l[0].end);i.fillRect(e.computePosition(d)-r,a-t/2-r,e.computePosition(c)-e.computePosition(d)+1+2*r,t*r);for(let r=0;r<l.length;++r){const o=l[r].name;if(-1!==n||o===Ut.Total){i.beginPath(),i.strokeStyle=H.ThemeSupport.instance().getComputedValue(ki[o]),i.lineWidth=t;const s=E.Types.Timing.MilliSeconds(1e3*l[r].start),n=E.Types.Timing.MilliSeconds(1e3*l[r].end);i.moveTo(e.computePosition(s)-0,a),i.lineTo(e.computePosition(n)+1,a),i.stroke()}}}const d=this.element.offsetHeight;i.lineWidth=1,i.beginPath(),i.strokeStyle=H.ThemeSupport.instance().getComputedValue(Di.getDCLEventColor());for(let t=this.domContentLoadedEvents.length-1;t>=0;--t){const r=e.computePosition(E.Types.Timing.MilliSeconds(this.domContentLoadedEvents[t])),o=Math.round(r)+.5;i.moveTo(o,0),i.lineTo(o,d)}i.stroke(),i.beginPath(),i.strokeStyle=H.ThemeSupport.instance().getComputedValue(Di.getLoadEventColor());for(let t=this.loadEvents.length-1;t>=0;--t){const r=e.computePosition(E.Types.Timing.MilliSeconds(this.loadEvents[t])),o=Math.round(r)+.5;i.moveTo(o,0),i.lineTo(o,d)}if(i.stroke(),-1!==this.selectedFilmStripTime){i.lineWidth=2,i.beginPath(),i.strokeStyle=H.ThemeSupport.instance().getComputedValue("--network-frame-divider-color");const t=E.Types.Timing.MilliSeconds(this.selectedFilmStripTime),r=Math.round(e.computePosition(t));i.moveTo(r,0),i.lineTo(r,d),i.stroke()}i.restore()}}const ki={[Ut.Total]:"--network-overview-total",[Ut.Blocking]:"--network-overview-blocking",[Ut.Connecting]:"--network-overview-connecting",[Ut.ServiceWorker]:"--network-overview-service-worker",[Ut.ServiceWorkerPreparation]:"--network-overview-service-worker",[Ut.ServiceWorkerRespondWith]:"--network-overview-service-worker-respond-with",[Ut.Push]:"--network-overview-push",[Ut.Proxy]:"--override-network-overview-proxy",[Ut.DNS]:"--network-overview-dns",[Ut.SSL]:"--network-overview-ssl",[Ut.Sending]:"--override-network-overview-sending",[Ut.Waiting]:"--network-overview-waiting",[Ut.Receiving]:"--network-overview-receiving",[Ut.Queueing]:"--network-overview-queueing"},bi=3,vi=5,fi=10,Si=1;var Ci=Object.freeze({__proto__:null,NetworkOverview:wi,RequestTimeRangeNameToColor:ki});const yi=M.RenderCoordinator.RenderCoordinator.instance();class Ti extends o.Widget.VBox{canvas;canvasPosition;leftPadding;fontSize;rightPadding;scrollTop;headerHeight;calculator;rawRowHeight;rowHeight;offsetWidth;offsetHeight;startTime;endTime;popoverHelper;nodes;hoveredNode;eventDividers;styleForTimeRangeName;styleForWaitingResourceType;styleForDownloadingResourceType;wiskerStyle;hoverDetailsStyle;pathForStyle;textLayers;constructor(e){super(!1),this.canvas=this.contentElement.createChild("canvas"),this.canvas.tabIndex=-1,this.setDefaultFocusedElement(this.canvas),this.canvasPosition=this.canvas.getBoundingClientRect(),this.leftPadding=5,this.fontSize=10,this.rightPadding=0,this.scrollTop=0,this.headerHeight=0,this.calculator=e,this.rawRowHeight=0,this.rowHeight=0,this.offsetWidth=0,this.offsetHeight=0,this.startTime=this.calculator.minimumBoundary(),this.endTime=this.calculator.maximumBoundary(),this.popoverHelper=new o.PopoverHelper.PopoverHelper(this.element,this.getPopoverRequest.bind(this)),this.popoverHelper.setHasPadding(!0),this.popoverHelper.setTimeout(300,300),this.nodes=[],this.hoveredNode=null,this.eventDividers=new Map,this.element.addEventListener("mousemove",this.onMouseMove.bind(this),!0),this.element.addEventListener("mouseleave",(e=>this.setHoveredNode(null,!1)),!0),this.element.addEventListener("click",this.onClick.bind(this),!0),this.styleForTimeRangeName=Ti.buildRequestTimeRangeStyle();const t=Ti.buildResourceTypeStyle();this.styleForWaitingResourceType=t[0],this.styleForDownloadingResourceType=t[1];const i=H.ThemeSupport.instance().getComputedValue("--sys-color-state-disabled");this.wiskerStyle={borderColor:i,lineWidth:1,fillStyle:void 0},this.hoverDetailsStyle={fillStyle:i,lineWidth:1,borderColor:i},this.pathForStyle=new Map,this.textLayers=[]}static buildRequestTimeRangeStyle(){const e=Ut,t=new Map;return t.set(e.Connecting,{fillStyle:ki[e.Connecting]}),t.set(e.SSL,{fillStyle:ki[e.SSL]}),t.set(e.DNS,{fillStyle:ki[e.DNS]}),t.set(e.Proxy,{fillStyle:ki[e.Proxy]}),t.set(e.Blocking,{fillStyle:ki[e.Blocking]}),t.set(e.Push,{fillStyle:ki[e.Push]}),t.set(e.Queueing,{fillStyle:ki[e.Queueing],lineWidth:2,borderColor:"lightgrey"}),t.set(e.Receiving,{fillStyle:ki[e.Receiving],lineWidth:2,borderColor:"#03A9F4"}),t.set(e.Waiting,{fillStyle:ki[e.Waiting]}),t.set(e.ReceivingPush,{fillStyle:ki[e.ReceivingPush]}),t.set(e.ServiceWorker,{fillStyle:ki[e.ServiceWorker]}),t.set(e.ServiceWorkerPreparation,{fillStyle:ki[e.ServiceWorkerPreparation]}),t.set(e.ServiceWorkerRespondWith,{fillStyle:ki[e.ServiceWorkerRespondWith]}),t}static buildResourceTypeStyle(){const t=new Map([["document","hsl(215, 100%, 80%)"],["font","hsl(8, 100%, 80%)"],["media","hsl(90, 50%, 80%)"],["image","hsl(90, 50%, 80%)"],["script","hsl(31, 100%, 80%)"],["stylesheet","hsl(272, 64%, 80%)"],["texttrack","hsl(8, 100%, 80%)"],["websocket","hsl(0, 0%, 95%)"],["xhr","hsl(53, 100%, 80%)"],["fetch","hsl(53, 100%, 80%)"],["other","hsl(0, 0%, 95%)"]]),i=new Map,r=new Map;for(const n of Object.values(e.ResourceType.resourceTypes)){let e=t.get(n.name());e||(e=t.get("other"));const a=o(e);i.set(n,{fillStyle:s(e),lineWidth:1,borderColor:a}),r.set(n,{fillStyle:e,lineWidth:1,borderColor:a})}return[i,r];function o(t){const i=e.Color.parse(t)?.as("hsl");if(!i)return"";let{s:r,l:o}=i;return r/=2,o-=Math.min(o,.2),new e.Color.HSL(i.h,r,o,i.alpha).asString()}function s(t){const i=e.Color.parse(t)?.as("hsl");if(!i)return"";let{l:r}=i;return r*=1.1,new e.Color.HSL(i.h,i.s,r,i.alpha).asString()}}resetPaths(){this.pathForStyle.clear(),this.pathForStyle.set(this.wiskerStyle,new Path2D),this.styleForTimeRangeName.forEach((e=>this.pathForStyle.set(e,new Path2D))),this.styleForWaitingResourceType.forEach((e=>this.pathForStyle.set(e,new Path2D))),this.styleForDownloadingResourceType.forEach((e=>this.pathForStyle.set(e,new Path2D))),this.pathForStyle.set(this.hoverDetailsStyle,new Path2D)}willHide(){this.popoverHelper.hidePopover()}wasShown(){this.update(),this.registerCSSFiles([gi])}onMouseMove(e){this.setHoveredNode(this.getNodeFromPoint(e.offsetX,e.offsetY),e.shiftKey)}onClick(e){this.setSelectedNode(this.getNodeFromPoint(e.offsetX,e.offsetY))&&e.consume(!0)}getPopoverRequest(t){if(!this.hoveredNode)return null;const i=this.hoveredNode.request();if(!i)return null;let r,o,s;if(!e.Settings.Settings.instance().moduleSetting("networkColorCodeResourceTypes").get()&&!this.calculator.startAtZero?(r=Bt.calculateRequestTimeRanges(i,0).find((e=>e.name===Ut.Total)),o=this.timeToPosition(r.start),s=this.timeToPosition(r.end)):(r=this.getSimplifiedBarRange(i,0),o=r.start,s=r.end),s-o<50){const e=(s-o)/2;o=o+e-25,s=s-e+25}if(t.clientX<this.canvasPosition.left+o||t.clientX>this.canvasPosition.left+s)return null;const n=this.nodes.findIndex((e=>e.hovered())),a=this.getBarHeight(r.name),l=this.headerHeight+(this.rowHeight*n-this.scrollTop)+(this.rowHeight-a)/2;if(t.clientY<this.canvasPosition.top+l||t.clientY>this.canvasPosition.top+l+a)return null;const d=this.element.boxInWindow();return d.x+=o,d.y+=l,d.width=s-o,d.height=a,{box:d,show:e=>{const t=Bt.createTimingTable(i,this.calculator);return e.registerCSSFiles([Pt]),e.contentElement.appendChild(t),Promise.resolve(!0)},hide:void 0}}setHoveredNode(e,t){this.hoveredNode&&this.hoveredNode.setHovered(!1,!1),this.hoveredNode=e,this.hoveredNode&&this.hoveredNode.setHovered(!0,t)}setSelectedNode(e){return!(!e||!e.dataGrid)&&(e.select(),e.dataGrid.element.focus(),!0)}setRowHeight(e){this.rawRowHeight=e,this.updateRowHeight()}updateRowHeight(){this.rowHeight=Math.round(this.rawRowHeight*window.devicePixelRatio)/window.devicePixelRatio}setHeaderHeight(e){this.headerHeight=e}setRightPadding(e){this.rightPadding=e,this.calculateCanvasSize()}setCalculator(e){this.calculator=e}getNodeFromPoint(e,t){return t<=this.headerHeight?null:this.nodes[Math.floor((this.scrollTop+t-this.headerHeight)/this.rowHeight)]}scheduleDraw(){yi.write("NetworkWaterfallColumn.render",(()=>this.update()))}update(e,t,i){void 0!==e&&this.scrollTop!==e&&(this.popoverHelper.hidePopover(),this.scrollTop=e),i&&(this.nodes=i,this.calculateCanvasSize()),void 0!==t&&(this.eventDividers=t),this.startTime=this.calculator.minimumBoundary(),this.endTime=this.calculator.maximumBoundary(),this.resetCanvas(),this.resetPaths(),this.textLayers=[],this.draw()}resetCanvas(){const e=window.devicePixelRatio;this.canvas.width=this.offsetWidth*e,this.canvas.height=this.offsetHeight*e,this.canvas.style.width=this.offsetWidth+"px",this.canvas.style.height=this.offsetHeight+"px"}onResize(){super.onResize(),this.updateRowHeight(),this.calculateCanvasSize(),this.scheduleDraw()}calculateCanvasSize(){this.offsetWidth=this.contentElement.offsetWidth-this.rightPadding,this.offsetHeight=this.contentElement.offsetHeight,this.calculator.setDisplayWidth(this.offsetWidth),this.canvasPosition=this.canvas.getBoundingClientRect()}timeToPosition(e){const t=(this.offsetWidth-this.leftPadding)/(this.endTime-this.startTime);return Math.floor(this.leftPadding+(e-this.startTime)*t)}didDrawForTest(){}draw(){const t=!e.Settings.Settings.instance().moduleSetting("networkColorCodeResourceTypes").get()&&!this.calculator.startAtZero,i=this.nodes,r=this.canvas.getContext("2d");if(!r)return;r.save(),r.scale(window.devicePixelRatio,window.devicePixelRatio),r.translate(0,this.headerHeight),r.rect(0,0,this.offsetWidth,this.offsetHeight),r.clip();const o=Math.floor(this.scrollTop/this.rowHeight),s=Math.min(i.length,o+Math.ceil(this.offsetHeight/this.rowHeight));for(let e=o;e<s;e++){const o=this.rowHeight*e,s=i[e];this.decorateRow(r,s,o-this.scrollTop);let n=[];s.hasChildren()&&!s.expanded&&(n=s.flatChildren()),n.push(s);for(const e of n)t?this.buildTimingBarLayers(e,o-this.scrollTop):this.buildSimplifiedBarLayers(r,e,o-this.scrollTop)}this.drawLayers(r,t),r.save(),r.fillStyle=H.ThemeSupport.instance().getComputedValue("--sys-color-state-disabled");for(const e of this.textLayers)r.fillText(e.text,e.x,e.y);r.restore(),this.drawEventDividers(r),r.restore();const n=w.TimelineGrid.TimelineGrid.calculateGridOffsets(this.calculator);w.TimelineGrid.TimelineGrid.drawCanvasGrid(r,n),w.TimelineGrid.TimelineGrid.drawCanvasHeaders(r,n,(e=>this.calculator.formatValue(e,n.precision)),this.fontSize,this.headerHeight,75),r.save(),r.scale(window.devicePixelRatio,window.devicePixelRatio),r.clearRect(this.offsetWidth-18,0,18,this.headerHeight),r.restore(),this.didDrawForTest()}drawLayers(e,t){for(const i of this.pathForStyle){const r=i[0],o=i[1];e.save(),e.beginPath(),r.lineWidth&&(e.lineWidth=r.lineWidth,r.borderColor&&(e.strokeStyle=r.borderColor),e.stroke(o)),r.fillStyle&&(e.fillStyle=t?H.ThemeSupport.instance().getComputedValue(r.fillStyle):r.fillStyle,e.fill(o)),e.restore()}}drawEventDividers(e){e.save(),e.lineWidth=1;for(const t of this.eventDividers.keys()){e.strokeStyle=t;for(const i of this.eventDividers.get(t)||[]){e.beginPath();const t=this.timeToPosition(i);e.moveTo(t,0),e.lineTo(t,this.offsetHeight)}e.stroke()}e.restore()}getBarHeight(e){const t=Ut;switch(e){case t.Connecting:case t.SSL:case t.DNS:case t.Proxy:case t.Blocking:case t.Push:case t.Queueing:return 7;default:return 13}}getSimplifiedBarRange(e,t){const i=this.offsetWidth-this.leftPadding,r=this.calculator.computeBarGraphPercentages(e);return{start:this.leftPadding+Math.floor(r.start/100*i)+t,mid:this.leftPadding+Math.floor(r.middle/100*i)+t,end:this.leftPadding+Math.floor(r.end/100*i)+t}}buildSimplifiedBarLayers(e,t,i){const r=t.request();if(!r)return;const o=.5,s=this.getSimplifiedBarRange(r,o),n=this.getBarHeight();i+=Math.floor(this.rowHeight/2-n/2+1)-.5;const a=this.styleForWaitingResourceType.get(r.resourceType());this.pathForStyle.get(a).rect(s.start,i,s.mid-s.start,n-1);const l=Math.max(2,s.end-s.mid),d=this.styleForDownloadingResourceType.get(r.resourceType());this.pathForStyle.get(d).rect(s.mid,i,l,n-1);let c=null;if(t.hovered()){c=this.calculator.computeBarGraphLabels(r);const t=10,a=e.measureText(c.left).width,d=e.measureText(c.right).width,h=this.pathForStyle.get(this.hoverDetailsStyle);if(a<s.mid-s.start){const e=s.start+(s.mid-s.start-a)/2;this.textLayers.push({text:c.left,x:e,y:i+this.fontSize})}else t+a+this.leftPadding<s.start&&(this.textLayers.push({text:c.left,x:s.start-a-t-1,y:i+this.fontSize}),h.moveTo(s.start-t,i+Math.floor(n/2)),h.arc(s.start,i+Math.floor(n/2),2,0,2*Math.PI),h.moveTo(s.start-t,i+Math.floor(n/2)),h.lineTo(s.start,i+Math.floor(n/2)));const u=s.mid+l+o;if(d<u-s.mid){const e=s.mid+(u-s.mid-d)/2;this.textLayers.push({text:c.right,x:e,y:i+this.fontSize})}else u+t+d<this.offsetWidth-this.leftPadding&&(this.textLayers.push({text:c.right,x:u+t+1,y:i+this.fontSize}),h.moveTo(u,i+Math.floor(n/2)),h.arc(u,i+Math.floor(n/2),2,0,2*Math.PI),h.moveTo(u,i+Math.floor(n/2)),h.lineTo(u+t,i+Math.floor(n/2)))}if(!this.calculator.startAtZero){const t=Bt.calculateRequestTimeRanges(r,0).find((e=>e.name===Ut.Total)),a=c?e.measureText(c.left).width:0,l=a<s.mid-s.start,d=c&&!l?a+13:0,h=this.timeToPosition(t.start);if(s.start-d>h){const e=this.pathForStyle.get(this.wiskerStyle);e.moveTo(h,i+Math.floor(n/2)),e.lineTo(s.start-d,i+Math.floor(n/2));const t=n/2;e.moveTo(h+o,i+t/2),e.lineTo(h+o,i+n-t/2-1)}}}buildTimingBarLayers(e,t){const i=e.request();if(!i)return;const r=Bt.calculateRequestTimeRanges(i,0);let o=0;for(const e of r){if(e.name===Ut.Total||e.name===Ut.Sending||e.end-e.start==0)continue;const i=this.styleForTimeRangeName.get(e.name),r=this.pathForStyle.get(i),s=i.lineWidth||0,n=this.getBarHeight(e.name),a=t+Math.floor(this.rowHeight/2-n/2)+s/2,l=this.timeToPosition(e.start),d=this.timeToPosition(e.end);r.rect(l+1*o,a,d-l,n-s),o++}}decorateRow(e,t,i){const r=t.backgroundColor();e.save(),e.beginPath(),e.fillStyle=H.ThemeSupport.instance().getComputedValue(r),e.rect(0,i,this.offsetWidth,this.rowHeight),e.fill(),e.restore()}}var Ri=Object.freeze({__proto__:null,NetworkWaterfallColumn:Ti});const Ii={networkLog:"Network Log",waterfall:"Waterfall",responseHeaders:"Response Headers",manageHeaderColumns:"Manage Header Columns…",startTime:"Start Time",responseTime:"Response Time",endTime:"End Time",totalDuration:"Total Duration",latency:"Latency",name:"Name",path:"Path",url:"Url",method:"Method",status:"Status",text:"Text",protocol:"Protocol",scheme:"Scheme",domain:"Domain",remoteAddress:"Remote Address",type:"Type",initiator:"Initiator",hasOverrides:"Has overrides",initiatorAddressSpace:"Initiator Address Space",cookies:"Cookies",setCookies:"Set Cookies",size:"Size",content:"Content",time:"Time",priority:"Priority",connectionId:"Connection ID",remoteAddressSpace:"Remote Address Space"},xi=i.i18n.registerUIStrings("panels/network/NetworkLogViewColumns.ts",Ii),qi=i.i18n.getLocalizedString.bind(void 0,xi),Fi=i.i18n.getLazilyComputedLocalizedString.bind(void 0,xi);class Li{networkLogView;persistantSettings;networkLogLargeRowsSetting;eventDividers;eventDividersShown;gridMode;columns;waterfallRequestsAreStale;waterfallScrollerWidthIsStale;popupLinkifier;calculatorsMap;lastWheelTime;dataGridInternal;splitWidget;waterfallColumn;activeScroller;dataGridScroller;waterfallScroller;waterfallScrollerContent;waterfallHeaderElement;waterfallColumnSortIcon;activeWaterfallSortId;popoverHelper;hasScrollerTouchStarted;scrollerTouchStartPos;constructor(t,i,r,o){this.networkLogView=t,this.persistantSettings=e.Settings.Settings.instance().createSetting("networkLogColumns",{}),this.networkLogLargeRowsSetting=o,this.networkLogLargeRowsSetting.addChangeListener(this.updateRowsSize,this),this.eventDividers=new Map,this.eventDividersShown=!1,this.gridMode=!0,this.columns=[],this.waterfallRequestsAreStale=!1,this.waterfallScrollerWidthIsStale=!0,this.popupLinkifier=new k.Linkifier.Linkifier,this.calculatorsMap=new Map,this.calculatorsMap.set(Mi.Time,i),this.calculatorsMap.set(Mi.Duration,r),this.lastWheelTime=0,this.setupDataGrid(),this.setupWaterfall(),H.ThemeSupport.instance().addEventListener(H.ThemeChangeEvent.eventName,(()=>{this.scheduleRefresh()}))}static convertToDataGridDescriptor(e){const t=e.title instanceof Function?e.title():e.title;return{id:e.id,title:t,sortable:e.sortable,align:e.align,nonSelectable:e.nonSelectable,weight:e.weight,allowInSortByEvenWhenHidden:e.allowInSortByEvenWhenHidden}}wasShown(){this.updateRowsSize()}willHide(){this.popoverHelper&&this.popoverHelper.hidePopover()}reset(){this.popoverHelper&&this.popoverHelper.hidePopover(),this.eventDividers.clear()}setupDataGrid(){const e=Ei,t=Hi;this.columns=[];for(const i of e){const e=Object.assign({},t,i);if(e.id=e.id,e.subtitle){const t=e.title instanceof Function?e.title():e.title,i=e.subtitle instanceof Function?e.subtitle():e.subtitle;e.titleDOMFragment=this.makeHeaderFragment(t,i)}this.columns.push(e)}this.loadCustomColumnsAndSettings(),this.popoverHelper=new o.PopoverHelper.PopoverHelper(this.networkLogView.element,this.getPopoverRequest.bind(this)),this.popoverHelper.setHasPadding(!0),this.popoverHelper.setTimeout(300,300),this.dataGridInternal=new d.SortableDataGrid.SortableDataGrid({displayName:qi(Ii.networkLog),columns:this.columns.map(Li.convertToDataGridDescriptor),editCallback:void 0,deleteCallback:void 0,refreshCallback:void 0}),this.dataGridInternal.element.addEventListener("mousedown",(e=>{!this.dataGridInternal.selectedNode&&e.button&&e.consume()}),!0),this.dataGridScroller=this.dataGridInternal.scrollContainer,this.updateColumns(),this.dataGridInternal.addEventListener(d.DataGrid.Events.SortingChanged,this.sortHandler,this),this.dataGridInternal.setHeaderContextMenuCallback(this.innerHeaderContextMenu.bind(this)),this.activeWaterfallSortId=Ui.StartTime,this.dataGridInternal.markColumnAsSortedBy(Pi,d.DataGrid.Order.Ascending),this.splitWidget=new o.SplitWidget.SplitWidget(!0,!0,"networkPanelSplitViewWaterfall",200);const i=this.dataGridInternal.asWidget();i.setMinimumSize(150,0),this.splitWidget.setMainWidget(i)}setupWaterfall(){this.waterfallColumn=new Ti(this.networkLogView.calculator()),this.waterfallColumn.element.addEventListener("contextmenu",function(e){const t=e,i=this.waterfallColumn.getNodeFromPoint(t.offsetX,t.offsetY);if(!i)return;const r=i.request();if(!r)return;const s=new o.ContextMenu.ContextMenu(t);this.networkLogView.handleContextMenuForRequest(s,r),s.show()}.bind(this)),this.waterfallColumn.element.addEventListener("wheel",this.onMouseWheel.bind(this,!1),{passive:!0}),this.waterfallColumn.element.addEventListener("touchstart",this.onTouchStart.bind(this)),this.waterfallColumn.element.addEventListener("touchmove",this.onTouchMove.bind(this)),this.waterfallColumn.element.addEventListener("touchend",this.onTouchEnd.bind(this)),this.dataGridScroller.addEventListener("wheel",this.onMouseWheel.bind(this,!0),!0),this.dataGridScroller.addEventListener("touchstart",this.onTouchStart.bind(this)),this.dataGridScroller.addEventListener("touchmove",this.onTouchMove.bind(this)),this.dataGridScroller.addEventListener("touchend",this.onTouchEnd.bind(this)),this.waterfallScroller=this.waterfallColumn.contentElement.createChild("div","network-waterfall-v-scroll"),this.waterfallScrollerContent=this.waterfallScroller.createChild("div","network-waterfall-v-scroll-content"),this.dataGridInternal.addEventListener(d.DataGrid.Events.PaddingChanged,(()=>{this.waterfallScrollerWidthIsStale=!0,this.syncScrollers()})),this.dataGridInternal.addEventListener(d.ViewportDataGrid.Events.ViewportCalculated,this.redrawWaterfallColumn.bind(this)),this.createWaterfallHeader(),this.waterfallColumn.contentElement.classList.add("network-waterfall-view"),this.waterfallColumn.setMinimumSize(100,0),this.splitWidget.setSidebarWidget(this.waterfallColumn),this.switchViewMode(!1)}onMouseWheel(e,t){e&&t.consume(!0);const i=t,r=Date.now()-this.lastWheelTime<80;this.activeScroller.scrollBy({top:i.deltaY,behavior:r?"auto":"smooth"}),this.syncScrollers(),this.lastWheelTime=Date.now()}onTouchStart(e){const t=e;this.hasScrollerTouchStarted=!0,this.scrollerTouchStartPos=t.changedTouches[0].pageY}onTouchMove(e){if(!this.hasScrollerTouchStarted)return;const t=e.changedTouches[0].pageY,i=this.scrollerTouchStartPos-t;this.activeScroller.scrollBy({top:i,behavior:"auto"}),this.syncScrollers(),this.scrollerTouchStartPos=t}onTouchEnd(){this.hasScrollerTouchStarted=!1}syncScrollers(){this.waterfallColumn.isShowing()&&(this.waterfallScrollerContent.style.height=this.dataGridScroller.scrollHeight-this.dataGridInternal.headerHeight()+"px",this.updateScrollerWidthIfNeeded(),this.dataGridScroller.scrollTop=this.waterfallScroller.scrollTop)}updateScrollerWidthIfNeeded(){this.waterfallScrollerWidthIsStale&&(this.waterfallScrollerWidthIsStale=!1,this.waterfallColumn.setRightPadding(this.waterfallScroller.offsetWidth-this.waterfallScrollerContent.offsetWidth))}redrawWaterfallColumn(){if(!this.waterfallRequestsAreStale)return this.updateScrollerWidthIfNeeded(),void this.waterfallColumn.update(this.activeScroller.scrollTop,this.eventDividersShown?this.eventDividers:void 0);this.syncScrollers();const e=this.networkLogView.flatNodesList();this.waterfallColumn.update(this.activeScroller.scrollTop,this.eventDividers,e)}createWaterfallHeader(){this.waterfallHeaderElement=this.waterfallColumn.contentElement.createChild("div","network-waterfall-header"),this.waterfallHeaderElement.setAttribute("jslog",`${l.tableHeader().track({click:!0}).context("waterfall")}`),this.waterfallHeaderElement.addEventListener("click",function(){const e=d.DataGrid.Order,t="waterfall"===this.dataGridInternal.sortColumnId(),i=this.dataGridInternal.isSortOrderAscending(),r=t&&i?e.Descending:e.Ascending;this.dataGridInternal.markColumnAsSortedBy("waterfall",r),this.sortHandler()}.bind(this)),this.waterfallHeaderElement.addEventListener("contextmenu",(e=>this.innerHeaderContextMenu(new o.ContextMenu.ContextMenu(e)))),this.waterfallHeaderElement.createChild("div","hover-layer");this.waterfallHeaderElement.createChild("div").textContent=qi(Ii.waterfall),this.waterfallColumnSortIcon=new m.Icon.Icon,this.waterfallColumnSortIcon.className="sort-order-icon",this.waterfallHeaderElement.createChild("div","sort-order-icon-container").appendChild(this.waterfallColumnSortIcon)}setCalculator(e){this.waterfallColumn.setCalculator(e)}scheduleRefresh(){this.waterfallColumn.scheduleDraw()}updateRowsSize(){const e=Boolean(this.networkLogLargeRowsSetting.get());this.dataGridInternal.element.classList.toggle("small",!e),this.dataGridInternal.scheduleUpdate(),this.waterfallScrollerWidthIsStale=!0,this.waterfallColumn.setRowHeight(e?41:21),this.waterfallScroller.classList.toggle("small",!e),this.waterfallHeaderElement.classList.toggle("small",!e),window.requestAnimationFrame((()=>{this.waterfallColumn.setHeaderHeight(this.waterfallScroller.offsetTop),this.waterfallColumn.scheduleDraw()}))}show(e){this.splitWidget.show(e)}setHidden(e){o.ARIAUtils.setHidden(this.splitWidget.element,e)}dataGrid(){return this.dataGridInternal}sortByCurrentColumn(){this.sortHandler()}sortHandler(){const e=this.dataGridInternal.sortColumnId();if(this.networkLogView.removeAllNodeHighlights(),this.waterfallRequestsAreStale=!0,"waterfall"===e){this.dataGridInternal.sortOrder()===d.DataGrid.Order.Ascending?this.waterfallColumnSortIcon.name="triangle-up":this.waterfallColumnSortIcon.name="triangle-down",this.waterfallColumnSortIcon.hidden=!1;const e=ve.RequestPropertyComparator.bind(null,this.activeWaterfallSortId);return this.dataGridInternal.sortNodes(e,!this.dataGridInternal.isSortOrderAscending()),void this.dataGridSortedForTest()}this.waterfallColumnSortIcon.hidden=!0,this.waterfallColumnSortIcon.name=null;const t=this.columns.find((t=>t.id===e));if(!t||!t.sortingFunction)return;const i=t.sortingFunction;i&&(this.dataGridInternal.sortNodes(i,!this.dataGridInternal.isSortOrderAscending()),this.dataGridSortedForTest())}dataGridSortedForTest(){}updateColumns(){if(!this.dataGridInternal)return;const e=new Set;if(this.gridMode)for(const t of this.columns)t.visible&&e.add(t.id);else{const t=this.columns.find((e=>"path"===e.hideableGroup&&e.visible));t?e.add(t.id):e.add("name")}this.dataGridInternal.setColumnsVisiblity(e)}switchViewMode(e){this.gridMode!==e&&(this.gridMode=e,e?(this.splitWidget.showBoth(),this.activeScroller=this.waterfallScroller,this.waterfallScroller.scrollTop=this.dataGridScroller.scrollTop,this.dataGridInternal.setScrollContainer(this.waterfallScroller)):(this.networkLogView.removeAllNodeHighlights(),this.splitWidget.hideSidebar(),this.activeScroller=this.dataGridScroller,this.dataGridInternal.setScrollContainer(this.dataGridScroller)),this.networkLogView.element.classList.toggle("brief-mode",!e),this.updateColumns(),this.updateRowsSize())}toggleColumnVisibility(e){this.loadCustomColumnsAndSettings(),e.visible=!e.visible,this.saveColumnsSettings(),this.updateColumns()}saveColumnsSettings(){const e={};for(const t of this.columns)e[t.id]={visible:t.visible,title:t.title};this.persistantSettings.set(e)}loadCustomColumnsAndSettings(){const e=this.persistantSettings.get(),t=Object.keys(e);for(const i of t){const t=e[i];let r=this.columns.find((e=>e.id===i));r||(r=this.addCustomHeader(t.title,i)||void 0),r&&r.hideable&&"boolean"==typeof t.visible&&(r.visible=Boolean(t.visible)),r&&"string"==typeof t.title&&(r.title=t.title)}}makeHeaderFragment(e,t){const i=document.createDocumentFragment();o.UIUtils.createTextChild(i,e);const r=i.createChild("div","network-header-subtitle");return o.UIUtils.createTextChild(r,t),i}innerHeaderContextMenu(e){const t=this.columns.filter((e=>e.hideable)),i=t.filter((e=>!e.isResponseHeader)),r=new Map,o=[];for(const e of i)if(e.hideableGroup){const t=e.hideableGroup;let i=r.get(t);i||(i=[],r.set(t,i)),i.push(e)}else o.push(e);for(const t of r.values()){const i=t.filter((e=>e.visible));for(const r of t){const t=1===i.length&&i[0]===r,o=r.title instanceof Function?r.title():r.title;e.headerSection().appendCheckboxItem(o,this.toggleColumnVisibility.bind(this,r),r.visible,t)}e.headerSection().appendSeparator()}for(const t of o){const i=t.title instanceof Function?t.title():t.title;e.headerSection().appendCheckboxItem(i,this.toggleColumnVisibility.bind(this,t),t.visible)}const s=e.footerSection().appendSubMenuItem(qi(Ii.responseHeaders)),n=t.filter((e=>e.isResponseHeader));for(const e of n){const t=e.title instanceof Function?e.title():e.title;s.defaultSection().appendCheckboxItem(t,this.toggleColumnVisibility.bind(this,e),e.visible)}s.footerSection().appendItem(qi(Ii.manageHeaderColumns),this.manageCustomHeaderDialog.bind(this));const a=Ui,l=e.footerSection().appendSubMenuItem(qi(Ii.waterfall));function c(e){let t=this.calculatorsMap.get(Mi.Time);const i=Ui;e!==i.Duration&&e!==i.Latency||(t=this.calculatorsMap.get(Mi.Duration)),this.networkLogView.setCalculator(t),this.activeWaterfallSortId=e,this.dataGridInternal.markColumnAsSortedBy("waterfall",d.DataGrid.Order.Ascending),this.sortHandler()}l.defaultSection().appendCheckboxItem(qi(Ii.startTime),c.bind(this,a.StartTime),this.activeWaterfallSortId===a.StartTime),l.defaultSection().appendCheckboxItem(qi(Ii.responseTime),c.bind(this,a.ResponseTime),this.activeWaterfallSortId===a.ResponseTime),l.defaultSection().appendCheckboxItem(qi(Ii.endTime),c.bind(this,a.EndTime),this.activeWaterfallSortId===a.EndTime),l.defaultSection().appendCheckboxItem(qi(Ii.totalDuration),c.bind(this,a.Duration),this.activeWaterfallSortId===a.Duration),l.defaultSection().appendCheckboxItem(qi(Ii.latency),c.bind(this,a.Latency),this.activeWaterfallSortId===a.Latency)}manageCustomHeaderDialog(){const e=[];for(const t of this.columns){const i=t.title instanceof Function?t.title():t.title;t.isResponseHeader&&e.push({title:i,editable:t.isCustomHeader})}const t=new ui(e,(e=>Boolean(this.addCustomHeader(e))),this.changeCustomHeader.bind(this),this.removeCustomHeader.bind(this)),i=new o.Dialog.Dialog;t.show(i.contentElement),i.setSizeBehavior("MeasureContent"),i.show(this.networkLogView.element)}removeCustomHeader(e){e=e.toLowerCase();const t=this.columns.findIndex((t=>t.id===e));return-1!==t&&(this.columns.splice(t,1),this.dataGridInternal.removeColumn(e),this.saveColumnsSettings(),this.updateColumns(),!0)}addCustomHeader(e,t,i){t||(t=e.toLowerCase()),void 0===i&&(i=this.columns.length-1);const r=this.columns.find((e=>e.id===t));if(r)return null;const o=Object.assign({},Hi,{id:t,title:e,isResponseHeader:!0,isCustomHeader:!0,visible:!0,sortingFunction:ve.ResponseHeaderStringComparator.bind(null,t)});return this.columns.splice(i,0,o),this.dataGridInternal&&this.dataGridInternal.addColumn(Li.convertToDataGridDescriptor(o),i),this.saveColumnsSettings(),this.updateColumns(),o}changeCustomHeader(e,t,i){i||(i=t.toLowerCase()),e=e.toLowerCase();const r=this.columns.findIndex((t=>t.id===e)),o=this.columns[r],s=this.columns.find((e=>e.id===i));return!(!o||s&&e!==i)&&(this.removeCustomHeader(e),this.addCustomHeader(t,i,r),!0)}getPopoverRequest(e){if(!this.gridMode)return null;const t=this.networkLogView.hoveredNode();if(!t||!e.target)return null;const i=e.target.enclosingNodeOrSelfWithClass("network-script-initiated");if(!i)return null;const r=t.request();return r?{box:i.boxInWindow(),show:async e=>{this.popupLinkifier.addEventListener("liveLocationUpdated",(()=>{e.setSizeBehavior("MeasureContent")}));const t=He.createStackTracePreview(r,this.popupLinkifier,!1);return!!t&&(e.contentElement.appendChild(t.element),!0)},hide:this.popupLinkifier.reset.bind(this.popupLinkifier)}:null}addEventDividers(e,t){let i="transparent";switch(t){case"network-dcl-divider":i="#0867CB";break;case"network-load-divider":i="#B31412";break;default:return}const r=this.eventDividers.get(i)||[];this.eventDividers.set(i,r.concat(e)),this.networkLogView.scheduleRefresh()}hideEventDividers(){this.eventDividersShown=!0,this.redrawWaterfallColumn()}showEventDividers(){this.eventDividersShown=!1,this.redrawWaterfallColumn()}selectFilmStripFrame(e){this.eventDividers.set(Bi,[e]),this.redrawWaterfallColumn()}clearFilmStripFrame(){this.eventDividers.delete(Bi),this.redrawWaterfallColumn()}}const Pi="waterfall";var Mi;!function(e){e.Duration="Duration",e.Time="Time"}(Mi||(Mi={}));const Hi={subtitle:null,visible:!1,weight:6,sortable:!0,hideable:!0,hideableGroup:null,nonSelectable:!1,isResponseHeader:!1,isCustomHeader:!1,allowInSortByEvenWhenHidden:!1},Ei=[{id:"name",title:Fi(Ii.name),subtitle:Fi(Ii.path),visible:!0,weight:20,hideable:!0,hideableGroup:"path",sortingFunction:ve.NameComparator},{id:"path",title:Fi(Ii.path),hideable:!0,hideableGroup:"path",sortingFunction:ve.RequestPropertyComparator.bind(null,"pathname")},{id:"url",title:Fi(Ii.url),hideable:!0,hideableGroup:"path",sortingFunction:ve.RequestURLComparator},{id:"method",title:Fi(Ii.method),sortingFunction:ve.RequestPropertyComparator.bind(null,"requestMethod")},{id:"status",title:Fi(Ii.status),visible:!0,subtitle:Fi(Ii.text),sortingFunction:ve.RequestPropertyComparator.bind(null,"statusCode")},{id:"protocol",title:Fi(Ii.protocol),sortingFunction:ve.RequestPropertyComparator.bind(null,"protocol")},{id:"scheme",title:Fi(Ii.scheme),sortingFunction:ve.RequestPropertyComparator.bind(null,"scheme")},{id:"domain",title:Fi(Ii.domain),sortingFunction:ve.RequestPropertyComparator.bind(null,"domain")},{id:"remoteaddress",title:Fi(Ii.remoteAddress),weight:10,align:d.DataGrid.Align.Right,sortingFunction:ve.RemoteAddressComparator},{id:"remoteaddress-space",title:Fi(Ii.remoteAddressSpace),visible:!1,weight:10,sortingFunction:ve.RemoteAddressSpaceComparator},{id:"type",title:Fi(Ii.type),visible:!0,sortingFunction:ve.TypeComparator},{id:"initiator",title:Fi(Ii.initiator),visible:!0,weight:10,sortingFunction:ve.InitiatorComparator},{id:"initiator-address-space",title:Fi(Ii.initiatorAddressSpace),visible:!1,weight:10,sortingFunction:ve.InitiatorAddressSpaceComparator},{id:"cookies",title:Fi(Ii.cookies),align:d.DataGrid.Align.Right,sortingFunction:ve.RequestCookiesCountComparator},{id:"setcookies",title:Fi(Ii.setCookies),align:d.DataGrid.Align.Right,sortingFunction:ve.ResponseCookiesCountComparator},{id:"size",title:Fi(Ii.size),visible:!0,subtitle:Fi(Ii.content),align:d.DataGrid.Align.Right,sortingFunction:ve.SizeComparator},{id:"time",title:Fi(Ii.time),visible:!0,subtitle:Fi(Ii.latency),align:d.DataGrid.Align.Right,sortingFunction:ve.RequestPropertyComparator.bind(null,"duration")},{id:"priority",title:Fi(Ii.priority),sortingFunction:ve.PriorityComparator},{id:"connectionid",title:Fi(Ii.connectionId),sortingFunction:ve.RequestPropertyComparator.bind(null,"connectionId")},{id:"cache-control",isResponseHeader:!0,title:i.i18n.lockedLazyString("Cache-Control"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"cache-control")},{id:"connection",isResponseHeader:!0,title:i.i18n.lockedLazyString("Connection"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"connection")},{id:"content-encoding",isResponseHeader:!0,title:i.i18n.lockedLazyString("Content-Encoding"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"content-encoding")},{id:"content-length",isResponseHeader:!0,title:i.i18n.lockedLazyString("Content-Length"),align:d.DataGrid.Align.Right,sortingFunction:ve.ResponseHeaderNumberComparator.bind(null,"content-length")},{id:"etag",isResponseHeader:!0,title:i.i18n.lockedLazyString("ETag"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"etag")},{id:"has-overrides",title:Fi(Ii.hasOverrides),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"has-overrides")},{id:"keep-alive",isResponseHeader:!0,title:i.i18n.lockedLazyString("Keep-Alive"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"keep-alive")},{id:"last-modified",isResponseHeader:!0,title:i.i18n.lockedLazyString("Last-Modified"),sortingFunction:ve.ResponseHeaderDateComparator.bind(null,"last-modified")},{id:"server",isResponseHeader:!0,title:i.i18n.lockedLazyString("Server"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"server")},{id:"vary",isResponseHeader:!0,title:i.i18n.lockedLazyString("Vary"),sortingFunction:ve.ResponseHeaderStringComparator.bind(null,"vary")},{id:"waterfall",title:Fi(Ii.waterfall),visible:!1,hideable:!1,allowInSortByEvenWhenHidden:!0}],Bi="#fccc49";var Ui;!function(e){e.StartTime="startTime",e.ResponseTime="responseReceivedTime",e.EndTime="endTime",e.Duration="duration",e.Latency="latency"}(Ui||(Ui={}));var Ai=Object.freeze({__proto__:null,NetworkLogViewColumns:Li,_initialSortColumn:Pi,get _calculatorTypes(){return Mi},_defaultColumnConfig:Hi,_filmStripDividerColor:Bi,get WaterfallSortIds(){return Ui}});const Ni={invertFilter:"Invert",invertsFilter:"Inverts the search filter",allStrings:"All",hideDataUrls:"Hide data URLs",hidesDataAndBlobUrls:"Hide 'data:' and 'blob:' URLs",chromeExtensions:"Hide extension URLs",hideChromeExtension:"Hide 'chrome-extension://' URLs",requestTypesToInclude:"Request types to include",requestTypesTooltip:"Filter requests by type",requestTypes:"Request types",twoTypesSelected:"{PH1}, {PH2}",overTwoTypesSelected:"{PH1}, {PH2}...",hasBlockedCookies:"Blocked response cookies",onlyShowRequestsWithBlockedCookies:"Show only requests with blocked response cookies",blockedRequests:"Blocked requests",onlyShowBlockedRequests:"Show only blocked requests",thirdParty:"3rd-party requests",onlyShowThirdPartyRequests:"Show only requests with origin different from page origin",dropHarFilesHere:"Drop HAR files here",recordingNetworkActivity:"Recording network activity…",performARequestOrHitSToRecordThe:"Perform a request or hit {PH1} to record the reload.",recordToDisplayNetworkActivity:"Record network log ({PH1}) to display network activity.",learnMore:"Learn more",networkDataAvailable:"Network Data Available",sSRequests:"{PH1} / {PH2} requests",sSTransferred:"{PH1} / {PH2} transferred",sBSBTransferredOverNetwork:"{PH1} B / {PH2} B transferred over network",sSResources:"{PH1} / {PH2} resources",sBSBResourcesLoadedByThePage:"{PH1} B / {PH2} B resources loaded by the page",sRequests:"{PH1} requests",sTransferred:"{PH1} transferred",sBTransferredOverNetwork:"{PH1} B transferred over network",sResources:"{PH1} resources",sBResourcesLoadedByThePage:"{PH1} B resources loaded by the page",finishS:"Finish: {PH1}",domcontentloadedS:"DOMContentLoaded: {PH1}",loadS:"Load: {PH1}",copy:"Copy",copyURL:"Copy URL",copyRequestHeaders:"Copy request headers",copyResponseHeaders:"Copy response headers",copyResponse:"Copy response",copyStacktrace:"Copy stack trace",copyAsPowershell:"Copy as `PowerShell`",copyAsFetch:"Copy as `fetch`",copyAsNodejsFetch:"Copy as `fetch` (`Node.js`)",copyAsCurlCmd:"Copy as `cURL` (`cmd`)",copyAsCurlBash:"Copy as `cURL` (`bash`)",copyAllURLs:"Copy all URLs",copyAllAsPowershell:"Copy all as `PowerShell`",copyAllAsFetch:"Copy all as `fetch`",copyAllAsNodejsFetch:"Copy all as `fetch` (`Node.js`)",copyAllAsCurlCmd:"Copy all as `cURL` (`cmd`)",copyAllAsCurlBash:"Copy all as `cURL` (`bash`)",copyAsCurl:"Copy as `cURL`",copyAllAsCurl:"Copy all as `cURL`",copyAllAsHar:"Copy all as `HAR`",saveAllAsHarWithContent:"Save all as `HAR` with content",clearBrowserCache:"Clear browser cache",clearBrowserCookies:"Clear browser cookies",blockRequestUrl:"Block request URL",unblockS:"Unblock {PH1}",blockRequestDomain:"Block request domain",replayXhr:"Replay XHR",areYouSureYouWantToClearBrowser:"Are you sure you want to clear browser cache?",areYouSureYouWantToClearBrowserCookies:"Are you sure you want to clear browser cookies?",overrideHeaders:"Override headers",showOnlyHideRequests:"Show only/hide requests",moreFilters:"More filters",showOnly:"Show only {PH1}"},Vi=i.i18n.registerUIStrings("panels/network/NetworkLogView.ts",Ni),Wi=i.i18n.getLocalizedString.bind(void 0,Vi),Oi=M.RenderCoordinator.RenderCoordinator.instance();class Di extends(e.ObjectWrapper.eventMixin(o.Widget.VBox)){networkInvertFilterSetting;networkHideDataURLSetting;networkHideChromeExtensions;networkShowBlockedCookiesOnlySetting;networkOnlyBlockedRequestsSetting;networkOnlyThirdPartySetting;networkResourceTypeFiltersSetting;rawRowHeight;progressBarContainer;networkLogLargeRowsSetting;rowHeightInternal;timeCalculatorInternal;durationCalculator;calculatorInternal;columnsInternal;staleRequests;mainRequestLoadTime;mainRequestDOMContentLoadedTime;filters;timeFilter;hoveredNodeInternal;recordingHint;highlightedNode;linkifierInternal;recording;needsRefresh;headerHeightInternal;groupLookups;activeGroupLookup;textFilterUI;invertFilterUI;dataURLFilterUI;moreFiltersDropDownUI;onlyBlockedResponseCookiesFilterUI;onlyBlockedRequestsUI;onlyThirdPartyFilterUI;hideChromeExtensionsUI;resourceCategoryFilterUI;filterParser;suggestionBuilder;dataGrid;summaryToolbarInternal;filterBar;textFilterSetting;constructor(t,i,r){function s(){this.rawRowHeight=Boolean(this.networkLogLargeRowsSetting.get())?41:21,this.rowHeightInternal=this.computeRowHeight()}super(),this.setMinimumSize(50,64),this.element.id="network-container",this.element.classList.add("no-node-selected"),this.networkInvertFilterSetting=e.Settings.Settings.instance().createSetting("networkInvertFilter",!1),this.networkHideDataURLSetting=e.Settings.Settings.instance().createSetting("networkHideDataURL",!1),this.networkHideChromeExtensions=e.Settings.Settings.instance().createSetting("networkHideChromeExtensions",!1),this.networkShowBlockedCookiesOnlySetting=e.Settings.Settings.instance().createSetting("networkShowBlockedCookiesOnlySetting",!1),this.networkOnlyBlockedRequestsSetting=e.Settings.Settings.instance().createSetting("networkOnlyBlockedRequests",!1),this.networkOnlyThirdPartySetting=e.Settings.Settings.instance().createSetting("networkOnlyThirdPartySetting",!1),this.networkResourceTypeFiltersSetting=e.Settings.Settings.instance().createSetting("networkResourceTypeFilters",{}),this.rawRowHeight=0,this.progressBarContainer=i,this.networkLogLargeRowsSetting=r,this.networkLogLargeRowsSetting.addChangeListener(s.bind(this),this),this.rawRowHeight=0,this.rowHeightInternal=0,s.call(this),this.timeCalculatorInternal=new qt,this.durationCalculator=new Ft,this.calculatorInternal=this.timeCalculatorInternal,this.columnsInternal=new Li(this,this.timeCalculatorInternal,this.durationCalculator,r),this.columnsInternal.show(this.element),this.staleRequests=new Set,this.mainRequestLoadTime=-1,this.mainRequestDOMContentLoadedTime=-1,this.filters=[],this.timeFilter=null,this.hoveredNodeInternal=null,this.recordingHint=null,this.highlightedNode=null,this.linkifierInternal=new k.Linkifier.Linkifier,this.recording=!1,this.needsRefresh=!1,this.headerHeightInternal=0,this.groupLookups=new Map,this.groupLookups.set("Frame",new oi(this)),this.activeGroupLookup=null,this.textFilterUI=new o.FilterBar.TextFilterUI,this.textFilterUI.addEventListener("FilterChanged",this.filterChanged,this),t.addFilter(this.textFilterUI),this.invertFilterUI=new o.FilterBar.CheckboxFilterUI("invert-filter",Wi(Ni.invertFilter),!0,this.networkInvertFilterSetting,"invert-filter"),this.invertFilterUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),o.Tooltip.Tooltip.install(this.invertFilterUI.element(),Wi(Ni.invertsFilter)),t.addFilter(this.invertFilterUI),t.addDivider();let l=Object.values(e.ResourceType.resourceCategories).map((e=>({name:e.title(),label:()=>e.shortTitle(),title:e.title()})));globalThis.chii&&(l=l.filter((e=>"Fetch/XHR"===e.label()||"WS"===e.label()))),x.Runtime.experiments.isEnabled(x.Runtime.ExperimentName.NETWORK_PANEL_FILTER_BAR_REDESIGN)?(this.resourceCategoryFilterUI=new Xi(l,this.filterChanged.bind(this),this.networkResourceTypeFiltersSetting),o.ARIAUtils.setLabel(this.resourceCategoryFilterUI.element(),Wi(Ni.requestTypesToInclude)),this.resourceCategoryFilterUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),t.addFilter(this.resourceCategoryFilterUI),t.addDivider(),this.moreFiltersDropDownUI=new Yi(this.filterChanged.bind(this)),t.addFilter(this.moreFiltersDropDownUI)):(this.dataURLFilterUI=new o.FilterBar.CheckboxFilterUI("hide-data-url",Wi(Ni.hideDataUrls),!0,this.networkHideDataURLSetting),this.dataURLFilterUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),o.Tooltip.Tooltip.install(this.dataURLFilterUI.element(),Wi(Ni.hidesDataAndBlobUrls)),globalThis.chii||t.addFilter(this.dataURLFilterUI),this.hideChromeExtensionsUI=new o.FilterBar.CheckboxFilterUI("chrome-extension",Wi(Ni.chromeExtensions),!0,this.networkHideChromeExtensions),this.hideChromeExtensionsUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),o.Tooltip.Tooltip.install(this.hideChromeExtensionsUI.element(),Wi(Ni.hideChromeExtension)),globalThis.chii||t.addFilter(this.hideChromeExtensionsUI),this.resourceCategoryFilterUI=new o.FilterBar.NamedBitSetFilterUI(l,this.networkResourceTypeFiltersSetting),o.ARIAUtils.setLabel(this.resourceCategoryFilterUI.element(),Wi(Ni.requestTypesToInclude)),this.resourceCategoryFilterUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),t.addFilter(this.resourceCategoryFilterUI),this.onlyBlockedResponseCookiesFilterUI=new o.FilterBar.CheckboxFilterUI("only-show-blocked-cookies",Wi(Ni.hasBlockedCookies),!0,this.networkShowBlockedCookiesOnlySetting),this.onlyBlockedResponseCookiesFilterUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),o.Tooltip.Tooltip.install(this.onlyBlockedResponseCookiesFilterUI.element(),Wi(Ni.onlyShowRequestsWithBlockedCookies)),globalThis.chii||t.addFilter(this.onlyBlockedResponseCookiesFilterUI),this.onlyBlockedRequestsUI=new o.FilterBar.CheckboxFilterUI("only-show-blocked-requests",Wi(Ni.blockedRequests),!0,this.networkOnlyBlockedRequestsSetting),this.onlyBlockedRequestsUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),o.Tooltip.Tooltip.install(this.onlyBlockedRequestsUI.element(),Wi(Ni.onlyShowBlockedRequests)),globalThis.chii||t.addFilter(this.onlyBlockedRequestsUI),this.onlyThirdPartyFilterUI=new o.FilterBar.CheckboxFilterUI("only-show-third-party",Wi(Ni.thirdParty),!0,this.networkOnlyThirdPartySetting),this.onlyThirdPartyFilterUI.addEventListener("FilterChanged",this.filterChanged.bind(this),this),o.Tooltip.Tooltip.install(this.onlyThirdPartyFilterUI.element(),Wi(Ni.onlyShowThirdPartyRequests)),globalThis.chii||t.addFilter(this.onlyThirdPartyFilterUI)),this.filterParser=new I.TextUtils.FilterParser(Ki),this.suggestionBuilder=new o.FilterSuggestionBuilder.FilterSuggestionBuilder(Ki,Di.sortSearchValues),this.resetSuggestionBuilder(),this.dataGrid=this.columnsInternal.dataGrid(),this.setupDataGrid(),this.columnsInternal.sortByCurrentColumn(),t.filterButton().addEventListener(o.Toolbar.ToolbarButton.Events.Click,this.dataGrid.scheduleUpdate.bind(this.dataGrid,!0)),this.summaryToolbarInternal=new o.Toolbar.Toolbar("network-summary-bar",this.element),this.summaryToolbarInternal.element.setAttribute("role","status"),new o.DropTarget.DropTarget(this.element,[o.DropTarget.Type.File],Wi(Ni.dropHarFilesHere),this.handleDrop.bind(this)),e.Settings.Settings.instance().moduleSetting("networkColorCodeResourceTypes").addChangeListener(this.invalidateAllItems.bind(this,!1),this),n.TargetManager.TargetManager.instance().observeModels(n.NetworkManager.NetworkManager,this,{scoped:!0}),a.NetworkLog.NetworkLog.instance().addEventListener(a.NetworkLog.Events.RequestAdded,this.onRequestUpdated,this),a.NetworkLog.NetworkLog.instance().addEventListener(a.NetworkLog.Events.RequestUpdated,this.onRequestUpdated,this),a.NetworkLog.NetworkLog.instance().addEventListener(a.NetworkLog.Events.RequestRemoved,this.onRequestRemoved,this),a.NetworkLog.NetworkLog.instance().addEventListener(a.NetworkLog.Events.Reset,this.reset,this),this.updateGroupByFrame(),e.Settings.Settings.instance().moduleSetting("network.group-by-frame").addChangeListener((()=>this.updateGroupByFrame())),this.filterBar=t,this.textFilterSetting=e.Settings.Settings.instance().createSetting("networkTextFilter",""),this.textFilterSetting.get()&&this.textFilterUI.setValue(this.textFilterSetting.get())}getMoreFiltersDropdown(){return this.moreFiltersDropDownUI}updateGroupByFrame(){const t=e.Settings.Settings.instance().moduleSetting("network.group-by-frame").get();this.setGrouping(t?"Frame":null)}static sortSearchValues(e,t){e===g.UIFilter.FilterType.Priority?t.sort(((e,t)=>{const i=w.NetworkPriorities.uiLabelToNetworkPriority(e),r=w.NetworkPriorities.uiLabelToNetworkPriority(t);return w.NetworkPriorities.networkPriorityWeight(i)-w.NetworkPriorities.networkPriorityWeight(r)})):t.sort()}static negativeFilter(e,t){return!e(t)}static requestPathFilter(e,t){return!!e&&e.test(t.path()+"/"+t.name())}static subdomains(e){const t=[e];let i=e.indexOf(".");for(;-1!==i;)t.push("*"+e.substring(i)),i=e.indexOf(".",i+1);return t}static createRequestDomainFilter(e){const t=e.split("*").map(s.StringUtilities.escapeForRegExp).join(".*");return Di.requestDomainFilter.bind(null,new RegExp("^"+t+"$","i"))}static requestDomainFilter(e,t){return e.test(t.domain)}static runningRequestFilter(e){return!e.finished}static fromCacheRequestFilter(e){return e.cached()}static interceptedByServiceWorkerFilter(e){return e.fetchedViaServiceWorker}static initiatedByServiceWorkerFilter(e){return e.initiatedByServiceWorker()}static requestResponseHeaderFilter(e,t){return void 0!==t.responseHeaderValue(e)}static requestResponseHeaderSetCookieFilter(e,t){return Boolean(t.responseHeaderValue("Set-Cookie")?.includes(e))}static requestMethodFilter(e,t){return t.requestMethod===e}static requestPriorityFilter(e,t){return t.priority()===e}static requestMimeTypeFilter(e,t){return t.mimeType===e}static requestMixedContentFilter(e,t){return e===g.UIFilter.MixedContentFilterValues.Displayed?"optionally-blockable"===t.mixedContentType:e===g.UIFilter.MixedContentFilterValues.Blocked?"blockable"===t.mixedContentType&&t.wasBlocked():e===g.UIFilter.MixedContentFilterValues.BlockOverridden?"blockable"===t.mixedContentType&&!t.wasBlocked():e===g.UIFilter.MixedContentFilterValues.All&&"none"!==t.mixedContentType}static requestSchemeFilter(e,t){return t.scheme===e}static requestCookieDomainFilter(e,t){return t.allCookiesIncludingBlockedOnes().some((t=>t.domain()===e))}static requestCookieNameFilter(e,t){return t.allCookiesIncludingBlockedOnes().some((t=>t.name()===e))}static requestCookiePathFilter(e,t){return t.allCookiesIncludingBlockedOnes().some((t=>t.path()===e))}static requestCookieValueFilter(e,t){return t.allCookiesIncludingBlockedOnes().some((t=>t.value()===e))}static requestSetCookieDomainFilter(e,t){return t.responseCookies.some((t=>t.domain()===e))}static requestSetCookieNameFilter(e,t){return t.responseCookies.some((t=>t.name()===e))}static requestSetCookieValueFilter(e,t){return t.responseCookies.some((t=>t.value()===e))}static requestSizeLargerThanFilter(e,t){return t.transferSize>=e}static statusCodeFilter(e,t){return String(t.statusCode)===e}static hasOverridesFilter(e,t){return!!e&&(e===$i.no?0===t.overrideTypes.length:e===$i.yes?t.overrideTypes.length>0:e===$i.content?t.overrideTypes.includes("content"):e===$i.headers?t.overrideTypes.includes("headers"):t.overrideTypes.join(",").includes(e))}static getHTTPRequestsFilter(e){return e.parsedURL.isValid&&e.scheme in _i}static resourceTypeFilter(e,t){return t.resourceType().name()===e}static requestUrlFilter(e,t){return new RegExp(s.StringUtilities.escapeForRegExp(e),"i").test(t.url())}static requestTimeFilter(e,t,i){return!(i.issueTime()>t)&&!(-1!==i.endTime&&i.endTime<e)}static copyRequestHeaders(e){t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e.requestHeadersText())}static copyResponseHeaders(e){t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e.responseHeadersText)}static async copyResponse(e){const i=await e.contentData();let r;r=n.ContentData.ContentData.isError(i)?"":i.resourceType.isTextType()?i.text:i.asDataUrl()??"",t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(r)}handleDrop(e){const t=e.items;if(!t.length)return;const i=t[0].getAsFile();i&&this.onLoadFromFile(i)}async onLoadFromFile(t){const i=new e.StringOutputStream.StringOutputStream,r=new u.FileUtils.ChunkedFileReader(t,1e7);if(!await r.read(i)){const e=r.error();return void(e&&this.harLoadFailed(e.message))}let o;try{o=new q.HARFormat.HARRoot(JSON.parse(i.data()))}catch(e){return void this.harLoadFailed(e)}a.NetworkLog.NetworkLog.instance().importRequests(q.Importer.Importer.requestsFromHARLog(o.log))}harLoadFailed(t){e.Console.Console.instance().error("Failed to load HAR file with following error: "+t)}setGrouping(e){this.activeGroupLookup&&this.activeGroupLookup.reset();const t=e&&this.groupLookups.get(e)||null;this.activeGroupLookup=t,this.invalidateAllItems()}computeRowHeight(){return Math.round(this.rawRowHeight*window.devicePixelRatio)/window.devicePixelRatio}nodeForRequest(e){return ji.get(e)||null}headerHeight(){return this.headerHeightInternal}setRecording(e){this.recording=e,this.updateSummaryBar()}columns(){return this.columnsInternal}summaryToolbar(){return this.summaryToolbarInternal}modelAdded(e){const t=e.target();if(t.outermostTarget()!==t)return;const i=t.model(n.ResourceTreeModel.ResourceTreeModel);i&&(i.addEventListener(n.ResourceTreeModel.Events.Load,this.loadEventFired,this),i.addEventListener(n.ResourceTreeModel.Events.DOMContentLoaded,this.domContentLoadedEventFired,this));for(const e of a.NetworkLog.NetworkLog.instance().requests())this.isInScope(e)&&this.refreshRequest(e)}modelRemoved(t){const i=t.target();if(i.outermostTarget()!==i)return;const r=i.model(n.ResourceTreeModel.ResourceTreeModel);r&&(r.removeEventListener(n.ResourceTreeModel.Events.Load,this.loadEventFired,this),r.removeEventListener(n.ResourceTreeModel.Events.DOMContentLoaded,this.domContentLoadedEventFired,this));e.Settings.Settings.instance().moduleSetting("network_log.preserve-log").get()||this.reset()}linkifier(){return this.linkifierInternal}setWindow(e,t){e||t?(this.timeFilter=Di.requestTimeFilter.bind(null,e,t),this.timeCalculatorInternal.setWindow(new Tt(e,t))):(this.timeFilter=null,this.timeCalculatorInternal.setWindow(null)),this.filterRequests()}resetFocus(){this.dataGrid.element.focus()}resetSuggestionBuilder(){this.suggestionBuilder.clear(),this.suggestionBuilder.addItem(g.UIFilter.FilterType.Is,g.UIFilter.IsFilterType.Running),this.suggestionBuilder.addItem(g.UIFilter.FilterType.Is,g.UIFilter.IsFilterType.FromCache),this.suggestionBuilder.addItem(g.UIFilter.FilterType.Is,g.UIFilter.IsFilterType.ServiceWorkerIntercepted),this.suggestionBuilder.addItem(g.UIFilter.FilterType.Is,g.UIFilter.IsFilterType.ServiceWorkerInitiated),this.suggestionBuilder.addItem(g.UIFilter.FilterType.LargerThan,"100"),this.suggestionBuilder.addItem(g.UIFilter.FilterType.LargerThan,"10k"),this.suggestionBuilder.addItem(g.UIFilter.FilterType.LargerThan,"1M"),this.textFilterUI.setSuggestionProvider(this.suggestionBuilder.completions.bind(this.suggestionBuilder)),this.suggestionBuilder.addItem(g.UIFilter.FilterType.HasOverrides,$i.yes),this.suggestionBuilder.addItem(g.UIFilter.FilterType.HasOverrides,$i.no),this.suggestionBuilder.addItem(g.UIFilter.FilterType.HasOverrides,$i.content),this.suggestionBuilder.addItem(g.UIFilter.FilterType.HasOverrides,$i.headers)}filterChanged(){this.removeAllNodeHighlights(),this.parseFilterQuery(this.textFilterUI.value(),this.invertFilterUI.checked()),this.filterRequests(),this.textFilterSetting.set(this.textFilterUI.value()),this.moreFiltersDropDownUI?.updateActiveFiltersCount(),this.moreFiltersDropDownUI?.updateTooltip()}async resetFilter(){this.textFilterUI.clear()}showRecordingHint(){this.hideRecordingHint(),this.recordingHint=this.element.createChild("div","network-status-pane fill");const e=this.recordingHint.createChild("div","recording-hint");if(this.recording){let t=null;const r=o.ShortcutRegistry.ShortcutRegistry.instance().shortcutsForAction("inspector_main.reload")[0];r&&(t=this.recordingHint.createChild("b"),t.textContent=r.title());e.createChild("span").textContent=Wi(Ni.recordingNetworkActivity),t&&(e.createChild("br"),e.appendChild(i.i18n.getFormatLocalizedString(Vi,Ni.performARequestOrHitSToRecordThe,{PH1:t})))}else{const t=e.createChild("b");t.textContent=o.ShortcutRegistry.ShortcutRegistry.instance().shortcutTitleForAction("network.toggle-recording")||"",e.appendChild(i.i18n.getFormatLocalizedString(Vi,Ni.recordToDisplayNetworkActivity,{PH1:t}))}e.createChild("br"),e.appendChild(o.XLink.XLink.create("https://developer.chrome.com/docs/devtools/network/?utm_source=devtools&utm_campaign=2019Q1",Wi(Ni.learnMore),void 0,void 0,"learn-more")),this.setHidden(!0)}hideRecordingHint(){this.setHidden(!1),this.recordingHint&&this.recordingHint.remove(),o.ARIAUtils.alert(Wi(Ni.networkDataAvailable)),this.recordingHint=null}setHidden(e){this.columnsInternal.setHidden(e),o.ARIAUtils.setHidden(this.summaryToolbarInternal.element,e)}elementsToRestoreScrollPositionsFor(){return this.dataGrid?[this.dataGrid.scrollContainer]:[]}columnExtensionResolved(){this.invalidateAllItems(!0)}setupDataGrid(){return this.dataGrid.setRowContextMenuCallback(((e,t)=>{const i=t.request();i&&this.handleContextMenuForRequest(e,i)})),this.dataGrid.setStickToBottom(!0),this.dataGrid.setName("networkLog"),this.dataGrid.setResizeMethod(d.DataGrid.ResizeMethod.Last),this.dataGrid.element.classList.add("network-log-grid"),this.dataGrid.element.addEventListener("mousedown",this.dataGridMouseDown.bind(this),!0),this.dataGrid.element.addEventListener("mousemove",this.dataGridMouseMove.bind(this),!0),this.dataGrid.element.addEventListener("mouseleave",(()=>this.setHoveredNode(null)),!0),this.dataGrid.element.addEventListener("keydown",(e=>{if("ArrowRight"===e.key&&this.dataGrid.selectedNode){const e=this.dataGrid.selectedNode.element().querySelector("span.devtools-link");e&&e.focus()}s.KeyboardUtilities.isEnterOrSpaceKey(e)&&(this.dispatchEventToListeners(we.RequestActivated,{showPanel:!0,takeFocus:!0}),e.consume(!0))})),this.dataGrid.element.addEventListener("keyup",(e=>{if(("r"===e.key||"R"===e.key)&&this.dataGrid.selectedNode){const e=this.dataGrid.selectedNode.request();if(!e)return;n.NetworkManager.NetworkManager.canReplayRequest(e)&&n.NetworkManager.NetworkManager.replayRequest(e)}})),this.dataGrid.element.addEventListener("focus",this.onDataGridFocus.bind(this),!0),this.dataGrid.element.addEventListener("blur",this.onDataGridBlur.bind(this),!0),this.dataGrid}dataGridMouseMove(e){const t=e,i=this.dataGrid.dataGridNodeFromNode(t.target),r=t.shiftKey;this.setHoveredNode(i,r)}hoveredNode(){return this.hoveredNodeInternal}setHoveredNode(e,t){this.hoveredNodeInternal&&this.hoveredNodeInternal.setHovered(!1,!1),this.hoveredNodeInternal=e,this.hoveredNodeInternal&&this.hoveredNodeInternal.setHovered(!0,Boolean(t))}dataGridMouseDown(e){const t=e;!this.dataGrid.selectedNode&&t.button&&t.consume()}updateSummaryBar(){this.hideRecordingHint();let t=0,r=0,l=0,d=0,c=0,h=-1,u=-1,p=0;for(const i of a.NetworkLog.NetworkLog.instance().requests()){const o=ji.get(i);if(!o)continue;p++;const s=i.transferSize;t+=s;const a=i.resourceSize;r+=a,zi.has(o)||(l++,d+=s,c+=a);const g=n.NetworkManager.NetworkManager.forRequest(i);g&&i.url()===g.target().inspectedURL()&&i.resourceType()===e.ResourceType.resourceTypes.Document&&g.target().parentTarget()?.type()!==n.Target.Type.Frame&&(h=i.startTime),i.endTime>u&&(u=i.endTime)}if(!p)return void this.showRecordingHint();this.summaryToolbarInternal.removeToolbarItems();const g=(e,t)=>{const i=new o.Toolbar.ToolbarText(e);return i.setTitle(t||e),this.summaryToolbarInternal.appendToolbarItem(i),i.element};if(l!==p?(g(Wi(Ni.sSRequests,{PH1:l,PH2:p})),this.summaryToolbarInternal.appendSeparator(),g(Wi(Ni.sSTransferred,{PH1:s.NumberUtilities.bytesToString(d),PH2:s.NumberUtilities.bytesToString(t)}),Wi(Ni.sBSBTransferredOverNetwork,{PH1:d,PH2:t})),this.summaryToolbarInternal.appendSeparator(),g(Wi(Ni.sSResources,{PH1:s.NumberUtilities.bytesToString(c),PH2:s.NumberUtilities.bytesToString(r)}),Wi(Ni.sBSBResourcesLoadedByThePage,{PH1:c,PH2:r}))):(g(Wi(Ni.sRequests,{PH1:p})),this.summaryToolbarInternal.appendSeparator(),g(Wi(Ni.sTransferred,{PH1:s.NumberUtilities.bytesToString(t)}),Wi(Ni.sBTransferredOverNetwork,{PH1:t})),this.summaryToolbarInternal.appendSeparator(),g(Wi(Ni.sResources,{PH1:s.NumberUtilities.bytesToString(r)}),Wi(Ni.sBResourcesLoadedByThePage,{PH1:r}))),-1!==h&&-1!==u){if(this.summaryToolbarInternal.appendSeparator(),g(Wi(Ni.finishS,{PH1:i.TimeUtilities.secondsToString(u-h)})),-1!==this.mainRequestDOMContentLoadedTime&&this.mainRequestDOMContentLoadedTime>h){this.summaryToolbarInternal.appendSeparator();g(Wi(Ni.domcontentloadedS,{PH1:i.TimeUtilities.secondsToString(this.mainRequestDOMContentLoadedTime-h)})).style.color=`var(${Di.getDCLEventColor()})`}if(-1!==this.mainRequestLoadTime){this.summaryToolbarInternal.appendSeparator();g(Wi(Ni.loadS,{PH1:i.TimeUtilities.secondsToString(this.mainRequestLoadTime-h)})).style.color=`var(${Di.getLoadEventColor()})`}}}scheduleRefresh(){this.needsRefresh||(this.needsRefresh=!0,this.isShowing()&&Oi.write("NetworkLogView.render",this.refresh.bind(this)))}addFilmStripFrames(e){this.columnsInternal.addEventDividers(e,"network-frame-divider")}selectFilmStripFrame(e){this.columnsInternal.selectFilmStripFrame(e)}clearFilmStripFrame(){this.columnsInternal.clearFilmStripFrame()}refreshIfNeeded(){this.needsRefresh&&this.refresh()}invalidateAllItems(e){this.staleRequests=new Set(a.NetworkLog.NetworkLog.instance().requests().filter(this.isInScope)),e?this.scheduleRefresh():this.refresh()}timeCalculator(){return this.timeCalculatorInternal}calculator(){return this.calculatorInternal}setCalculator(e){e&&this.calculatorInternal!==e&&(this.calculatorInternal!==e&&(this.calculatorInternal=e,this.columnsInternal.setCalculator(this.calculatorInternal)),this.calculatorInternal.reset(),this.calculatorInternal.startAtZero?this.columnsInternal.hideEventDividers():this.columnsInternal.showEventDividers(),this.invalidateAllItems())}loadEventFired(e){if(!this.recording)return;const t=e.data.loadTime;t&&(this.mainRequestLoadTime=t,this.columnsInternal.addEventDividers([t],"network-load-divider"))}domContentLoadedEventFired(e){if(!this.recording)return;const{data:t}=e;t&&(this.mainRequestDOMContentLoadedTime=t,this.columnsInternal.addEventDividers([t],"network-dcl-divider"))}wasShown(){this.refreshIfNeeded(),this.registerCSSFiles([ai]),this.columnsInternal.wasShown()}willHide(){this.columnsInternal.willHide()}onResize(){this.rowHeightInternal=this.computeRowHeight()}flatNodesList(){return this.dataGrid.rootNode().flatChildren()}onDataGridFocus(){this.dataGrid.element.matches(":focus-visible")&&this.element.classList.add("grid-focused"),this.updateNodeBackground()}onDataGridBlur(){this.element.classList.remove("grid-focused"),this.updateNodeBackground()}updateNodeBackground(){this.dataGrid.selectedNode&&this.dataGrid.selectedNode.updateBackgroundColor()}updateNodeSelectedClass(e){e?this.element.classList.remove("no-node-selected"):this.element.classList.add("no-node-selected")}stylesChanged(){this.columnsInternal.scheduleRefresh()}removeNodeAndMaybeAncestors(e){let t=e.parent;if(t)for(t.removeChild(e);t&&!t.hasChildren()&&t.dataGrid&&t.dataGrid.rootNode()!==t;){const e=t.parent;e.removeChild(t),t=e}}refresh(){this.needsRefresh=!1,this.removeAllNodeHighlights(),this.timeCalculatorInternal.updateBoundariesForEventTime(this.mainRequestLoadTime),this.durationCalculator.updateBoundariesForEventTime(this.mainRequestLoadTime),this.timeCalculatorInternal.updateBoundariesForEventTime(this.mainRequestDOMContentLoadedTime),this.durationCalculator.updateBoundariesForEventTime(this.mainRequestDOMContentLoadedTime);const e=new Map,t=[],i=new Set;for(;this.staleRequests.size;){const e=this.staleRequests.values().next().value;this.staleRequests.delete(e);let t=ji.get(e);t||(t=this.createNodeForRequest(e)),i.add(t)}for(const r of i){const i=!this.applyFilter(r);i&&r===this.hoveredNodeInternal&&this.setHoveredNode(null),i||t.push(r);const o=r.request();this.timeCalculatorInternal.updateBoundaries(o),this.durationCalculator.updateBoundaries(o);const s=this.parentNodeForInsert(r);if(zi.has(r)===i&&r.parent===s)continue;i?zi.add(r):zi.delete(r);r.parent&&(i||r.parent!==s)&&this.removeNodeAndMaybeAncestors(r),s&&!i&&(s.dataGrid||e.has(s)||(e.set(s,this.dataGrid.rootNode()),t.push(s)),e.set(r,s))}for(const t of e.keys())e.get(t).appendChild(t);for(const e of t)e.refresh();this.updateSummaryBar(),e.size&&this.columnsInternal.sortByCurrentColumn(),this.dataGrid.updateInstantly(),this.didRefreshForTest()}didRefreshForTest(){}parentNodeForInsert(e){if(!this.activeGroupLookup)return this.dataGrid.rootNode();const t=this.activeGroupLookup.groupNodeForRequest(e.request());return t||this.dataGrid.rootNode()}reset(){this.dispatchEventToListeners(we.RequestActivated,{showPanel:!1}),this.setHoveredNode(null),this.columnsInternal.reset(),this.timeFilter=null,this.calculatorInternal.reset(),this.timeCalculatorInternal.setWindow(null),this.linkifierInternal.reset(),this.activeGroupLookup&&this.activeGroupLookup.reset(),this.staleRequests.clear(),this.resetSuggestionBuilder(),this.mainRequestLoadTime=-1,this.mainRequestDOMContentLoadedTime=-1,this.dataGrid.rootNode().removeChildren(),this.updateSummaryBar(),this.dataGrid.setStickToBottom(!0),this.scheduleRefresh()}setTextFilterValue(e){this.textFilterUI.setValue(e),x.Runtime.experiments.isEnabled(x.Runtime.ExperimentName.NETWORK_PANEL_FILTER_BAR_REDESIGN)?(this.networkHideDataURLSetting.set(!1),this.networkShowBlockedCookiesOnlySetting.set(!1),this.networkOnlyBlockedRequestsSetting.set(!1),this.networkOnlyThirdPartySetting.set(!1),this.networkHideChromeExtensions.set(!1)):(this.dataURLFilterUI?.setChecked(!1),this.onlyBlockedResponseCookiesFilterUI?.setChecked(!1),this.onlyBlockedRequestsUI?.setChecked(!1),this.onlyThirdPartyFilterUI?.setChecked(!1),this.hideChromeExtensionsUI?.setChecked(!1)),this.resourceCategoryFilterUI.reset()}createNodeForRequest(e){const t=new ve(this,e);ji.set(e,t),zi.add(t);for(let t=e.redirectSource();t;t=t.redirectSource())this.refreshRequest(t);return t}isInScope(e){const t=n.NetworkManager.NetworkManager.forRequest(e);return!t||n.TargetManager.TargetManager.instance().isInScope(t)}onRequestUpdated(e){const t=e.data;this.isInScope(t)&&this.refreshRequest(t)}onRequestRemoved(e){const t=e.data;this.staleRequests.delete(t);const i=ji.get(t);i&&this.removeNodeAndMaybeAncestors(i)}refreshRequest(e){Di.subdomains(e.domain).forEach(this.suggestionBuilder.addItem.bind(this.suggestionBuilder,g.UIFilter.FilterType.Domain)),this.suggestionBuilder.addItem(g.UIFilter.FilterType.Method,e.requestMethod),this.suggestionBuilder.addItem(g.UIFilter.FilterType.MimeType,e.mimeType),this.suggestionBuilder.addItem(g.UIFilter.FilterType.Scheme,String(e.scheme)),this.suggestionBuilder.addItem(g.UIFilter.FilterType.StatusCode,String(e.statusCode)),this.suggestionBuilder.addItem(g.UIFilter.FilterType.ResourceType,e.resourceType().name()),this.suggestionBuilder.addItem(g.UIFilter.FilterType.Url,e.securityOrigin());const t=e.priority();if(t&&this.suggestionBuilder.addItem(g.UIFilter.FilterType.Priority,w.NetworkPriorities.uiLabelForNetworkPriority(t)),"none"!==e.mixedContentType&&this.suggestionBuilder.addItem(g.UIFilter.FilterType.MixedContent,g.UIFilter.MixedContentFilterValues.All),"optionally-blockable"===e.mixedContentType&&this.suggestionBuilder.addItem(g.UIFilter.FilterType.MixedContent,g.UIFilter.MixedContentFilterValues.Displayed),"blockable"===e.mixedContentType){const t=e.wasBlocked()?g.UIFilter.MixedContentFilterValues.Blocked:g.UIFilter.MixedContentFilterValues.BlockOverridden;this.suggestionBuilder.addItem(g.UIFilter.FilterType.MixedContent,t)}const i=e.responseHeaders;for(const e of i)this.suggestionBuilder.addItem(g.UIFilter.FilterType.HasResponseHeader,e.name),"Set-Cookie"===e.name&&this.suggestionBuilder.addItem(g.UIFilter.FilterType.ResponseHeaderValueSetCookie);for(const t of e.responseCookies)this.suggestionBuilder.addItem(g.UIFilter.FilterType.SetCookieDomain,t.domain()),this.suggestionBuilder.addItem(g.UIFilter.FilterType.SetCookieName,t.name()),this.suggestionBuilder.addItem(g.UIFilter.FilterType.SetCookieValue,t.value());for(const t of e.allCookiesIncludingBlockedOnes())this.suggestionBuilder.addItem(g.UIFilter.FilterType.CookieDomain,t.domain()),this.suggestionBuilder.addItem(g.UIFilter.FilterType.CookieName,t.name()),this.suggestionBuilder.addItem(g.UIFilter.FilterType.CookiePath,t.path()),this.suggestionBuilder.addItem(g.UIFilter.FilterType.CookieValue,t.value());this.staleRequests.add(e),this.scheduleRefresh()}rowHeight(){return this.rowHeightInternal}switchViewMode(e){this.columnsInternal.switchViewMode(e)}handleContextMenuForRequest(e,i){e.appendApplicableItems(i);const r=e.clipboardSection().appendSubMenuItem(Wi(Ni.copy));if(i){r.defaultSection().appendItem(Wi(Ni.copyURL),t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText.bind(t.InspectorFrontendHost.InspectorFrontendHostInstance,i.contentURL())),r.footerSection().appendItem(Wi(Ni.copyAllURLs),this.copyAllURLs.bind(this)),i.requestHeadersText()&&r.saveSection().appendItem(Wi(Ni.copyRequestHeaders),Di.copyRequestHeaders.bind(null,i)),i.responseHeadersText&&r.saveSection().appendItem(Wi(Ni.copyResponseHeaders),Di.copyResponseHeaders.bind(null,i)),i.finished&&r.saveSection().appendItem(Wi(Ni.copyResponse),Di.copyResponse.bind(null,i));const a=i.initiator();if(a){const d=a.stack;if(d){const c=Gi(d);""!==c&&r.saveSection().appendItem(Wi(Ni.copyStacktrace),(()=>{t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(c)}))}}const l=i.isBlobRequest();t.Platform.isWin()?(r.defaultSection().appendItem(Wi(Ni.copyAsCurlCmd),this.copyCurlCommand.bind(this,i,"win"),{disabled:l}),r.defaultSection().appendItem(Wi(Ni.copyAsCurlBash),this.copyCurlCommand.bind(this,i,"unix"),{disabled:l})):r.defaultSection().appendItem(Wi(Ni.copyAsCurl),this.copyCurlCommand.bind(this,i,"unix"),{disabled:l}),r.defaultSection().appendItem(Wi(Ni.copyAsPowershell),this.copyPowerShellCommand.bind(this,i),{disabled:l}),r.defaultSection().appendItem(Wi(Ni.copyAsFetch),this.copyFetchCall.bind(this,i,0),{disabled:l}),r.defaultSection().appendItem(Wi(Ni.copyAsNodejsFetch),this.copyFetchCall.bind(this,i,1),{disabled:l}),t.Platform.isWin()?(r.footerSection().appendItem(Wi(Ni.copyAllAsCurlCmd),this.copyAllCurlCommand.bind(this,"win")),r.footerSection().appendItem(Wi(Ni.copyAllAsCurlBash),this.copyAllCurlCommand.bind(this,"unix"))):r.footerSection().appendItem(Wi(Ni.copyAllAsCurl),this.copyAllCurlCommand.bind(this,"unix")),r.footerSection().appendItem(Wi(Ni.copyAllAsPowershell),this.copyAllPowerShellCommand.bind(this)),r.footerSection().appendItem(Wi(Ni.copyAllAsFetch),this.copyAllFetchCall.bind(this,0)),r.footerSection().appendItem(Wi(Ni.copyAllAsNodejsFetch),this.copyAllFetchCall.bind(this,1))}if(r.footerSection().appendItem(Wi(Ni.copyAllAsHar),this.copyAllAsHAR.bind(this)),e.saveSection().appendItem(Wi(Ni.saveAllAsHarWithContent),this.exportAll.bind(this)),e.overrideSection().appendItem(Wi(Ni.overrideHeaders),this.#o.bind(this,i)),e.editSection().appendItem(Wi(Ni.clearBrowserCache),this.clearBrowserCache.bind(this)),e.editSection().appendItem(Wi(Ni.clearBrowserCookies),this.clearBrowserCookies.bind(this)),i){const h=20,u=n.NetworkManager.MultitargetNetworkManager.instance();let p=u.blockedPatterns();function g(e){p.push({enabled:!0,url:e}),u.setBlockedPatterns(p),u.setBlockingEnabled(!0),o.ViewManager.ViewManager.instance().showView("network.blocked-urls")}function m(e){p=p.filter((t=>t.url!==e)),u.setBlockedPatterns(p),o.ViewManager.ViewManager.instance().showView("network.blocked-urls")}const w=i.parsedURL.urlWithoutScheme();if(w&&!p.find((e=>e.url===w)))e.debugSection().appendItem(Wi(Ni.blockRequestUrl),g.bind(null,w));else if(w){const b=s.StringUtilities.trimMiddle(w,h);e.debugSection().appendItem(Wi(Ni.unblockS,{PH1:b}),m.bind(null,w))}const k=i.parsedURL.domain();if(k&&!p.find((e=>e.url===k)))e.debugSection().appendItem(Wi(Ni.blockRequestDomain),g.bind(null,k));else if(k){const v=s.StringUtilities.trimMiddle(k,h);e.debugSection().appendItem(Wi(Ni.unblockS,{PH1:v}),m.bind(null,k))}n.NetworkManager.NetworkManager.canReplayRequest(i)&&e.debugSection().appendItem(Wi(Ni.replayXhr),n.NetworkManager.NetworkManager.replayRequest.bind(null,i))}}harRequests(){return a.NetworkLog.NetworkLog.instance().requests().filter(Di.getHTTPRequestsFilter).filter((t=>t.finished||t.resourceType()===e.ResourceType.resourceTypes.WebSocket&&t.responseReceivedTime))}async copyAllAsHAR(){const e={log:await q.Log.Log.build(this.harRequests())};t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(JSON.stringify(e,null,2))}copyAllURLs(){const e=this.filterOutBlobRequests(a.NetworkLog.NetworkLog.instance().requests()).map((e=>e.url()));t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e.join("\n"))}async copyCurlCommand(e,i){const r=await Di.generateCurlCommand(e,i);t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(r)}async copyAllCurlCommand(e){const i=await this.generateAllCurlCommand(a.NetworkLog.NetworkLog.instance().requests(),e);t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(i)}async copyFetchCall(e,i){const r=await this.generateFetchCall(e,i);t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(r)}async copyAllFetchCall(e){const i=await this.generateAllFetchCall(a.NetworkLog.NetworkLog.instance().requests(),e);t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(i)}async copyPowerShellCommand(e){const i=await this.generatePowerShellCommand(e);t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(i)}async copyAllPowerShellCommand(){const e=await this.generateAllPowerShellCommand(a.NetworkLog.NetworkLog.instance().requests());t.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(e)}async exportAll(){const t=n.TargetManager.TargetManager.instance().scopeTarget();if(!t)return;const i=t.inspectedURL(),r=e.ParsedURL.ParsedURL.fromString(i),s=r?r.host:"network-log",a=new u.FileUtils.FileOutputStream;if(!await a.open(e.ParsedURL.ParsedURL.concatenate(s,".har")))return;const l=new o.ProgressIndicator.ProgressIndicator;this.progressBarContainer.appendChild(l.element),await q.Writer.Writer.write(a,this.harRequests(),l),l.done(),a.close()}async#o(t){const i=g.UIRequestLocation.UIRequestLocation.responseHeaderMatch(t,{name:"",value:""}),r=F.NetworkPersistenceManager.NetworkPersistenceManager.instance();r.project()?(e.Settings.Settings.instance().moduleSetting("persistenceNetworkOverridesEnabled").set(!0),await r.getOrCreateHeadersUISourceCodeFromUrl(t.url()),await e.Revealer.reveal(i)):o.InspectorView.InspectorView.instance().displaySelectOverrideFolderInfobar((async()=>{await L.SourcesNavigator.OverridesNavigatorView.instance().setupNewWorkspace(),await r.getOrCreateHeadersUISourceCodeFromUrl(t.url()),await e.Revealer.reveal(i)}))}clearBrowserCache(){confirm(Wi(Ni.areYouSureYouWantToClearBrowser))&&n.NetworkManager.MultitargetNetworkManager.instance().clearBrowserCache()}clearBrowserCookies(){confirm(Wi(Ni.areYouSureYouWantToClearBrowserCookies))&&n.NetworkManager.MultitargetNetworkManager.instance().clearBrowserCookies()}removeAllHighlights(){this.removeAllNodeHighlights()}applyFilter(e){const t=e.request();if(this.timeFilter&&!this.timeFilter(t))return!1;const i=t.resourceType().category().title();if(!this.resourceCategoryFilterUI.accept(i))return!1;const[r,o,s,n,a]=x.Runtime.experiments.isEnabled(x.Runtime.ExperimentName.NETWORK_PANEL_FILTER_BAR_REDESIGN)?[this.networkHideDataURLSetting.get(),this.networkShowBlockedCookiesOnlySetting.get(),this.networkOnlyBlockedRequestsSetting.get(),this.networkOnlyThirdPartySetting.get(),this.networkHideChromeExtensions.get()]:[this.dataURLFilterUI?.checked(),this.onlyBlockedResponseCookiesFilterUI?.checked(),this.onlyBlockedRequestsUI?.checked(),this.onlyThirdPartyFilterUI?.checked(),this.hideChromeExtensionsUI?.checked()];if(r&&(t.parsedURL.isDataURL()||t.parsedURL.isBlobURL()))return!1;if(o&&!t.blockedResponseCookies().length)return!1;if(s&&!t.wasBlocked()&&!t.corsErrorStatus())return!1;if(n&&t.isSameSite())return!1;if(a&&"chrome-extension"===t.scheme)return!1;for(let e=0;e<this.filters.length;++e)if(!this.filters[e](t))return!1;return!0}isValidUrl(e){try{return new URL(e),!0}catch(e){return!1}}parseFilterQuery(e,t){const i=this.filterParser.parse(e);this.filters=i.map((e=>{const i=e.key,r=e.text||"",o=e.regex;let n;if(i){const e=s.StringUtilities.escapeForRegExp(i+":"+r);n=this.createSpecialFilter(i,r)||Di.requestPathFilter.bind(null,new RegExp(e,"i"))}else n=e.regex?Di.requestPathFilter.bind(null,o):this.isValidUrl(r)?Di.requestUrlFilter.bind(null,r):Di.requestPathFilter.bind(null,new RegExp(s.StringUtilities.escapeForRegExp(r),"i"));return e.negative&&!t||!e.negative&&t?Di.negativeFilter.bind(null,n):n}))}createSpecialFilter(e,t){switch(e){case g.UIFilter.FilterType.Domain:return Di.createRequestDomainFilter(t);case g.UIFilter.FilterType.HasResponseHeader:return Di.requestResponseHeaderFilter.bind(null,t);case g.UIFilter.FilterType.ResponseHeaderValueSetCookie:return Di.requestResponseHeaderSetCookieFilter.bind(null,t);case g.UIFilter.FilterType.Is:if(t.toLowerCase()===g.UIFilter.IsFilterType.Running)return Di.runningRequestFilter;if(t.toLowerCase()===g.UIFilter.IsFilterType.FromCache)return Di.fromCacheRequestFilter;if(t.toLowerCase()===g.UIFilter.IsFilterType.ServiceWorkerIntercepted)return Di.interceptedByServiceWorkerFilter;if(t.toLowerCase()===g.UIFilter.IsFilterType.ServiceWorkerInitiated)return Di.initiatedByServiceWorkerFilter;break;case g.UIFilter.FilterType.LargerThan:return this.createSizeFilter(t.toLowerCase());case g.UIFilter.FilterType.Method:return Di.requestMethodFilter.bind(null,t);case g.UIFilter.FilterType.MimeType:return Di.requestMimeTypeFilter.bind(null,t);case g.UIFilter.FilterType.MixedContent:return Di.requestMixedContentFilter.bind(null,t);case g.UIFilter.FilterType.Scheme:return Di.requestSchemeFilter.bind(null,t);case g.UIFilter.FilterType.SetCookieDomain:return Di.requestSetCookieDomainFilter.bind(null,t);case g.UIFilter.FilterType.SetCookieName:return Di.requestSetCookieNameFilter.bind(null,t);case g.UIFilter.FilterType.SetCookieValue:return Di.requestSetCookieValueFilter.bind(null,t);case g.UIFilter.FilterType.CookieDomain:return Di.requestCookieDomainFilter.bind(null,t);case g.UIFilter.FilterType.CookieName:return Di.requestCookieNameFilter.bind(null,t);case g.UIFilter.FilterType.CookiePath:return Di.requestCookiePathFilter.bind(null,t);case g.UIFilter.FilterType.CookieValue:return Di.requestCookieValueFilter.bind(null,t);case g.UIFilter.FilterType.Priority:return Di.requestPriorityFilter.bind(null,w.NetworkPriorities.uiLabelToNetworkPriority(t));case g.UIFilter.FilterType.StatusCode:return Di.statusCodeFilter.bind(null,t);case g.UIFilter.FilterType.HasOverrides:return Di.hasOverridesFilter.bind(null,t);case g.UIFilter.FilterType.ResourceType:return Di.resourceTypeFilter.bind(null,t);case g.UIFilter.FilterType.Url:return Di.requestUrlFilter.bind(null,t)}return null}createSizeFilter(e){let t=1;e.endsWith("k")?(t=1e3,e=e.substring(0,e.length-1)):e.endsWith("m")&&(t=1e6,e=e.substring(0,e.length-1));const i=Number(e);return isNaN(i)?null:Di.requestSizeLargerThanFilter.bind(null,i*t)}filterRequests(){this.removeAllHighlights(),this.invalidateAllItems()}reveal(e){this.removeAllNodeHighlights();const t=ji.get(e);return t&&t.dataGrid?(t.parent&&t.parent instanceof fe&&(t.parent.reveal(),t.parent.expand()),t.reveal(),t):null}revealAndHighlightRequest(e){const t=this.reveal(e);t&&this.highlightNode(t)}revealAndHighlightRequestWithId(e){const t=a.NetworkLog.NetworkLog.instance().requestByManagerAndId(e.manager,e.requestId);t&&this.revealAndHighlightRequest(t)}selectRequest(e,t){const{clearFilter:i}=t||{clearFilter:!0};i&&this.setTextFilterValue("");const r=this.reveal(e);r&&r.select()}removeAllNodeHighlights(){this.highlightedNode&&(this.highlightedNode.element().classList.remove("highlighted-row"),this.highlightedNode=null)}highlightNode(e){o.UIUtils.runCSSAnimationOnce(e.element(),"highlighted-row"),this.highlightedNode=e}filterOutBlobRequests(e){return e.filter((e=>!e.isBlobRequest()))}async generateFetchCall(e,t){const i=new Set(["method","path","scheme","version","accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via","user-agent"]),r=new Set(["cookie","authorization"]),o=JSON.stringify(e.url()),s=e.requestHeaders(),n=s.reduce(((e,t)=>{const r=t.name;return i.has(r.toLowerCase())||r.includes(":")||e.append(r,t.value),e}),new Headers),a={};for(const e of n)a[e[0]]=e[1];const l=e.includedRequestCookies().length||s.some((({name:e})=>r.has(e.toLowerCase())))?"include":"omit",d=s.find((({name:e})=>"referer"===e.toLowerCase())),c=d?d.value:void 0,h=e.referrerPolicy()||void 0,u=await e.requestFormData(),p={headers:Object.keys(a).length?a:void 0,referrer:c,referrerPolicy:h,body:u,method:e.requestMethod,mode:"cors"};if(1===t){const e=s.find((e=>"cookie"===e.name.toLowerCase())),t={};delete p.mode,e&&(t.cookie=e.value),c&&(delete p.referrer,t.Referer=c),c&&(delete p.referrerPolicy,t["Referrer-Policy"]=h),Object.keys(t).length&&(p.headers={...a,...t})}else p.credentials=l;return`fetch(${o}, ${JSON.stringify(p,null,2)});`}async generateAllFetchCall(e,t){const i=this.filterOutBlobRequests(e);return(await Promise.all(i.map((e=>this.generateFetchCall(e,t))))).join(" ;\n")}static async generateCurlCommand(e,t){let i=[];const r=new Set(["accept-encoding","host","method","path","scheme","version"]);const o="win"===t?function(e){const t=/[\r\n]|[^a-zA-Z0-9\s_\-:=+~'\/.',?;()*`&]/.test(e)?'^"':'"';return t+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/[^a-zA-Z0-9\s_\-:=+~'\/.',?;()*`&]/g,"^$&").replace(/%(?=[a-zA-Z0-9_])/g,"%^").replace(/\r?\n/g,"^\n\n")+t}:function(e){return/[\0-\x1F\x7F-\x9F!]|\'/.test(e)?"$'"+e.replace(/\\/g,"\\\\").replace(/\'/g,"\\'").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\0-\x1F\x7F-\x9F!]/g,(function(e){let t=e.charCodeAt(0).toString(16);for(;t.length<4;)t="0"+t;return"\\u"+t}))+"'":"'"+e+"'"};i.push(o(e.url()).replace(/[[{}\]]/g,"\\$&"));let s="GET";const n=[],a=await e.requestFormData();a&&(n.push("--data-raw "+o(a)),r.add("content-length"),s="POST"),e.requestMethod!==s&&i.push("-X "+o(e.requestMethod));const l=e.requestHeaders();for(let e=0;e<l.length;e++){const t=l[e],s=t.name.replace(/^:/,"");r.has(s.toLowerCase())||(t.value.trim()?i.push("-H "+o(s+": "+t.value)):i.push("-H "+o(s+";")))}return i=i.concat(n),"insecure"===e.securityState()&&i.push("--insecure"),"curl "+i.join(i.length>=3?"win"===t?" ^\n  ":" \\\n  ":" ")}async generateAllCurlCommand(e,t){const i=this.filterOutBlobRequests(e),r=await Promise.all(i.map((e=>Di.generateCurlCommand(e,t))));return"win"===t?r.join(" &\r\n"):r.join(" ;\n")}async generatePowerShellCommand(e){const t=[],i=new Set(["host","connection","proxy-connection","content-length","expect","range","content-type","user-agent","cookie"]);function r(e){return'"'+e.replace(/[`\$"]/g,"`$&").replace(/[^\x20-\x7E]/g,(e=>"$([char]"+e.charCodeAt(0)+")"))+'"'}t.push("-Uri "+r(e.url())),"GET"!==e.requestMethod&&t.push("-Method "+r(e.requestMethod));const o=function(e){const t=[],i=e.requestHeaders().find((({name:e})=>"user-agent"===e.toLowerCase()));i&&t.push(`$session.UserAgent = ${r(i.value)}`);for(const i of e.includedRequestCookies()){const e=r(i.name()),o=r(i.value()),s=r(i.domain());t.push(`$session.Cookies.Add((New-Object System.Net.Cookie(${e}, ${o}, "/", ${s})))`)}return t.length?"$session = New-Object Microsoft.PowerShell.Commands.WebRequestSession\n"+t.join("\n")+"\n":null}(e);o&&t.push("-WebSession $session");const s=e.requestHeaders(),n=[];for(const e of s){const t=e.name.replace(/^:/,"");i.has(t.toLowerCase())||n.push(r(t)+"="+r(e.value))}n.length&&t.push("-Headers @{\n"+n.join("\n  ")+"\n}");const a=s.find((({name:e})=>"content-type"===e.toLowerCase()));a&&t.push("-ContentType "+r(a.value));const l=await e.requestFormData();if(l){const e=r(l);/[^\x20-\x7E]/.test(l)?t.push("-Body ([System.Text.Encoding]::UTF8.GetBytes("+e+"))"):t.push("-Body "+e)}return(o||"")+"Invoke-WebRequest -UseBasicParsing "+t.join(t.length>=3?" `\n":" ")}async generateAllPowerShellCommand(e){const t=this.filterOutBlobRequests(e);return(await Promise.all(t.map((e=>this.generatePowerShellCommand(e))))).join(";\r\n")}static getDCLEventColor(){return"--sys-color-token-attribute-value"}static getLoadEventColor(){return"--sys-color-token-property-special"}}function Gi(e){let t="";for(const i of e.callFrames){t+=`${o.UIUtils.beautifyFunctionName(i.functionName)} @ ${i.url}:${i.lineNumber+1}\n`}return e.parent&&(t+=Gi(e.parent)),t}const zi=new WeakSet,ji=new WeakMap;const _i={http:!0,https:!0,ws:!0,wss:!0},Ki=Object.values(g.UIFilter.FilterType),$i={yes:"yes",no:"no",content:"content",headers:"headers"};class Xi extends e.ObjectWrapper.ObjectWrapper{filterElement;dropDownButton;filterChanged;displayedTypes;setting;items;contextMenu;selectedTypesCount;typesCountAdorner;hasChanged=!1;constructor(e,t,i){super(),this.items=e,this.filterChanged=t,this.filterElement=document.createElement("div"),this.filterElement.setAttribute("jslog",`${l.dropDown().track({click:!0}).context("request-types")}`),this.typesCountAdorner=new P.Adorner.Adorner,this.selectedTypesCount=document.createElement("span"),this.typesCountAdorner.data={name:"countWrapper",content:this.selectedTypesCount},this.typesCountAdorner.classList.add("active-filters-count"),this.dropDownButton=new o.Toolbar.ToolbarButton(Wi(Ni.requestTypesTooltip),this.typesCountAdorner),this.dropDownButton.setText(Wi(Ni.requestTypes)),this.filterElement.appendChild(this.dropDownButton.element),this.dropDownButton.turnIntoSelect(),this.dropDownButton.element.classList.add("dropdown-filterbar"),this.dropDownButton.addEventListener(o.Toolbar.ToolbarButton.Events.Click,this.showContextMenu.bind(this)),o.ARIAUtils.markAsMenuButton(this.dropDownButton.element),this.displayedTypes=new Set,this.setting=i,i.addChangeListener(this.settingChanged.bind(this)),this.setting.addChangeListener(this.filterChanged.bind(this)),this.settingChanged()}discard(){this.contextMenu?.discard()}emitUMA(){if(this.hasChanged){t.userMetrics.resourceTypeFilterNumberOfSelectedChanged(this.displayedTypes.size);for(const e of this.displayedTypes)t.userMetrics.resourceTypeFilterItemSelected(e)}}showContextMenu(e){const t=e.data;this.hasChanged=!1,this.contextMenu=new o.ContextMenu.ContextMenu(t,{useSoftMenu:!0,keepOpen:!0,x:this.dropDownButton.element.getBoundingClientRect().left,y:this.dropDownButton.element.getBoundingClientRect().top+this.dropDownButton.element.offsetHeight,onSoftMenuClosed:this.emitUMA.bind(this)}),this.addRequestType(this.contextMenu,Xi.ALL_TYPES,Wi(Ni.allStrings)),this.contextMenu.defaultSection().appendSeparator();for(const e of this.items)this.addRequestType(this.contextMenu,e.name,e.name);this.update(),this.contextMenu.show()}addRequestType(e,t,i){const r=t.toLowerCase().replace(/\s/g,"-");e.defaultSection().appendCheckboxItem(i,(()=>{this.setting.get()[t]=!this.setting.get()[t],this.toggleTypeFilter(t)}),this.setting.get()[t],void 0,void 0,void 0,r)}toggleTypeFilter(e){e!==Xi.ALL_TYPES?this.displayedTypes.delete(Xi.ALL_TYPES):this.displayedTypes=new Set,this.displayedTypes.has(e)?this.displayedTypes.delete(e):this.displayedTypes.add(e),0===this.displayedTypes.size&&this.displayedTypes.add(Xi.ALL_TYPES);const t={};for(const e of this.displayedTypes)t[e]=!0;this.setting.set(t);const i=this.contextMenu?.getItems()||[];for(const e of i)e.label&&this.contextMenu?.setChecked(e,this.displayedTypes.has(e.label));this.contextMenu?.setChecked(i[0],this.displayedTypes.has("all"))}settingChanged(){this.hasChanged=!0,this.displayedTypes=new Set;for(const e in this.setting.get())this.displayedTypes.add(e);this.update()}update(){(0===this.displayedTypes.size||this.displayedTypes.has(Xi.ALL_TYPES))&&(this.displayedTypes=new Set,this.displayedTypes.add(Xi.ALL_TYPES)),this.updateSelectedTypesCount(),this.updateLabel(),this.updateTooltip()}updateSelectedTypesCount(){this.displayedTypes.has(Xi.ALL_TYPES)?this.typesCountAdorner.classList.add("hidden"):(this.selectedTypesCount.textContent=this.displayedTypes.size.toString(),this.typesCountAdorner.classList.remove("hidden"))}updateLabel(){if(this.displayedTypes.has(Xi.ALL_TYPES))return void this.dropDownButton.setText(Wi(Ni.requestTypes));let t;if(1===this.displayedTypes.size){const i=this.displayedTypes.values().next().value;t=e.ResourceType.ResourceCategory.categoryByTitle(i)?.shortTitle()||""}else{const i=[...this.displayedTypes].slice(-2).reverse().map((t=>e.ResourceType.ResourceCategory.categoryByTitle(t)?.shortTitle()||"")),r={PH1:i[0],PH2:i[1]};t=2===this.displayedTypes.size?Wi(Ni.twoTypesSelected,r):Wi(Ni.overTwoTypesSelected,r)}this.dropDownButton.setText(t)}updateTooltip(){let t=Wi(Ni.requestTypesTooltip);if(!this.displayedTypes.has(Xi.ALL_TYPES)){const i=[...this.displayedTypes].reverse().map((t=>e.ResourceType.ResourceCategory.categoryByTitle(t)?.title()||"")).join(", ");t=Wi(Ni.showOnly,{PH1:i})}this.dropDownButton.setTitle(t)}isActive(){return!this.displayedTypes.has(Xi.ALL_TYPES)}element(){return this.filterElement}reset(){this.toggleTypeFilter(Xi.ALL_TYPES)}accept(e){return this.displayedTypes.has(Xi.ALL_TYPES)||this.displayedTypes.has(e)}static ALL_TYPES="all"}class Yi extends e.ObjectWrapper.ObjectWrapper{filterElement;dropDownButton;filterChangedCallback;networkHideDataURLSetting;networkHideChromeExtensionsSetting;networkShowBlockedCookiesOnlySetting;networkOnlyBlockedRequestsSetting;networkOnlyThirdPartySetting;contextMenu;activeFiltersCount;activeFiltersCountAdorner;hasChanged=!1;constructor(t){super(),this.filterChangedCallback=t,this.networkHideDataURLSetting=e.Settings.Settings.instance().createSetting("networkHideDataURL",!1),this.networkHideChromeExtensionsSetting=e.Settings.Settings.instance().createSetting("networkHideChromeExtensions",!1),this.networkShowBlockedCookiesOnlySetting=e.Settings.Settings.instance().createSetting("networkShowBlockedCookiesOnlySetting",!1),this.networkOnlyBlockedRequestsSetting=e.Settings.Settings.instance().createSetting("networkOnlyBlockedRequests",!1),this.networkOnlyThirdPartySetting=e.Settings.Settings.instance().createSetting("networkOnlyThirdPartySetting",!1),this.filterElement=document.createElement("div"),this.filterElement.setAttribute("aria-label","Show only/hide requests dropdown"),this.filterElement.setAttribute("jslog",`${l.dropDown().track({click:!0}).context("more-filters")}`),this.activeFiltersCountAdorner=new P.Adorner.Adorner,this.activeFiltersCount=document.createElement("span"),this.activeFiltersCountAdorner.data={name:"countWrapper",content:this.activeFiltersCount},this.activeFiltersCountAdorner.classList.add("active-filters-count"),this.updateActiveFiltersCount(),this.dropDownButton=new o.Toolbar.ToolbarButton(Wi(Ni.showOnlyHideRequests),this.activeFiltersCountAdorner,Wi(Ni.moreFilters)),this.filterElement.appendChild(this.dropDownButton.element),this.dropDownButton.turnIntoSelect(),this.dropDownButton.element.classList.add("dropdown-filterbar"),this.dropDownButton.addEventListener(o.Toolbar.ToolbarButton.Events.Click,this.showMoreFiltersContextMenu.bind(this)),o.ARIAUtils.markAsMenuButton(this.dropDownButton.element),this.updateTooltip()}emitUMA(){if(this.hasChanged){const e=this.selectedFilters();t.userMetrics.networkPanelMoreFiltersNumberOfSelectedChanged(e.length);for(const i of e)t.userMetrics.networkPanelMoreFiltersItemSelected(i)}}#s(){this.hasChanged=!0,this.filterChangedCallback()}showMoreFiltersContextMenu(e){const t=e.data;this.hasChanged=!1,this.networkHideDataURLSetting.addChangeListener(this.#s.bind(this)),this.networkHideChromeExtensionsSetting.addChangeListener(this.#s.bind(this)),this.networkShowBlockedCookiesOnlySetting.addChangeListener(this.#s.bind(this)),this.networkOnlyBlockedRequestsSetting.addChangeListener(this.#s.bind(this)),this.networkOnlyThirdPartySetting.addChangeListener(this.#s.bind(this)),this.contextMenu=new o.ContextMenu.ContextMenu(t,{useSoftMenu:!0,keepOpen:!0,x:this.dropDownButton.element.getBoundingClientRect().left,y:this.dropDownButton.element.getBoundingClientRect().top+this.dropDownButton.element.offsetHeight,onSoftMenuClosed:this.emitUMA.bind(this)}),this.contextMenu.defaultSection().appendCheckboxItem(Wi(Ni.hideDataUrls),(()=>this.networkHideDataURLSetting.set(!this.networkHideDataURLSetting.get())),this.networkHideDataURLSetting.get(),void 0,void 0,Wi(Ni.hidesDataAndBlobUrls),"hide-data-urls"),this.contextMenu.defaultSection().appendCheckboxItem(Wi(Ni.chromeExtensions),(()=>this.networkHideChromeExtensionsSetting.set(!this.networkHideChromeExtensionsSetting.get())),this.networkHideChromeExtensionsSetting.get(),void 0,void 0,Wi(Ni.hideChromeExtension),"hide-extension-urls"),this.contextMenu.defaultSection().appendSeparator(),this.contextMenu.defaultSection().appendCheckboxItem(Wi(Ni.hasBlockedCookies),(()=>this.networkShowBlockedCookiesOnlySetting.set(!this.networkShowBlockedCookiesOnlySetting.get())),this.networkShowBlockedCookiesOnlySetting.get(),void 0,void 0,Wi(Ni.onlyShowRequestsWithBlockedCookies),"only-blocked-response-cookies"),this.contextMenu.defaultSection().appendCheckboxItem(Wi(Ni.blockedRequests),(()=>this.networkOnlyBlockedRequestsSetting.set(!this.networkOnlyBlockedRequestsSetting.get())),this.networkOnlyBlockedRequestsSetting.get(),void 0,void 0,Wi(Ni.onlyShowBlockedRequests),"only-blocked-requests"),this.contextMenu.defaultSection().appendCheckboxItem(Wi(Ni.thirdParty),(()=>this.networkOnlyThirdPartySetting.set(!this.networkOnlyThirdPartySetting.get())),this.networkOnlyThirdPartySetting.get(),void 0,void 0,Wi(Ni.onlyShowThirdPartyRequests),"only-3rd-party-requests"),this.contextMenu.show()}selectedFilters(){return[...this.networkHideDataURLSetting.get()?[Wi(Ni.hideDataUrls)]:[],...this.networkHideChromeExtensionsSetting.get()?[Wi(Ni.chromeExtensions)]:[],...this.networkShowBlockedCookiesOnlySetting.get()?[Wi(Ni.hasBlockedCookies)]:[],...this.networkOnlyBlockedRequestsSetting.get()?[Wi(Ni.blockedRequests)]:[],...this.networkOnlyThirdPartySetting.get()?[Wi(Ni.thirdParty)]:[]]}updateActiveFiltersCount(){const e=this.selectedFilters().length;this.activeFiltersCount.textContent=e.toString(),e?this.activeFiltersCountAdorner.classList.remove("hidden"):this.activeFiltersCountAdorner.classList.add("hidden")}updateTooltip(){this.selectedFilters().length?this.dropDownButton.setTitle(this.selectedFilters().join(", ")):this.dropDownButton.setTitle(Ni.showOnlyHideRequests)}discard(){this.contextMenu&&this.contextMenu.discard()}isActive(){return!0}element(){return this.filterElement}}var Ji=Object.freeze({__proto__:null,NetworkLogView:Di,computeStackTraceText:Gi,isRequestFilteredOut:function(e){return zi.has(e)},HTTPSchemas:_i,overrideFilter:$i,DropDownTypesUI:Xi,MoreFiltersDropDownUI:Yi});const Qi={url:"URL"},Zi=i.i18n.registerUIStrings("panels/network/NetworkSearchScope.ts",Qi),er=i.i18n.getLocalizedString.bind(void 0,Zi);class tr{#n;constructor(e){this.#n=e}performIndexing(e){queueMicrotask((()=>{e.done()}))}async performSearch(e,t,i,r){const o=[],s=this.#n.requests().filter((t=>e.filePathMatchesFileQuery(t.url())));t.setTotalWork(s.length);for(const i of s){const r=this.searchRequest(e,i,t);o.push(r)}const n=(await Promise.all(o)).filter((e=>null!==e));if(t.isCanceled())r(!1);else{for(const e of n.sort(((e,t)=>e.label().localeCompare(t.label()))))e.matchesCount()>0&&i(e);t.done(),r(!0)}}async searchRequest(e,t,i){const r=await tr.#a(e,t);if(i.isCanceled())return null;const o=[];a(t.url())&&o.push(g.UIRequestLocation.UIRequestLocation.urlMatch(t));for(const e of t.requestHeaders())n(e)&&o.push(g.UIRequestLocation.UIRequestLocation.requestHeaderMatch(t,e));for(const e of t.responseHeaders)n(e)&&o.push(g.UIRequestLocation.UIRequestLocation.responseHeaderMatch(t,e));for(const e of r)o.push(g.UIRequestLocation.UIRequestLocation.bodyMatch(t,e));return i.incrementWorked(),new ir(t,o);function n(e){return a(`${e.name}: ${e.value}`)}function a(t){const i=e.ignoreCase()?"i":"",r=e.queries().map((e=>new RegExp(s.StringUtilities.escapeForRegExp(e),i)));let o=0;for(const e of r){const i=t.substr(o).match(e);if(!i||void 0===i.index)return!1;o+=i.index+i[0].length}return!0}}static async#a(e,t){if(!t.contentType().isTextType())return[];let i=[];for(const r of e.queries()){const o=await t.searchInContent(r,!e.ignoreCase(),e.isRegex());if(0===o.length)return[];i=s.ArrayUtilities.mergeOrdered(i,o,I.ContentProvider.SearchMatch.comparator)}return i}stopSearch(){}}class ir{request;locations;constructor(e,t){this.request=e,this.locations=t}matchesCount(){return this.locations.length}label(){return this.request.displayName}description(){const e=this.request.parsedURL;return e?e.urlWithoutScheme():this.request.url()}matchLineContent(e){const t=this.locations[e];if(t.isUrlMatch)return this.request.url();const i=t?.header?.header;return i?i.value:t.searchMatch.lineContent}matchRevealable(e){return this.locations[e]}matchLabel(e){const t=this.locations[e];if(t.isUrlMatch)return er(Qi.url);const i=t?.header?.header;return i?`${i.name}:`:(t.searchMatch.lineNumber+1).toString()}matchColumn(e){const t=this.locations[e];return t.searchMatch?.columnNumber}matchLength(e){const t=this.locations[e];return t.searchMatch?.matchLength}}var rr=Object.freeze({__proto__:null,NetworkSearchScope:tr,NetworkSearchResult:ir});const or=new CSSStyleSheet;or.replaceSync(":root{--network-overview-total:var(--sys-color-surface-variant);--network-overview-blocking:var(--sys-color-neutral-bright);--network-overview-connecting:var(--ref-palette-yellow60);--network-overview-service-worker:var(--sys-color-orange-bright);--network-overview-service-worker-respond-with:var(--sys-color-cyan-bright);--network-overview-push:var(--ref-palette-blue60);--override-network-overview-proxy:var(--ref-palette-neutral60);--network-overview-dns:var(--sys-color-cyan);--network-overview-ssl:var(--ref-palette-purple70);--override-network-overview-sending:var(--ref-palette-cyan60);--network-overview-waiting:var(--ref-palette-green70);--network-overview-receiving:var(--ref-palette-blue60);--network-overview-queueing:var(--ref-palette-neutral100);--network-grid-navigation-color:var(--ref-palette-blue90);--network-grid-initiator-path-color:var(--ref-palette-green90);--network-grid-initiated-path-color:var(--ref-palette-error80);--network-grid-focus-selected-color-has-error:var(--sys-color-error-container);--network-grid-from-frame-color:var(--ref-palette-cyan95);--network-grid-is-product-color:var(--ref-palette-yellow95);--network-frame-divider-color:var(--ref-palette-yellow60)}.-theme-with-dark-background{--network-grid-initiator-path-color:var(--ref-palette-green40);--network-grid-initiated-path-color:var(--ref-palette-error20);--network-grid-from-frame-color:var(--ref-palette-neutral50);--network-grid-is-product-color:var(--ref-palette-neutral70)}.network-details-view{background:var(--sys-color-cdt-base)}.network-details-view-tall-header{border-top:4px solid var(--sys-color-cdt-base)}.network-item-view{display:flex;background:var(--sys-color-cdt-base-container)}.network-item-preview-toolbar{border-top:1px solid var(--sys-color-divider);background-color:var(--sys-color-surface1)}.resource-timing-view{display:block;margin:6px;color:var(--sys-color-on-surface);overflow:auto;background-color:var(--sys-color-cdt-base-container)}.resource-timing-table{width:100%!important}#network-overview-panel{flex:none;position:relative}#network-overview-container{overflow:hidden;flex:auto;display:flex;flex-direction:column;position:relative;border-bottom:1px solid var(--sys-color-divider)}#network-overview-container canvas{width:100%;height:100%}.resources-dividers-label-bar{background-color:var(--sys-color-cdt-base-container)}#network-overview-grid .resources-dividers-label-bar{pointer-events:auto}.network .network-overview{flex:0 0 60px}.network-overview .resources-dividers-label-bar .resources-divider{background-color:transparent}.network-overview .resources-dividers{z-index:250}.request-view.html iframe{width:100%;height:100%;position:absolute}.network-film-strip{border-bottom:solid 1px var(--sys-color-divider);flex:none!important}.network-film-strip-placeholder{flex-shrink:0}.network-tabbed-pane{background-color:var(--sys-color-cdt-base-container)}.network-settings-pane{flex:none;background-color:var(--sys-color-cdt-base-container)}.network-settings-pane .toolbar{flex:1 1}.network-toolbar-container{display:flex;flex:none}.network-toolbar-container > :first-child{flex:1 1 auto}.panel.network .toolbar{background-color:var(--sys-color-cdt-base-container);border-bottom:1px solid var(--sys-color-divider)}@media (forced-colors: active){.panel.network .toolbar{background-color:canvas}}devtools-request-headers{min-width:360px}\n/*# sourceURL=networkPanel.css */\n");const sr={close:"Close",search:"Search",doNotClearLogOnPageReload:"Do not clear log on page reload / navigation",preserveLog:"Preserve log",disableCacheWhileDevtoolsIsOpen:"Disable cache (while DevTools is open)",disableCache:"Disable cache",networkSettings:"Network settings",showMoreInformationInRequestRows:"Show more information in request rows",useLargeRequestRows:"Big request rows",showOverviewOfNetworkRequests:"Show overview of network requests",showOverview:"Overview",groupRequestsByTopLevelRequest:"Group requests by top level request frame",groupByFrame:"Group by frame",captureScreenshotsWhenLoadingA:"Capture screenshots when loading a page",captureScreenshots:"Screenshots",importHarFile:"Import `HAR` file...",exportHar:"Export `HAR`...",throttling:"Throttling",hitSToReloadAndCaptureFilmstrip:"Hit {PH1} to reload and capture filmstrip.",revealInNetworkPanel:"Reveal in Network panel",recordingFrames:"Recording frames...",fetchingFrames:"Fetching frames...",moreNetworkConditions:"More network conditions…"},nr=i.i18n.registerUIStrings("panels/network/NetworkPanel.ts",sr),ar=i.i18n.getLocalizedString.bind(void 0,nr);let lr,dr;class cr extends o.Panel.Panel{networkLogShowOverviewSetting;networkLogLargeRowsSetting;networkRecordFilmStripSetting;toggleRecordAction;pendingStopTimer;networkItemView;filmStripView;filmStripRecorder;currentRequest;panelToolbar;rightToolbar;filterBar;settingsPane;showSettingsPaneSetting;filmStripPlaceholderElement;overviewPane;networkOverview;overviewPlaceholderElement;calculator;splitWidget;sidebarLocation;progressBarContainer;networkLogView;fileSelectorElement;detailsWidget;closeButtonElement;preserveLogSetting;recordLogSetting;throttlingSelect;displayScreenshotDelay;constructor(t){super("network"),this.displayScreenshotDelay=t,this.networkLogShowOverviewSetting=e.Settings.Settings.instance().createSetting("networkLogShowOverview",!0),this.networkLogLargeRowsSetting=e.Settings.Settings.instance().createSetting("networkLogLargeRows",!1),this.networkRecordFilmStripSetting=e.Settings.Settings.instance().createSetting("networkRecordFilmStripSetting",!1),this.toggleRecordAction=o.ActionRegistry.ActionRegistry.instance().getAction("network.toggle-recording"),this.networkItemView=null,this.filmStripView=null,this.filmStripRecorder=null,this.currentRequest=null;const i=new o.Widget.VBox,r=i.contentElement.createChild("div","network-toolbar-container");this.panelToolbar=new o.Toolbar.Toolbar("",r),this.panelToolbar.makeWrappable(!0),this.panelToolbar.element.setAttribute("jslog",`${l.section().context("network-toolbar")}`),this.rightToolbar=new o.Toolbar.Toolbar("",r),this.filterBar=new o.FilterBar.FilterBar("networkPanel",!0),this.filterBar.show(i.contentElement),this.filterBar.addEventListener("Changed",this.handleFilterChanged.bind(this)),this.settingsPane=new o.Widget.HBox,this.settingsPane.element.classList.add("network-settings-pane"),this.settingsPane.show(i.contentElement),this.showSettingsPaneSetting=e.Settings.Settings.instance().createSetting("networkShowSettingsToolbar",!1),this.showSettingsPaneSetting.addChangeListener(this.updateSettingsPaneVisibility.bind(this)),this.updateSettingsPaneVisibility(),this.filmStripPlaceholderElement=i.contentElement.createChild("div","network-film-strip-placeholder"),this.overviewPane=new w.TimelineOverviewPane.TimelineOverviewPane("network"),this.overviewPane.addEventListener(w.TimelineOverviewPane.Events.OverviewPaneWindowChanged,this.onWindowChanged.bind(this)),this.overviewPane.element.id="network-overview-panel",this.networkOverview=new wi,this.overviewPane.setOverviewControls([this.networkOverview]),this.overviewPlaceholderElement=i.contentElement.createChild("div"),this.calculator=new qt,this.splitWidget=new o.SplitWidget.SplitWidget(!0,!1,"networkPanelSplitViewState"),this.splitWidget.hideMain(),this.splitWidget.show(i.contentElement),i.setDefaultFocusedChild(this.filterBar);const d=new o.SplitWidget.SplitWidget(!0,!1,"networkPanelSidebarState",225);d.hideSidebar(),d.enableShowModeSaving(),d.show(this.element),this.sidebarLocation=o.ViewManager.ViewManager.instance().createTabbedLocation((async()=>{o.ViewManager.ViewManager.instance().showView("network"),d.showBoth()}),"network-sidebar",!0);const c=this.sidebarLocation.tabbedPane();c.setMinimumSize(100,25),c.element.classList.add("network-tabbed-pane"),c.element.addEventListener("keydown",(e=>{e.key===s.KeyboardUtilities.ESCAPE_KEY&&(d.hideSidebar(),e.consume())}));const h=new o.Toolbar.ToolbarButton(ar(sr.close),"cross");h.addEventListener(o.Toolbar.ToolbarButton.Events.Click,(()=>d.hideSidebar())),c.rightToolbar().appendToolbarItem(h),d.setSidebarWidget(c),d.setMainWidget(i),d.setDefaultFocusedChild(i),this.setDefaultFocusedChild(d),this.progressBarContainer=document.createElement("div"),this.networkLogView=new Di(this.filterBar,this.progressBarContainer,this.networkLogLargeRowsSetting),this.splitWidget.setSidebarWidget(this.networkLogView),this.fileSelectorElement=o.UIUtils.createFileSelectorElement(this.networkLogView.onLoadFromFile.bind(this.networkLogView)),i.element.appendChild(this.fileSelectorElement),this.detailsWidget=new o.Widget.VBox,this.detailsWidget.element.classList.add("network-details-view"),this.splitWidget.setMainWidget(this.detailsWidget),this.closeButtonElement=document.createElement("div",{is:"dt-close-button"}),this.closeButtonElement.addEventListener("click",(async()=>{const e=o.ActionRegistry.ActionRegistry.instance().getAction("network.hide-request-details");await e.execute()}),!1),this.closeButtonElement.style.margin="0 5px",this.networkLogShowOverviewSetting.addChangeListener(this.toggleShowOverview,this),this.networkLogLargeRowsSetting.addChangeListener(this.toggleLargerRequests,this),this.networkRecordFilmStripSetting.addChangeListener(this.toggleRecordFilmStrip,this),this.preserveLogSetting=e.Settings.Settings.instance().moduleSetting("network_log.preserve-log"),this.recordLogSetting=e.Settings.Settings.instance().moduleSetting("network_log.record-log"),this.recordLogSetting.addChangeListener((({data:e})=>this.toggleRecord(e))),this.throttlingSelect=this.createThrottlingConditionsSelect(),this.setupToolbarButtons(d),this.toggleRecord(this.recordLogSetting.get()),this.toggleShowOverview(),this.toggleLargerRequests(),this.toggleRecordFilmStrip(),this.updateUI(),n.TargetManager.TargetManager.instance().addModelListener(n.ResourceTreeModel.ResourceTreeModel,n.ResourceTreeModel.Events.WillReloadPage,this.willReloadPage,this,{scoped:!0}),n.TargetManager.TargetManager.instance().addModelListener(n.ResourceTreeModel.ResourceTreeModel,n.ResourceTreeModel.Events.Load,this.load,this,{scoped:!0}),this.networkLogView.addEventListener(we.RequestSelected,this.onRequestSelected,this),this.networkLogView.addEventListener(we.RequestActivated,this.onRequestActivated,this),a.NetworkLog.NetworkLog.instance().addEventListener(a.NetworkLog.Events.RequestAdded,this.onUpdateRequest,this),a.NetworkLog.NetworkLog.instance().addEventListener(a.NetworkLog.Events.RequestUpdated,this.onUpdateRequest,this),a.NetworkLog.NetworkLog.instance().addEventListener(a.NetworkLog.Events.Reset,this.onNetworkLogReset,this)}static instance(e){return lr&&!e?.forceNew||(lr=new cr(e?.displayScreenshotDelay??1e3)),lr}static revealAndFilter(e){const t=cr.instance();let i="";for(const t of e)t.filterType?i+=`${t.filterType}:${t.filterValue} `:i+=`${t.filterValue} `;return t.networkLogView.setTextFilterValue(i),o.ViewManager.ViewManager.instance().showView("network")}static async selectAndShowRequest(e,t,i){const r=cr.instance();await r.selectAndActivateRequest(e,t,i)}throttlingSelectForTest(){return this.throttlingSelect}onWindowChanged(e){const t=Math.max(this.calculator.minimumBoundary(),e.data.startTime/1e3),i=Math.min(this.calculator.maximumBoundary(),e.data.endTime/1e3);t===this.calculator.minimumBoundary()&&i===this.calculator.maximumBoundary()?this.networkLogView.setWindow(0,0):this.networkLogView.setWindow(t,i)}async searchToggleClick(){const e=o.ActionRegistry.ActionRegistry.instance().getAction("network.search");await e.execute()}setupToolbarButtons(t){const i=new o.Toolbar.ToolbarToggle(ar(sr.search),"search",void 0,"search");function r(){const e=t.showMode()!==o.SplitWidget.ShowMode.OnlyMain;i.setToggled(e),e||i.element.focus()}if(this.panelToolbar.appendToolbarItem(o.Toolbar.Toolbar.createActionButton(this.toggleRecordAction)),this.panelToolbar.appendToolbarItem(o.Toolbar.Toolbar.createActionButtonForId("network.clear")),this.panelToolbar.appendSeparator(),this.panelToolbar.appendToolbarItem(this.filterBar.filterButton()),r(),t.addEventListener(o.SplitWidget.Events.ShowModeChanged,r),i.addEventListener(o.Toolbar.ToolbarButton.Events.Click,(()=>{this.searchToggleClick()})),this.panelToolbar.appendToolbarItem(i),this.panelToolbar.appendSeparator(),!globalThis.chii){this.panelToolbar.appendToolbarItem(new o.Toolbar.ToolbarSettingCheckbox(this.preserveLogSetting,ar(sr.doNotClearLogOnPageReload),ar(sr.preserveLog))),this.panelToolbar.appendSeparator();const t=new o.Toolbar.ToolbarSettingCheckbox(e.Settings.Settings.instance().moduleSetting("cacheDisabled"),ar(sr.disableCacheWhileDevtoolsIsOpen),ar(sr.disableCache));this.panelToolbar.appendToolbarItem(t),this.panelToolbar.appendToolbarItem(this.throttlingSelect);const i=new o.Toolbar.ToolbarButton(ar(sr.moreNetworkConditions),"network-settings",void 0,"network-conditions");i.addEventListener(o.Toolbar.ToolbarButton.Events.Click,(()=>{o.ViewManager.ViewManager.instance().showView("network.config")}),this),this.panelToolbar.appendToolbarItem(i)}this.rightToolbar.appendToolbarItem(new o.Toolbar.ToolbarItem(this.progressBarContainer)),this.rightToolbar.appendSeparator(),this.rightToolbar.appendToolbarItem(new o.Toolbar.ToolbarSettingToggle(this.showSettingsPaneSetting,"gear",ar(sr.networkSettings),"gear-filled","network-settings"));const s=new o.Toolbar.Toolbar("",this.settingsPane.element);s.makeVertical(),s.appendToolbarItem(new o.Toolbar.ToolbarSettingCheckbox(this.networkLogLargeRowsSetting,ar(sr.showMoreInformationInRequestRows),ar(sr.useLargeRequestRows))),s.appendToolbarItem(new o.Toolbar.ToolbarSettingCheckbox(this.networkLogShowOverviewSetting,ar(sr.showOverviewOfNetworkRequests),ar(sr.showOverview)));const n=new o.Toolbar.Toolbar("",this.settingsPane.element);n.makeVertical(),n.appendToolbarItem(new o.Toolbar.ToolbarSettingCheckbox(e.Settings.Settings.instance().moduleSetting("network.group-by-frame"),ar(sr.groupRequestsByTopLevelRequest),ar(sr.groupByFrame))),n.appendToolbarItem(new o.Toolbar.ToolbarSettingCheckbox(this.networkRecordFilmStripSetting,ar(sr.captureScreenshotsWhenLoadingA),ar(sr.captureScreenshots))),this.panelToolbar.appendSeparator();const a=new o.Toolbar.ToolbarButton(ar(sr.importHarFile),"import",void 0,"import-har");a.addEventListener(o.Toolbar.ToolbarButton.Events.Click,(()=>this.fileSelectorElement.click()),this),this.panelToolbar.appendToolbarItem(a);const l=new o.Toolbar.ToolbarButton(ar(sr.exportHar),"download",void 0,"export-har");l.addEventListener(o.Toolbar.ToolbarButton.Events.Click,(e=>{this.networkLogView.exportAll()}),this),this.panelToolbar.appendToolbarItem(l)}updateSettingsPaneVisibility(){this.settingsPane.element.classList.toggle("hidden",!this.showSettingsPaneSetting.get())}createThrottlingConditionsSelect(){const e=new o.Toolbar.ToolbarComboBox(null,ar(sr.throttling));return e.setMaxWidth(160),c.ThrottlingManager.throttlingManager().decorateSelectWithNetworkThrottling(e.selectElement()),e}toggleRecord(e){this.toggleRecordAction.setToggled(e),this.recordLogSetting.get()!==e&&this.recordLogSetting.set(e),this.networkLogView.setRecording(e),!e&&this.filmStripRecorder&&this.filmStripRecorder.stopRecording(this.filmStripAvailable.bind(this))}filmStripAvailable(e){this.filmStripView&&this.filmStripView.setModel(e);const t=e.frames.map((e=>E.Helpers.Timing.microSecondsToSeconds(e.screenshotEvent.ts)));this.networkLogView.addFilmStripFrames(t)}onNetworkLogReset(e){const{clearIfPreserved:t}=e.data;this.preserveLogSetting.get()&&!t||(this.calculator.reset(),this.overviewPane.reset()),this.filmStripView&&this.resetFilmStripView()}willReloadPage(){this.pendingStopTimer&&(clearTimeout(this.pendingStopTimer),delete this.pendingStopTimer),this.isShowing()&&this.filmStripRecorder&&this.filmStripRecorder.startRecording()}load(){this.filmStripRecorder&&this.filmStripRecorder.isRecording()&&(this.pendingStopTimer&&window.clearTimeout(this.pendingStopTimer),this.pendingStopTimer=window.setTimeout(this.stopFilmStripRecording.bind(this),this.displayScreenshotDelay))}stopFilmStripRecording(){this.filmStripRecorder&&this.filmStripRecorder.stopRecording(this.filmStripAvailable.bind(this)),delete this.pendingStopTimer}toggleLargerRequests(){this.updateUI()}toggleShowOverview(){this.networkLogShowOverviewSetting.get()?this.overviewPane.show(this.overviewPlaceholderElement):this.overviewPane.detach(),this.doResize()}toggleRecordFilmStrip(){const e=this.networkRecordFilmStripSetting.get();e&&!this.filmStripRecorder&&(this.filmStripView=new w.FilmStripView.FilmStripView,this.filmStripView.element.classList.add("network-film-strip"),this.filmStripRecorder=new hr(this.networkLogView.timeCalculator(),this.filmStripView),this.filmStripView.show(this.filmStripPlaceholderElement),this.filmStripView.addEventListener(w.FilmStripView.Events.FrameSelected,this.onFilmFrameSelected,this),this.filmStripView.addEventListener(w.FilmStripView.Events.FrameEnter,this.onFilmFrameEnter,this),this.filmStripView.addEventListener(w.FilmStripView.Events.FrameExit,this.onFilmFrameExit,this),this.resetFilmStripView()),!e&&this.filmStripRecorder&&(this.filmStripView&&this.filmStripView.detach(),this.filmStripView=null,this.filmStripRecorder=null)}resetFilmStripView(){const e=o.ShortcutRegistry.ShortcutRegistry.instance().shortcutsForAction("inspector_main.reload")[0];this.filmStripView&&(this.filmStripView.reset(),e&&this.filmStripView.setStatusText(ar(sr.hitSToReloadAndCaptureFilmstrip,{PH1:e.title()})))}elementsToRestoreScrollPositionsFor(){return this.networkLogView.elementsToRestoreScrollPositionsFor()}wasShown(){o.Context.Context.instance().setFlavor(cr,this),this.registerCSSFiles([or]),t.userMetrics.panelLoaded("network","DevTools.Launch.Network")}willHide(){o.Context.Context.instance().setFlavor(cr,null)}revealAndHighlightRequest(e){this.hideRequestPanel(),e&&this.networkLogView.revealAndHighlightRequest(e)}revealAndHighlightRequestWithId(e){this.hideRequestPanel(),e&&this.networkLogView.revealAndHighlightRequestWithId(e)}async selectAndActivateRequest(e,t,i){return await o.ViewManager.ViewManager.instance().showView("network"),this.networkLogView.selectRequest(e,i),this.showRequestPanel(t),this.networkLogView.revealAndHighlightRequest(e),this.networkItemView}handleFilterChanged(){this.hideRequestPanel()}onRowSizeChanged(){this.updateUI()}onRequestSelected(e){const t=e.data;this.currentRequest=t,this.networkOverview.setHighlightedRequest(t),this.updateNetworkItemView()}onRequestActivated(e){const{showPanel:t,tab:i,takeFocus:r}=e.data;t?this.showRequestPanel(i,r):this.hideRequestPanel()}showRequestPanel(e,t){if(this.splitWidget.showMode()!==o.SplitWidget.ShowMode.Both||e||t){if(this.clearNetworkItemView(),this.currentRequest){const i=this.createNetworkItemView(e);i&&t&&i.focus()}this.updateUI()}}hideRequestPanel(){this.clearNetworkItemView(),this.splitWidget.hideMain(),this.updateUI()}updateNetworkItemView(){this.splitWidget.showMode()===o.SplitWidget.ShowMode.Both&&(this.clearNetworkItemView(),this.createNetworkItemView(),this.updateUI())}clearNetworkItemView(){this.networkItemView&&(this.networkItemView.detach(),this.networkItemView=null)}createNetworkItemView(e){if(this.currentRequest)return this.networkItemView=new ii(this.currentRequest,this.networkLogView.timeCalculator(),e),this.networkItemView.leftToolbar().appendToolbarItem(new o.Toolbar.ToolbarItem(this.closeButtonElement)),this.networkItemView.show(this.detailsWidget.element),this.splitWidget.showBoth(),this.networkItemView}updateUI(){this.detailsWidget&&this.detailsWidget.element.classList.toggle("network-details-view-tall-header",this.networkLogLargeRowsSetting.get()),this.networkLogView&&this.networkLogView.switchViewMode(!this.splitWidget.isResizable())}appendApplicableItems(e,t,i){const r=e=>{t.revealSection().appendItem(ar(sr.revealInNetworkPanel),(()=>o.ViewManager.ViewManager.instance().showView("network").then(this.networkLogView.resetFilter.bind(this.networkLogView)).then(this.revealAndHighlightRequest.bind(this,e))))};if(!e.target.isSelfOrDescendant(this.element))if(i instanceof n.Resource.Resource)i.request&&r(i.request);else if(i instanceof p.UISourceCode.UISourceCode){const e=u.ResourceUtils.resourceForURL(i.url());e&&e.request&&r(e.request)}else this.networkItemView&&this.networkItemView.isShowing()&&this.networkItemView.request()===i||r(i)}onFilmFrameSelected(e){const t=e.data;this.overviewPane.setWindowTimes(0,t)}onFilmFrameEnter(e){const t=e.data;this.networkOverview.selectFilmStripFrame(t),this.networkLogView.selectFilmStripFrame(t/1e3)}onFilmFrameExit(){this.networkOverview.clearFilmStripFrame(),this.networkLogView.clearFilmStripFrame()}onUpdateRequest(e){const t=e.data;this.calculator.updateBoundaries(t),this.overviewPane.setBounds(E.Types.Timing.MilliSeconds(1e3*this.calculator.minimumBoundary()),E.Types.Timing.MilliSeconds(1e3*this.calculator.maximumBoundary())),this.networkOverview.updateRequest(t)}resolveLocation(e){return"network-sidebar"===e?this.sidebarLocation:null}}class hr{tracingManager;resourceTreeModel;timeCalculator;filmStripView;tracingModel;callback;#l;constructor(e,t){this.#l=new E.TraceModel.Model({Screenshots:E.Handlers.ModelHandlers.Screenshots}),this.tracingManager=null,this.resourceTreeModel=null,this.timeCalculator=e,this.filmStripView=t,this.tracingModel=null,this.callback=null}traceEventsCollected(e){this.tracingModel&&this.tracingModel.addEvents(e)}async tracingComplete(){if(!this.tracingModel||!this.tracingManager)return;this.tracingModel.tracingComplete(),this.tracingManager=null,await this.#l.parse(this.tracingModel.allRawEvents());const e=this.#l.traceParsedData(this.#l.size()-1);if(!e)return;const t=E.Types.Timing.Seconds(this.timeCalculator.minimumBoundary()),i=E.Extras.FilmStrip.fromTraceData(e,E.Helpers.Timing.secondsToMicroseconds(t));this.callback&&this.callback(i),this.callback=null,this.#l.resetProcessor(),this.resourceTreeModel&&this.resourceTreeModel.resumeReload(),this.resourceTreeModel=null}tracingBufferUsage(){}eventsRetrievalProgress(e){}startRecording(){this.filmStripView.reset(),this.filmStripView.setStatusText(ar(sr.recordingFrames));const e=n.TargetManager.TargetManager.instance().scopeTarget()?.model(E.TracingManager.TracingManager);!this.tracingManager&&e&&(this.tracingManager=e,this.resourceTreeModel=this.tracingManager.target().model(n.ResourceTreeModel.ResourceTreeModel),this.tracingModel=new E.Legacy.TracingModel,this.tracingManager.start(this,"-*,disabled-by-default-devtools.screenshot",""),t.userMetrics.actionTaken(t.UserMetrics.Action.FilmStripStartedRecording))}isRecording(){return Boolean(this.tracingManager)}stopRecording(e){this.tracingManager&&(this.tracingManager.stop(),this.resourceTreeModel&&this.resourceTreeModel.suspendReload(),this.callback=e,this.filmStripView.setStatusText(ar(sr.fetchingFrames)))}}class ur extends B.SearchView.SearchView{constructor(){super("network",new e.Throttler.Throttler(200))}static instance(e={forceNew:null}){const{forceNew:t}=e;return dr&&!t||(dr=new ur),dr}static async openSearch(e,t){await o.ViewManager.ViewManager.instance().showView("network.search-network-tab");const i=ur.instance();return i.toggle(e,Boolean(t)),i}createScope(){return new tr(a.NetworkLog.NetworkLog.instance())}}var pr=Object.freeze({__proto__:null,NetworkPanel:cr,RequestRevealer:class{reveal(e){const t=cr.instance();return o.ViewManager.ViewManager.instance().showView("network").then(t.revealAndHighlightRequest.bind(t,e))}},RequestIdRevealer:class{reveal(e){const t=cr.instance();return o.ViewManager.ViewManager.instance().showView("network").then(t.revealAndHighlightRequestWithId.bind(t,e))}},NetworkLogWithFilterRevealer:class{reveal(e){return cr.revealAndFilter(e.filters)}},FilmStripRecorder:hr,ActionDelegate:class{handleAction(e,t){const i=e.flavor(cr);if(null===i)return!1;switch(t){case"network.toggle-recording":return i.toggleRecord(!i.recordLogSetting.get()),!0;case"network.hide-request-details":return!!i.networkItemView&&(i.hideRequestPanel(),i.networkLogView.resetFocus(),!0);case"network.search":{const e=o.InspectorView.InspectorView.instance().element.window().getSelection();if(!e)return!1;let t="";return e.rangeCount&&(t=e.toString().replace(/\r?\n.*/,"")),ur.openSearch(t),!0}case"network.clear":return a.NetworkLog.NetworkLog.instance().reset(!0),!0}return!1}},RequestLocationRevealer:class{async reveal(e){const t=await cr.instance().selectAndActivateRequest(e.request,e.tab,e.filterOptions);if(t){if(e.searchMatch){const{lineNumber:i,columnNumber:r,matchLength:o}=e.searchMatch,s={from:{lineNumber:i,columnNumber:r},to:{lineNumber:i,columnNumber:r+o}};await t.revealResponseBody(s)}e.header&&t.revealHeader(e.header.section,e.header.header?.name)}}},SearchNetworkView:ur});export{D as BinaryResourceView,$ as BlockedURLsPane,re as EventSourceMessagesView,ue as NetworkConfigView,Se as NetworkDataGridNode,ni as NetworkFrameGrouper,ri as NetworkItemView,Ji as NetworkLogView,Ai as NetworkLogViewColumns,pi as NetworkManageCustomHeadersView,Ci as NetworkOverview,pr as NetworkPanel,rr as NetworkSearchScope,Lt as NetworkTimeCalculator,Ri as NetworkWaterfallColumn,xe as RequestCookiesView,tt as RequestHTMLView,Ee as RequestInitiatorView,je as RequestPayloadView,ft as RequestPreviewView,at as RequestResponseView,Vt as RequestTimingView,Qt as ResourceWebSocketFrameView,mt as SignedExchangeInfoView};
